(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"5+/v":function(e,t,r){"use strict";r.r(t);var n=r("pVnL"),i=r.n(n),s=r("q1tI"),a=r.n(s),o=r("RG42"),c=r("0jae"),l=r("8iII"),d=r("ZTgP"),u=r("sKrL"),h=r("EVdn"),f=r.n(h),p=r("ydjH");const E=new Map;var m=function({url:e}){const t=f.a.Deferred();if(E.has(e))t.resolve({url:e,certificate:E.get(e)});else{const r=new window.XMLHttpRequest,n=()=>{r.removeEventListener("error",i,!1),r.removeEventListener("load",s,!1)},i=r=>{const{status:i}=r.target;n(),t.reject({url:e,status:i})},s=r=>{const{response:i,status:s}=r.target;if(n(),200===s){const r=new Uint8Array(i);t.resolve({url:e,certificate:r})}else t.reject({url:e,status:s})};r.responseType="arraybuffer",r.addEventListener("error",i,!1),r.addEventListener("load",s,!1),r.open("GET",e,!0),r.send()}return Object(p.a)(t.promise())};var C=function(e){let t=!1;return function(...r){if(!t)return t=!0,e(...r)}}(e=>{e.polyfill.installAll()}),g=r("66GW"),R=r("8OQS"),v=r.n(R);const _=a.a.createElement,{Component:w}=a.a;var y=class extends w{constructor(...e){super(...e),this._timeoutID=void 0,this.onTimeout=()=>{const{positionSeconds:e,durationSeconds:t,onEnd:r}=this.props,n=t-e;c.a.warn("[Player] Manually ending while stalled within the last %ss.",n),this.props.onBufferingChange&&this.props.onBufferingChange(!1),r()}}componentDidUpdate(e){const{healthCheckSecondsFromEnd:t,positionSeconds:r,durationSeconds:n,paused:i,onEnd:s}=this.props;let a=!1;s&&n>0&&r>=n&&(a=!0,s());const o=r!==e.positionSeconds,c=i&&i!==e.paused,l=a||o||c;this._timeoutID&&l&&window.clearTimeout(this._timeoutID);const d=n-r;if(n>0&&s&&(!a&&!i)&&d>=0&&d<t){const e=Math.round(1e3*d)+250;window.clearTimeout(this._timeoutID),this._timeoutID=window.setTimeout(this.onTimeout,e)}}componentWillUnmount(){this._timeoutID&&window.clearTimeout(this._timeoutID)}render(){const e=this.props,{mediaComponent:t}=e,r=v()(e,["mediaComponent"]);return _(t,r)}},T=r("nHuJ");const A=a.a.createElement,{Component:b}=a.a,{Category:S,Code:O,Severity:I}=o.util.Error;let P;function M(e){switch(e){case S.NETWORK:return Object(g.default)("Network");case S.TEXT:return Object(g.default)("Text");case S.MEDIA:return Object(g.default)("Media");case S.MANIFEST:return Object(g.default)("Manifest");case S.STREAMING:return Object(g.default)("Streaming");case S.DRM:return Object(g.default)("DRM");case S.PLAYER:return Object(g.default)("Player");case S.CAST:return Object(g.default)("Cast");case S.STORAGE:return Object(g.default)("Storage");default:return Object(g.default)("Unknown")}}function L(e){return["s"+e.code+" ("+M(e.category)+")"].concat(function(e){const{code:t,data:r}=e;switch(t){case O.BAD_HTTP_STATUS:return["URI: "+r[0],r[1]?"Status code: "+r[1]:null,r[2]?"Response text: "+r[2]:null,r[3]?"Response headers: "+JSON.stringify(r[3],null,2):null,r[4]?"NetworkingEngine.RequestType: "+r[4]:null];case O.MEDIA_SOURCE_OPERATION_FAILED:return["MediaError code: "+r[0]];case O.MEDIA_SOURCE_OPERATION_THREW:return["DOMException "+r[0].name+": "+r[0].message];case O.VIDEO_ERROR:return["MediaError code: "+r[0],r[1]?"Edge/IE Error code: "+r[1]:null,r[2]?"Chrome error details: "+r[2]:null];case O.INIT_DATA_TRANSFORM_ERROR:return["Exception "+r[0].name+": "+r[0].message]}}(e)).filter(e=>e).join(" â€“ ")}function D(e,t){const r={},n=l.a[e.drm];let i;return n===u.FAIRPLAY&&(r.fairPlayTransform=!1,r.advanced={[n]:{serverCertificate:t}}),n&&(i=Object.assign({},r,{servers:{[n]:e.license}})),i}class k extends b{constructor(e,t){super(e,t),this._hasUnmounted=void 0,this._mediaElement=void 0,this._serverCertificate=void 0,this._serverCertificateCancelable=void 0,this.onNetworkEngineRequest=(e,t)=>{if(e===o.net.NetworkingEngine.RequestType.LICENSE)switch(this.props.drm){case d.PLAYREADY:delete t.headers.SOAPAction}},this.onFetchCertificateResolved=e=>{const{url:t,certificate:r}=e;this._serverCertificate=r,c.a.warn("[Player] Server certificate request succeeeded: %s",t),this.tryLoadMedia()},this.onFetchCertificateRejected=e=>{const{isCanceled:t,url:r,status:n}=e;t||(c.a.warn("[Player] Server certificate request failed (%d): %s",n,r),this._serverCertificate="invalid",this.tryLoadMedia())},this.onElementChange=e=>{this._mediaElement=e,this.tryLoadMedia()},this.onHTMLError=()=>{},this.onBufferingChange=({buffering:e})=>{},this.onError=({detail:e={}})=>{if(this._hasUnmounted)return;const{category:t,code:r,severity:n}=e,i=L(e);let s=n;t===S.DRM&&r===O.INIT_DATA_TRANSFORM_ERROR&&n===I.CRITICAL&&(s=I.RECOVERABLE),s===I.CRITICAL?(c.a.warn("[Player] A critical Shaka error occurred: "+i+"; the player cannot recover"),this.props.onError&&this.props.onError({code:"s"+r,category:M(t)})):s===I.RECOVERABLE?c.a.warn("[Player] A Shaka error occurred: "+i+"; the player will attempt to recover"):c.a.warn("[Player] A Shaka error occurred: "+i+"; the severity is unknown")},C(o),P||(P=new o.Player),this.state={isReadyToPlay:!1},this._mediaElement,this._serverCertificate,this._serverCertificateCancelable}componentDidMount(){const{certificate:e}=this.props;e&&(this._serverCertificateCancelable=m({url:e}),this._serverCertificateCancelable.promise.then(this.onFetchCertificateResolved,this.onFetchCertificateRejected))}componentWillUnmount(){if(this._hasUnmounted=!0,this._resetPrePlaybackFields(),P){P.getNetworkingEngine().unregisterRequestFilter(this.onNetworkEngineRequest),P.resetConfiguration(),P.removeEventListener("buffering",this.onBufferingChange),P.removeEventListener("error",this.onError),P.detach(),P.unload()}}_resetPrePlaybackFields(){this._serverCertificateCancelable&&(this._serverCertificateCancelable.cancel(),delete this._serverCertificateCancelable),delete this._mediaElement,delete this._serverCertificate}tryLoadMedia(){const{_mediaElement:e,_serverCertificate:t}=this,r=this.props.drm===d.FAIRPLAY;!e||r&&!t||(this._resetPrePlaybackFields(),this.loadMedia({mediaElement:e,serverCertificate:t}))}loadMedia({mediaElement:e,serverCertificate:t}){const r={streaming:{bufferingGoal:this.props.bufferingGoal,jumpLargeGaps:!0,retryParameters:{maxAttempts:1/0,timeout:1e4},stallSkip:.1},abr:{defaultBandwidthEstimate:this.props.defaultBandwidthEstimate},drm:D(this.props,t)};P.configure(r),P.attach(e),P.addEventListener("buffering",this.onBufferingChange),P.addEventListener("error",this.onError),P.getNetworkingEngine().registerRequestFilter(this.onNetworkEngineRequest),P.load(this.props.src,this.props.positionSeconds).then(()=>{P&&this.setState({isReadyToPlay:!0})},e=>{P&&this.onError({detail:e})})}render(){return A(y,i()({},this.props,{healthCheckSecondsFromEnd:this.props.bufferingGoal,mediaComponent:T.a,isReadyToPlay:this.state.isReadyToPlay,onElementChange:this.onElementChange,onError:this.onHTMLError}))}}k.displayName="ShakaMedia",k.defaultProps=Object.assign({},T.a.defaultProps,{bufferingGoal:70});t.default=k}}]);