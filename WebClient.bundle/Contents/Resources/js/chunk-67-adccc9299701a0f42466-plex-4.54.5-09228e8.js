(self.webpackChunkplex_web_client=self.webpackChunkplex_web_client||[]).push([[67],{87067:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Wn});var a=n(67294),r=n(27929),o=n(74309),s=n(38770),i=n(75989),l=n(37703),c=n(22222),d=n(13469),p=n.n(d),u=n(68252),m=n(55885),y=n(76892),v=n(69605),g=n(45399),h=n(27903),S=n(6055),b=n(19755),P=n.n(b),w=n(73034),E=n(69434),Z=n(47909),D=n(56442),f=n(3265),C=n(53145),I=n(4134),O=n(80962),x=n(72759),T=n(27082),k=n(57054),N=Object.assign;const j="ui/downloadsPage/initDownloadsPage",M="ui/downloadsPage/resetDownloadsPage",A="ui/downloadsPage/fetchProvidersWithStorage",L="ui/downloadsPage/saveDownloadsParams",R=(0,w.Z)(j),W=(0,w.Z)(M),H=(0,w.Z)(A),z=(0,w.Z)(L);(0,f.Z)({[j](e,t){},[M](e,t){},[A](e,t,n){const a=function(e){return e.get("ui").get("downloadsPage")}(e),r=e.get("embeddedServer");(0,T.c9)((()=>{a.set({isProvidersPending:!0,providersError:null})}));const o=r.getXHROptions(Z.Z.join("/media/providers",{includeStorage:1}),{headers:{Accept:D.AV.accept}});(0,E.Z)("[Downloads] Updating offline file size"),P().ajax(o).then((e=>{r.get("providers").add(e,{parse:!0,merge:!0}),a.set({isProvidersPending:!1,isProvidersPopulated:!0})}),(e=>{a.set({isProvidersPending:!1,providersError:(0,k.Z)(e)})}))},[L](e,t,n){const a=e.get("user").get("experienceSettings").get("savedPivotParams");n((0,I.LN)({savedPivotParams:N(N({},a),{downloads:t})}))},[C.Cs](e,t,n){const{activity:a}=t;(function(e,t){const n=e.get("embeddedServer");return!!n&&n.entityID()===t.serverEntityID})(e,t)&&a.type===x.sC&&a.Response.status===O.ly&&n(H())}});var B=n(90934);function U(){return(0,c.P1)((e=>e.downloads.subscriptions),B.Z,((e=[],t)=>e.map((e=>t[e]))))}var q=n(5562);const{ASCENDING:$,DESCENDING:K}=u.Z.directions,V="title",_="createdAt",F="storageTotal";var G=n(48604),J=n(46565),X=n(93143),Q=n(65671),Y=n(72936),ee=n(58801),te=n(95815),ne=n(3704),ae=n(82598),re=n(14838),oe=n(83787),se=n(45697),ie=n.n(se),le=n(70809);function ce(e){var t=e["aria-label"],n=e.className,r=e.style,o={viewBox:"0 0 560 560",xmlns:"http://www.w3.org/2000/svg",strokeMiterlimit:"1.414",strokeLinejoin:"round",id:"plex-icon-downloads-560"};o["aria-hidden"]=!t,o.style=r,o.className=le.Z.plexIcon+(n?" "+n:"");var s=[a.createElement.apply(a,["path",{d:"m280 476c108.248 0 196-87.752 196-196 0-108.248-87.752-196-196-196-108.248 0-196 87.752-196 196 0 108.248 87.752 196 196 196m0 42c-131.444 0-238-106.556-238-238 0-131.444 106.556-238 238-238 131.444 0 238 106.556 238 238 0 131.444-106.556 238-238 238m0-112l112-112-89.6 0 0-140-44.8 0 0 140-89.6 0 112 112"}].concat([]))];return t&&s.unshift(a.createElement("title",null,t)),a.createElement.apply(a,["svg",o].concat(s))}ce.propTypes={"aria-label":ie().string,className:ie().string,style:ie().object};const de=ce;function pe(e){var t=e["aria-label"],n=e.className,r=e.style,o={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 40 40",id:"plex-icon-downloads-upsell-560"};o["aria-hidden"]=!t,o.style=r,o.className=le.Z.plexIcon+(n?" "+n:"");var s=[a.createElement.apply(a,["path",{d:"M35.335 26.667h-.667v-16A2.67 2.67 0 0 0 32.001 8h-24a2.67 2.67 0 0 0-2.667 2.667v16h-.667a.667.667 0 0 0-.667.667v2.667c0 1.103.897 2 2 2h28c1.103 0 2-.897 2-2v-2.667a.667.667 0 0 0-.667-.667h.002zm-28.666-16c0-.736.599-1.333 1.333-1.333h24c.735 0 1.333.597 1.333 1.333v16h-10a.667.667 0 0 0-.667.667v.667h-5.333v-.667a.667.667 0 0 0-.667-.667h-10v-16h.001zm28 19.333a.668.668 0 0 1-.667.667h-28A.668.668 0 0 1 5.335 30v-2h10.667v.667c0 .368.299.667.667.667h6.667a.667.667 0 0 0 .667-.667V28H34.67v2h-.001zm-2.668-5a.667.667 0 0 1-.667.667H8.667A.667.667 0 0 1 8 25V11.667c0-.368.299-.667.667-.667h22.667c.368 0 .667.299.667.667V25zm-1.333-.667v-12H9.335v12h21.333zm-8.878-5.805a.668.668 0 1 1 .945.944l-2.223 2.221a.684.684 0 0 1-.472.195.677.677 0 0 1-.472-.195l-2.223-2.221a.668.668 0 0 1 .943-.943l1.084 1.083v-3.945a.667.667 0 0 1 1.334 0v3.945l1.084-1.084z"}].concat([]))];return t&&s.unshift(a.createElement("title",null,t)),a.createElement.apply(a,["svg",o].concat(s))}pe.propTypes={"aria-label":ie().string,className:ie().string,style:ie().object};const ue=pe;var me=n(31590),ye=n(9220),ve=n(48022),ge=n(90961),he=n(7796);const Se=parseInt(he.Z.downloadCellHeight,10),be=(0,ge.Z)(Se,5);var Pe=n(72194),we=n(50362),Ee=n(98727),Ze=n(70488),De=n(74253),fe=n(14699),Ce=n(61478),Ie=n(69881),Oe=n(99051),xe=n(51021),Te=n(34082);var ke=n(90087),Ne=n(60208),je=n(6638),Me=n(25366),Ae=n(91997),Le=n(14513),Re=n(26416),We=n(78188),He=n(46277),ze=n(85480),Be=n(97486),Ue=n(95368),qe=n(56473),$e=n(97863),Ke=n(67635),Ve=Object.prototype.hasOwnProperty,_e=Object.getOwnPropertySymbols,Fe=Object.prototype.propertyIsEnumerable,Ge=Object.assign;const Je=(0,l.$j)((function(){return(0,c.P1)(((e,{isDisabled:t})=>t),(0,Ke.Z)(),((e,t)=>({isDisabled:e||t})))}))((e=>{const{metadataItemEntityID:t,buttonComponent:n,dispatch:r}=e,o=((e,t)=>{var n={};for(var a in e)Ve.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&_e)for(var a of _e(e))t.indexOf(a)<0&&Fe.call(e,a)&&(n[a]=e[a]);return n})(e,["metadataItemEntityID","buttonComponent","dispatch"]);return a.createElement(n,Ge({},o))}));var Xe=n(72369);const Qe=function(e){return(0,Xe.Z)(e||0,e>=1e9?2:0)};var Ye=n(46453),et=n(90701),tt=n(39611),nt=n(52410),at=n(34272),rt=n(53863);const ot="DownloadSubscriptionSummaryCell-button-lFTKLD MetadataSummaryCell-button-BBVAbI";var st=Object.assign;const it=(0,c.P1)(Te.Z,(e=>(0,De.h)(e))),lt=(0,c.P1)(Te.Z,Ee.Z,((e,t)=>e&&e.providers.map((e=>t[e])))),ct=new RegExp(_),dt=new RegExp(F),pt=(0,l.$j)((function(){return(0,c.P1)(((e,{activeSort:t})=>t),((e,{listContext:t})=>t),it,(0,Pe.Z)((0,c.P1)((0,fe.Z)(),lt,((e,t)=>{const{source:n}=e.hint,a=t.find((e=>e.source===n));return(0,Ze.R)(a)})),(e=>e)),(0,fe.Z)(),(0,c.P1)(we.Z,(0,fe.Z)(),((e,t)=>t.target?e[t.target.metadata]:null)),(e=x.EW,(0,c.P1)((0,fe.Z)(),(0,xe.Z)(e),((e,t)=>t.find((({Context:t})=>t.subscriptionID===e.key))))),((e,t,n,a,r,o,s)=>{const{grabOperations:i,hint:l}=r,{subtype:c,type:d}=l,p=function(e,t,n){const{type:a,subtype:r}=e,o=(0,ke.Z)(a,r,t);return(0,Ne.Z)(o,null,a,r,n||{},t)}(l,t,o),u=d!==Ie.TRACK||c===Ce.PODCAST,m=o&&u?(0,je.Z)(n,a,o.key,void 0,o.playlistType):void 0,y=i&&i.find((e=>e.status===O.pn));return{grabError:y&&(y.error||(0,q.Z)("An unexpected error occurred")),isRefreshing:!!s,isDownloadPending:!o&&!!s&&null==s.Context.completed,isDownloading:!!s&&null!=s.Context.total&&null!=s.progress,mediaSubscription:r,imageWidth:p.width,imageHeight:p.height,imageUrl:p.url,metadataItemEntityID:o?o.entityID:null,providerEntityID:a.entityID,route:m,progress:s?s.progress:null,completed:s?s.Context.completed:null,total:s?s.Context.total:null,showEdit:(v=d,v===Ie.SHOW),showCreatedAt:ct.test(e),showStorageTotal:!!o&&dt.test(e)};var v}));var e}),(function(e,t){const{mediaSubscriptionEntityID:n,metricsPage:a,metricsProperties:r}=t,o={mediaSubscriptionEntityID:n,metricsPage:a,metricsProperties:r};return{onEditItem(){e((0,Oe.nY)(o))},onDeleteItem(){e((0,S.L7)(o))},onRetryItem(){e((0,S.OS)(o))}}}))((function(e){const{cellIndex:t,grabError:n,imageHeight:r,imageUrl:o,imageWidth:s,mediaSubscription:i,metadataItemEntityID:l,providerEntityID:c,route:d,progress:p,completed:u,total:m,showStorageTotal:y,showCreatedAt:g,showEdit:h,serverEntityID:S,isDownloadPending:b,isDownloading:P,isRefreshing:w,onEditItem:E,onRetryItem:Z,onDeleteItem:D}=e,f=(0,Re.Z)(e),[C,I]=(0,a.useState)(!1),O=(0,a.useCallback)((()=>{I(!0)}),[]),x=(0,a.useCallback)((()=>{I(!1),D()}),[D]),T=(0,a.useCallback)((()=>{I(!1)}),[]),{hint:k,target:N}=i,{title:j,type:M,subtype:A}=k;let L,R;b?L=(0,q.Z)("Waiting to download"):P&&(L=m>1?(0,q.Z)("Downloading {completed} of {total}",{completed:u+1,total:m}):(0,q.Z)("Downloading")),y?R=Qe(i.storageTotal):g&&(R=(0,We.Z)(i.createdAt)),R=R?` ${Me.U} ${R}`:R;const W=!1,H=!w&&n,z=function(e){const{parentTitle:t,grandparentTitle:n,type:a,subtype:r,index:o}=e,s=a===Ie.TRACK;let i;return a===Ie.SEASON?i=(0,ze.Z)({seasonIndex:o,noLeadingZero:!0,useLongName:!0}):a===Ie.EPISODE||s&&r===Ce.PODCAST?i=n:s&&n&&t?i=`${n} ${Me.U} ${t}`:s&&n&&(i=n),i}(k);return a.createElement("div",{className:t%2?"DownloadSubscriptionSummaryCell-alternateItem-1A8Zzn MetadataSummaryCell-alternateItem-wclmMn MetadataSummaryCell-item-2ksqkJ":"DownloadSubscriptionSummaryCell-item-3M-lL7 MetadataSummaryCell-item-2ksqkJ",style:f.style},d?a.createElement(G.Z,{className:"DownloadSubscriptionSummaryCell-underlay-3TS4x- MetadataSummaryCell-underlay-8Jnos2",tabIndex:"0",to:d,"aria-label":j}):null,a.createElement("div",{className:"DownloadSubscriptionSummaryCell-overlay-dAXkOf MetadataSummaryCell-overlay-xhIvnb"},a.createElement("div",{className:"DownloadSubscriptionSummaryCell-posterContainer-zPuewH MetadataSummaryCell-posterContainer-O13JZA"},f.isPlaceholder?a.createElement($e.Z,{imageWidth:s,imageHeight:r}):a.createElement(qe.Z,{metadataKey:i.hint.source,metadataItemEntityID:l,serverEntityID:S,providerEntityID:c,route:d,showOverlay:!!N,showLink:W,showSelect:W,showEdit:W,showMore:W,title:j,type:M,subtype:A,imageWidth:s,imageHeight:r,imageUrl:o,isOffscreen:!1})),a.createElement("div",{className:"DownloadSubscriptionSummaryCell-summaryContainer-1JNlmo MetadataSummaryCell-summaryContainer-2b-kz5"},a.createElement("div",{className:"DownloadSubscriptionSummaryCell-titleContainer-1dErNo MetadataSummaryCell-titleContainer-1gsRA4"},a.createElement("div",{className:"DownloadSubscriptionSummaryCell-title-2hLVkH MetadataSummaryCell-title-1svrXs"},function(e){const{title:t,parentTitle:n,grandparentTitle:a,type:r,index:o,parentIndex:s,originallyAvailableAt:i}=e;let l=a||n||t;return r===Ie.EPISODE?l=`${(0,He.Z)({episodeIndex:o,seasonIndex:s,date:i,noLeadingZero:!0,separator:" Â· "})} ${Me.U} ${t}`:r===Ie.TRACK&&(l=t),l}(k))),a.createElement("div",{className:"DownloadSubscriptionSummaryCell-summary-3_lMwW MetadataSummaryCell-summary-24HmlZ"},z?a.createElement("div",null,z):null,H?a.createElement("div",null,a.createElement(tt.Z,{className:"DownloadSubscriptionSummaryCell-errorIcon-2-w8-n"}),n):a.createElement("div",null,function(e){const{guid:t,subtype:n,type:a}=e,{MOVIE:r,SHOW:o,SEASON:s,EPISODE:i,TRACK:l}=Ie,{PODCAST:c,WEBSHOW:d}=Ce;return a===o&&n===c?(0,q.Z)("Podcast"):a===l&&n===c?(0,q.Z)("Podcast Episode"):a===o&&n===d?(0,q.Z)("Web Show"):a===i&&n===d?(0,q.Z)("Web Show Episode"):a===r&&t.includes(Ye.Hn)?(0,q.Z)("Video"):a===s?(0,q.Z)("TV Show Season"):a===i?(0,q.Z)("TV Show Episode"):Ie.getMetadataType(a).title}(k),R))),b||P?a.createElement("div",{className:"DownloadSubscriptionSummaryCell-statusContainer-1VXTY8"},a.createElement("div",{className:"DownloadSubscriptionSummaryCell-statusText-2vPLGA"},L),a.createElement(Be.Z,{lineWidth:2,progress:p,showProgressText:!1,showIndeterminate:b,size:20,strokeColor:et.Z.selectedColor,trackColor:et.Z.defaultLinkDisabledLinkColor})):null,a.createElement("div",{className:"DownloadSubscriptionSummaryCell-actions-1zdFbL MetadataSummaryCell-actions-3CiM9B"},H?a.createElement(Le.Z,{component:Ae.Z,className:ot,tooltip:(0,q.Z)("Retry"),ariaLabel:(0,q.Z)("Retry {title}",{title:j}),iconComponent:at.Z,onPress:Z}):null,h?a.createElement(Le.Z,{component:Ae.Z,className:ot,tooltip:(0,q.Z)("Edit"),ariaLabel:(0,q.Z)("Edit download details for {title}",{title:j}),iconComponent:nt.Z,onPress:E}):null,a.createElement(Je,{metadataItemEntityID:l,buttonComponent:Le.Z,component:Ae.Z,"data-qa-id":"downloadSubscriptionRemoveButton",className:ot,tooltip:(0,q.Z)("Delete"),ariaLabel:(0,q.Z)("Delete {title}",{title:j}),iconComponent:rt.Z,kind:J.T,onPress:O}),a.createElement(Ue.Z,{isOpen:C,metricsPage:v.Ke,title:(0,q.Z)("Delete Download"),message:(0,q.Z)("Are you sure you want to delete this download?"),onConfirm:x,onCancel:T}))))}));pt.propTypes=st(st({},pt.propTypes),{mediaSubscriptionEntityID:ie().string.isRequired,metricsPage:ie().string.isRequired,metricsProperties:ie().object.isRequired});const ut=pt;var mt=Object.prototype.hasOwnProperty,yt=Object.getOwnPropertySymbols,vt=Object.prototype.propertyIsEnumerable,gt=Object.assign;const ht=function(e){const{activeSort:t,metricsPage:n,metricsProperties:r,serverEntityID:o}=e,s=((e,t)=>{var n={};for(var a in e)mt.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&yt)for(var a of yt(e))t.indexOf(a)<0&&vt.call(e,a)&&(n[a]=e[a]);return n})(e,["activeSort","metricsPage","metricsProperties","serverEntityID"]),i=(0,a.useMemo)((()=>e=>a.createElement(ut,gt(gt({},e),{serverEntityID:o,activeSort:t,listType:ve.t1,listContext:ye.jF,metricsPage:n,metricsProperties:r}))),[t,n,r,o]);return a.createElement(me.Z,gt(gt({},s),{className:"DownloadSubscriptionSummaryList-content-2zjhKA",scrollerClassName:"DownloadSubscriptionSummaryList-scroller-2h25nF VirtualListScroller-scroller-1ap5-a",scrollPositionStorageKey:"DownloadSubscriptionSummaryList",keyPropName:"mediaSubscriptionEntityID",layout:be,cellRenderer:i}))};var St=n(67006),bt=Object.assign;let Pt,wt;function Et(e,t=window.location.hash){const n=function(e){if(Pt===e)return wt;const t=e.split("?"),n=t.length>1?t[1]:void 0,a=n?Z.Z.parseParams(n):{};return Pt=e,wt={url:t[0],params:a},wt}(t);return Z.Z.join(n.url,bt(bt({},n.params),{type:e.type,subtype:e.subtype,sort:e.sort,save:1}))}function Zt(e,t,n){return t?function(e,t){switch(e){case Ce.PODCAST:return t?(0,q.Z)("Podcasts"):(0,q.Z)("Podcast");case Ce.WEBSHOW:return t?(0,q.Z)("Web Shows"):(0,q.Z)("Web Show")}}(t,n):e?function(e,t){const n=Ie.getMetadataType(e);return t?n.plural:n.title}(e,n):(0,q.Z)("All")}function Dt({type:e,subtype:t,sort:n}){const a={save:1};return e&&(a.type=e),t&&(a.subtype=t),n&&(a.sort=n),{type:e,subtype:t,title:Zt(e,t,!0),route:Et(a)}}var ft=n(35815),Ct=n(63593),It=n(97204),Ot=n(75534),xt=n(83427),Tt=n(91061),kt=n(31419),Nt=n(64469),jt=n(26253),Mt=n(72373),At=Object.prototype.hasOwnProperty,Lt=Object.getOwnPropertySymbols,Rt=Object.prototype.propertyIsEnumerable,Wt=Object.assign;const{ASCENDING:Ht,DESCENDING:zt}=u.Z.directions,Bt=function(e){const{activeType:t,activeSubtype:n,activeSort:r,sorts:o,selectedSort:s,onMenuClose:i}=e,l=((e,t)=>{var n={};for(var a in e)At.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&Lt)for(var a of Lt(e))t.indexOf(a)<0&&Rt.call(e,a)&&(n[a]=e[a]);return n})(e,["activeType","activeSubtype","activeSort","sorts","selectedSort","onMenuClose"]);return a.createElement(kt.Z,Wt(Wt({},l),{onMenuClose:i}),o.map((({key:e,descKey:o,defaultDirection:l,title:c})=>{const d=s.key===e;let p=l;d&&(p=r?r===o?Ht:zt:l===Ht?zt:Ht);const u=p===zt;return a.createElement(Nt.Z,{key:e,to:Et({type:t,subtype:n,sort:u?o:e}),isSelected:d,iconComponent:u?jt.Z:Mt.Z,selectedIconAriaLabel:u?(0,q.Z)("Ascending"):(0,q.Z)("Descending"),onPress:i},c)})))};var Ut=Object.prototype.hasOwnProperty,qt=Object.getOwnPropertySymbols,$t=Object.prototype.propertyIsEnumerable,Kt=Object.assign;const Vt=function(e){const{activeType:t,activeSubtype:n,types:r,onMenuClose:o}=e,s=((e,t)=>{var n={};for(var a in e)Ut.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&qt)for(var a of qt(e))t.indexOf(a)<0&&$t.call(e,a)&&(n[a]=e[a]);return n})(e,["activeType","activeSubtype","types","onMenuClose"]);return a.createElement(kt.Z,Kt(Kt({},s),{onMenuClose:o}),r.map((({type:e,subtype:r,title:s,route:i})=>{let l;return l=r?r===n:e?e===t&&!n:!t&&!n,a.createElement(Nt.Z,{key:r||e||"all",to:i,isSelected:l,onMenuClose:o},s)})))};var _t=n(88413),Ft=n(81473),Gt=n(17215),Jt=n(60886),Xt=n(84385),Qt=n(54939),Yt=n(89267);function en(e){var t=e["aria-label"],n=e.className,r=e.style,o={viewBox:"0 0 560 560",xmlns:"http://www.w3.org/2000/svg",strokeMiterlimit:"1.414",strokeLinejoin:"round",id:"plex-icon-toolbar-refresh-560"};o["aria-hidden"]=!t,o.style=r,o.className=le.Z.plexIcon+(n?" "+n:"");var s=[a.createElement.apply(a,["path",{d:"M432.272,156.583C396.336,112.3 341.473,84 280,84C171.752,84 84,171.752 84,280C84,388.248 171.752,476 280,476L280,518C148.556,518 42,411.443 42,280C42,148.556 148.556,42 280,42C357.038,42 425.526,78.602 469.024,135.364L532.871,98.503L504,244.497L363.129,196.503L432.272,156.583Z"}].concat([]))];return t&&s.unshift(a.createElement("title",null,t)),a.createElement.apply(a,["svg",o].concat(s))}en.propTypes={"aria-label":ie().string,className:ie().string,style:ie().object};const tn=en;var nn=Object.prototype.hasOwnProperty,an=Object.getOwnPropertySymbols,rn=Object.prototype.propertyIsEnumerable,on=Object.assign;const sn=2*(0,Jt.Z)(Yt.Z.slowSpeed),ln=function(e){const{isProcessingSubscriptions:t,onPress:n}=e,r=((e,t)=>{var n={};for(var a in e)nn.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&an)for(var a of an(e))t.indexOf(a)<0&&rn.call(e,a)&&(n[a]=e[a]);return n})(e,["isProcessingSubscriptions","onPress"]),o=(0,Qt.Z)(t,!0,sn)||t;return a.createElement(Gt.Z,on(on({},r),{tooltip:(0,q.Z)("Check for new downloads"),tooltipAttachment:Xt.OI,"data-qa-id":"toolbarProcessSubscriptions",isDisabled:t,onPress:o?null:n}),o?a.createElement(Ft.Z,{className:"ToolbarProcessSubscriptionsButton-spinner-1LZvgq Spinner-spinner-5E5Wk_ spin-spin-oHlEXH"}):a.createElement(tn,{className:"ToolbarProcessSubscriptionsButton-icon-2TqatO PlexIcon-plexIcon-1hNiE2"}))},cn={onRefreshDownloads:S.GX},dn=(0,l.$j)((function(){return(0,c.P1)(U(),(0,_t.ZP)(x.l1),((e,t)=>({canShowProcessSubscriptions:e.length>0,isProcessingSubscriptions:!!t})))}),cn)((function(e){const{className:t,canShowProcessSubscriptions:n,isProcessingSubscriptions:r,onRefreshDownloads:o}=e;return a.createElement("div",{className:t},n?a.createElement(ln,{isProcessingSubscriptions:r,onPress:o}):null)})),pn=(0,c.P1)(Te.Z,Ee.Z,((e,t)=>{const{providers:n}=e;return n.reduce(((e,n)=>{const a=t[n].features.find((e=>e.type===St.P8));return a&&null!=a.storageTotal&&(e+=a.storageTotal),e}),0)})),un=(0,l.$j)((function(){return(0,c.P1)(((e,{activeSort:t})=>t),pn,U(),(0,c.P1)((0,xe.Z)(x.sC),(e=>e.reduce(((e,t)=>e+t.Context.currentSize||0),0))),((e,t,n,a)=>{const r=Dt({sort:e});return{downloadTypes:n.reduce(((t,n)=>{const{type:a,subtype:r}=n.hint;if(!(r?t.find((e=>e.subtype===r)):t.find((e=>e.type===a)))){const n=Dt({type:a,subtype:r,sort:e});t.push(n)}return t}),[r]),storageTotal:t+a}}))}))((function(e){const{serverEntityID:t,activeType:n,activeSubtype:r,activeSort:o,selectedSort:s,downloadTypes:i,storageTotal:l,sorts:c,size:d}=e,p=(0,Ot.Z)(),u=(0,Ot.Z)(),[m,y]=(0,a.useState)(l),[v,g]=(0,a.useState)(!1),[h,S]=(0,a.useState)(!1),b=(0,a.useCallback)((()=>{g(!v)}),[v]),P=(0,a.useCallback)((()=>{g(!1)}),[]),w=(0,a.useCallback)((()=>{S(!h)}),[h]),E=(0,a.useCallback)((()=>{S(!1)}),[]);(0,a.useEffect)((()=>{let e=window.setTimeout((()=>{y(l)}),100);return()=>{e=window.clearTimeout(e)}}),[l]);const Z=n||r?(0,q.Z)("All {typeTitle} Downloads",{typeTitle:Zt(n,r,!1)}):(0,q.Z)("All Downloads");return a.createElement(xt.Z,{className:"DownloadsPageHeader-pageHeader-dWvcMI PrimaryPageHeader-pageHeader-2h_9dt PageHeader-pageHeader-WpvbJc"},a.createElement(It.Z,null,a.createElement(Ct.Z,{id:p,"data-qa-id":"downloadsTypesMenuButton",hasMenu:i.length>2,isMenuOpen:v,onPress:b},Z),a.createElement(Vt,{target:p,isOpen:v,activeType:n,activeSubtype:r,types:i,onMenuClose:P}),d>1?a.createElement(Ct.Z,{id:u,"data-qa-id":"downloadsSortsMenuButton",hasMenu:!0,isMenuOpen:h,onPress:w},(0,q.Z)("By {sortTitle}",{sortTitle:s.title})):null,d>1?a.createElement(Bt,{target:u,isOpen:h,activeType:n,activeSubtype:r,activeSort:o,selectedSort:s,sorts:c,onMenuClose:E}):null,a.createElement(ft.Z,null,d)),a.createElement(Tt.Z,null,a.createElement("div",{className:"DownloadsPageHeader-storageTotal-2Bs463"},(0,q.Z)("{storageTotal} Downloaded",{storageTotal:Qe(m)})),a.createElement(dn,{serverEntityID:t})))})),mn="DownloadsPage-upsell-3JpmF2",yn=function(e){const{serverEntityID:t,activeType:n,activeSubtype:r,activeSort:o,selectedSort:s,sorts:i,mediaSubscriptions:l,metricsPage:c,metricsProperties:d,isProvidersPending:p,isProvidersPopulated:u,isMediaSubscriptionsPending:m,canShowUpsell:y,providersError:v,mediaSubscriptionsError:g}=e,[h,S]=(0,a.useState)(!1),b=(0,a.useCallback)((()=>{S(!0)}),[]),P=(0,a.useCallback)((()=>{S(!1)}),[]);if(p&&!u||m&&!l.length)return a.createElement(ne.Z,null,a.createElement(ee.Z,null));const w=v||g,E=l.length>0;return a.createElement(te.Z,{metricsPage:c,metricsProperties:d,allowBackgroundLightPreset:!0,scrollDirection:X.Hn},E?a.createElement(un,{serverEntityID:t,activeType:n,activeSubtype:r,activeSort:o,selectedSort:s,sorts:i,size:l.length}):null,a.createElement("div",{className:"DownloadsPage-downloadsPageContent-2VzUgn PageContent-pageContent-aqfjwt"},w?a.createElement(re.Z,null):null,w||E?null:a.createElement(ae.Z,{iconComponent:ue,kind:J._8,title:(0,q.Z)("You have no items downloaded"),description:a.createElement(Q.Z,{className:mn,message:(0,q.Z)('Use the {downloadIcon} button or choose "Download" from the menu to download items for offline playback.'),tags:[{unpaired:"downloadIcon",children:a.createElement(de,{key:"downloadIcon"})}]})},y?a.createElement(Q.Z,{className:mn,message:(0,q.Z)("An active {openPlexPassLink}Plex Pass{closePlexPassLink} is required to download from a Plex Media Server."),tags:[{open:"openPlexPassLink",close:"closePlexPassLink",component:G.Z,kind:J._8,onPress:b}]}):null),!w&&E?a.createElement(ht,{serverEntityID:t,items:l,size:l.length,metricsPage:c,metricsProperties:d,activeSort:o}):null,y?a.createElement(oe.Z,{origin:Y.Yz,isOpen:h,onModalClose:P}):null))};var vn=Object.prototype.hasOwnProperty,gn=Object.getOwnPropertySymbols,hn=Object.prototype.propertyIsEnumerable,Sn=Object.assign,bn=(e,t)=>{var n={};for(var a in e)vn.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&gn)for(var a of gn(e))t.indexOf(a)<0&&hn.call(e,a)&&(n[a]=e[a]);return n};const Pn={pane:"sync"};function wn(e,t){return!e&&!t||p().isEqual(e,t)}const En=(0,h.Z)((e=>{const{key:t,direction:n}=e,{DESCENDING:a}=u.Z.directions;return(e,r)=>{let o,s;return t===V?(o=e.hint[t].toUpperCase(),s=r.hint[t].toUpperCase()):(o=e[t],s=r[t]),o>s?n===a?-1:1:o<s?n===a?1:-1:0}})),Zn={dispatchFetchProvidersWithStorage:H,dispatchInitDownloadsPage:R,dispatchRefreshDownloads:S.GX,dispatchResetDownloadsPage:W,dispatchSaveDownloadsParams:z};class Dn extends a.Component{componentDidMount(){this.props.dispatchInitDownloadsPage(),this.props.dispatchFetchProvidersWithStorage(),this.props.dispatchRefreshDownloads(),this.props.shouldSaveParams&&this._saveDownloadsDefaultParams(this.props)}componentDidUpdate(e){this.props.shouldSaveParams&&!wn(e.params,this.props.params)&&this._saveDownloadsDefaultParams(this.props)}componentWillUnmount(){this.props.dispatchResetDownloadsPage()}_saveDownloadsDefaultParams(e){wn(e.params,e.savedDownloadsParams)||e.dispatchSaveDownloadsParams(e.params)}render(){const e=this.props,{params:t,savedDownloadsParams:n,dispatchFetchProvidersWithStorage:r,dispatchRefreshDownloads:o,dispatchInitDownloadsPage:s,dispatchResetDownloadsPage:i,dispatchSaveDownloadsParams:l}=e,c=bn(e,["params","savedDownloadsParams","dispatchFetchProvidersWithStorage","dispatchRefreshDownloads","dispatchInitDownloadsPage","dispatchResetDownloadsPage","dispatchSaveDownloadsParams"]);return a.createElement(yn,Sn(Sn({},c),{metricsPage:v.Q_,metricsProperties:Pn}))}}const fn=(0,l.$j)((function(){return(0,c.P1)(((e,{params:t})=>t),(e=>e.ui.downloadsPage),(e=>e.downloads),y.Z,U(),(0,m.Z)(g.iU),(0,m.Z)(g.Ed),((e,t,n,a,r,o,s)=>{const{sort:i=""}=e;let{type:l,subtype:c}=e;const{isProvidersPending:d,isProvidersPopulated:p,providersError:u}=t,{isSubscriptionsPending:m,subscriptionsError:y}=n,v=[{key:V,descKey:"title:desc",defaultDirection:$,title:(0,q.Z)("Title")},{key:_,descKey:"createdAt:desc",defaultDirection:K,title:(0,q.Z)("Date Downloaded"),isDefault:!0},{key:F,descKey:"storageTotal:desc",defaultDirection:K,title:(0,q.Z)("Size on Disk")}],g=i.split(":");let h=g[0];const S=g[1];let b=v.find((e=>e.key===h));b||(b=v.find((e=>e.isDefault))),h||(h=b.key),S&&(b.direction=S);let P=[...r];if((l||c)&&(P=r.reduce(((e,t)=>{const n=t.hint.subtype===c,a=t.hint.type===l;let r=!1;return c?n&&(r=!0):a&&!t.hint.subtype&&(r=!0),r&&e.push(t),e}),[]),r.length&&!P.length)){const{type:t,subtype:n}=e;P=r,e=bn(e,["type","subtype"]),l=null,c=null}const w=En(b);return P.sort(w),{selectedSort:b,sorts:v,mediaSubscriptions:P.map((e=>e.entityID)),isProvidersPending:d,isProvidersPopulated:p,isMediaSubscriptionsPending:m,canShowUpsell:!o&&!s,providersError:u,mediaSubscriptionsError:y,savedDownloadsParams:a.downloads,params:e,activeType:l,activeSubtype:c,activeSort:i}}))}),Zn)(Dn);var Cn=n(40875),In=n(30263),On=n(68576);const xn=function(e){const{children:t,isWaitingForEmbeddedServer:n,embeddedServerEntityID:r}=e;return n?a.createElement(ne.Z,null,a.createElement(ee.Z,null)):r?a.createElement(In.Z,{serverEntityID:r},t(r)):a.createElement(On.Z,null)};var Tn=Object.prototype.hasOwnProperty,kn=Object.getOwnPropertySymbols,Nn=Object.prototype.propertyIsEnumerable,jn=Object.assign;const Mn=(0,c.P1)(Te.Z,((e={})=>{const{entityID:t,isProvidersPopulated:n=!1}=e;return{embeddedServerEntityID:t,isProvidersPopulated:n}})),An={dispatchChangeQuickSearchSettings:Cn.changeQuickSearchSettings};class Ln extends a.Component{componentDidMount(){this.props.dispatchChangeQuickSearchSettings({providerEntityID:null,providerIdentifier:null,serverEntityID:null,directoryID:null})}render(){const e=this.props,{isProvidersPopulated:t,dispatchChangeQuickSearchSettings:n}=e,r=((e,t)=>{var n={};for(var a in e)Tn.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&kn)for(var a of kn(e))t.indexOf(a)<0&&Nn.call(e,a)&&(n[a]=e[a]);return n})(e,["isProvidersPopulated","dispatchChangeQuickSearchSettings"]);return a.createElement(xn,jn(jn({},r),{isWaitingForEmbeddedServer:!t}))}}const Rn=(0,l.$j)(Mn,An)(Ln);function Wn(){const e=(0,o.Z)(),t=(0,a.useMemo)((()=>({context:(0,i.Z)(e.context),type:(0,i.Z)(e.type),subtype:(0,i.Z)(e.subtype),sort:(0,i.Z)(e.sort),save:(0,s.Z)(e.save)})),[e]);return a.createElement(r.Z,{metricsContext:t.context},a.createElement(Rn,null,(e=>a.createElement(fn,{serverEntityID:e,params:t,shouldSaveParams:t.save}))))}}}]);