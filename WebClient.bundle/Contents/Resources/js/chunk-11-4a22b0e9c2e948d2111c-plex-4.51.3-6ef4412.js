(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{RG42:function(e,t,n){(function(e){
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
!function(){var n="undefined"!=typeof window?window:e,i={};for(var r in function(e,t,n){var i,r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},a=void 0!==e&&e===this?this:void 0!==t&&null!=t?t:this;function o(){o=function(){},a.Symbol||(a.Symbol=u)}var s,u=(s=0,function(e){return"jscomp_symbol_"+(e||"")+s++});function c(){o();var e=a.Symbol.iterator;e||(e=a.Symbol.iterator=a.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&r(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return l(this)}}),c=function(){}}function l(e){var t=0;return f((function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}))}function f(e){return c(),(e={next:e})[a.Symbol.iterator]=function(){return this},e}function d(e){c();var t=e[Symbol.iterator];return t?t.call(e):l(e)}function h(e,t){if(t){for(var n=a,i=e.split("."),o=0;o<i.length-1;o++){var s=i[o];s in n||(n[s]={}),n=n[s]}(s=t(o=n[i=i[i.length-1]]))!=o&&null!=s&&r(n,i,{configurable:!0,writable:!0,value:s})}}function p(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(i,r){!function e(a){a.done?i(a.value):Promise.resolve(a.value).then(t,n).then(e,r)}(e.next())}))}(e())}h("Promise",(function(e){function t(e){this.b=0,this.g=void 0,this.a=[];var t=this.c();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.a=null}function i(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.b=function(e){null==this.a&&(this.a=[],this.f()),this.a.push(e)},n.prototype.f=function(){var e=this;this.c((function(){e.h()}))};var r=a.setTimeout;n.prototype.c=function(e){r(e,0)},n.prototype.h=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.g(e)}}}this.a=null},n.prototype.g=function(e){this.c((function(){throw e}))},t.prototype.c=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.u),reject:e(this.f)}},t.prototype.u=function(e){if(e===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.v(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.o(e):this.h(e)}},t.prototype.o=function(e){var t=void 0;try{t=e.then}catch(e){return void this.f(e)}"function"==typeof t?this.F(t,e):this.h(e)},t.prototype.f=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.g=t,this.l()},t.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)o.b(this.a[e]);this.a=null}};var o=new n;return t.prototype.v=function(e){var t=this.c();e.kc(t.resolve,t.reject)},t.prototype.F=function(e,t){var n=this.c();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(e){a(e)}}:t}var r,a,o=new t((function(e,t){r=e,a=t}));return this.kc(i(e,r),i(n,a)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.kc=function(e,t){function n(){switch(i.b){case 1:e(i.g);break;case 2:t(i.g);break;default:throw Error("Unexpected state: "+i.b)}}var i=this;null==this.a?o.b(n):this.a.push(n)},t.resolve=i,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var r=d(e),a=r.next();!a.done;a=r.next())i(a.value).kc(t,n)}))},t.all=function(e){var n=d(e),r=n.next();return r.done?i([]):new t((function(e,t){function a(t){return function(n){o[t]=n,0==--s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,i(r.value).kc(a(o.length-1),t),r=n.next()}while(!r.done)}))},t})),h("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}}));var m,g="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)m=Object.setPrototypeOf;else{var v;e:{var y={};try{y.__proto__={Oe:!0},v=y.Oe;break e}catch(s){}v=!1}m=v?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var b=m;function w(e,t){if(e.prototype=g(t.prototype),e.prototype.constructor=e,b)b(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.Dg=t.prototype}function T(){this.g=!1,this.c=null,this.s=void 0,this.j=1,this.b=this.f=0,this.i=this.a=null}function S(e){if(e.g)throw new TypeError("Generator is already running");e.g=!0}function E(e,t){e.a={Yd:t,ie:!0},e.j=e.f||e.b}function x(e,t,n){return e.j=n,{value:t}}function k(e){e.j=0}function A(e,t,n){e.f=t,null!=n&&(e.b=n)}function M(e,t){e.f=0,e.b=t||0}function I(e,t){e.j=t,e.f=0}function P(e){e.f=0;var t=e.a.Yd;return e.a=null,t}function C(e){e.i=[e.a],e.f=0,e.b=0}function R(e,t){var n=e.i.splice(0)[0];(n=e.a=e.a||n)?n.ie?e.j=e.f||e.b:null!=n.C&&e.b<n.C?(e.j=n.C,e.a=null):e.j=e.b:e.j=t}function N(e){this.a=new T,this.b=e}function D(e,t,n,i){try{var r=t.call(e.a.c,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.a.g=!1,r;var a=r.value}catch(t){return e.a.c=null,E(e.a,t),L(e)}return e.a.c=null,i.call(e.a,a),L(e)}function L(e){for(;e.a.j;)try{var t=e.b(e.a);if(t)return e.a.g=!1,{value:t.value,done:!1}}catch(t){e.a.s=void 0,E(e.a,t)}if(e.a.g=!1,e.a.a){if(t=e.a.a,e.a.a=null,t.ie)throw t.Yd;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function U(e){this.next=function(t){return S(e.a),e.a.c?t=D(e,e.a.c.next,t,e.a.h):(e.a.h(t),t=L(e)),t},this.throw=function(t){return S(e.a),e.a.c?t=D(e,e.a.c.throw,t,e.a.h):(E(e.a,t),t=L(e)),t},this.return=function(t){return function(e,t){S(e.a);var n=e.a.c;return n?D(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.a.return):(e.a.return(t),L(e))}(e,t)},c(),this[Symbol.iterator]=function(){return this}}function _(e,t){return U.prototype=e.prototype,new U(new N(t))}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function j(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var a=e[r];if(t.call(n,a,r,e))return{fe:r,Je:a}}return{fe:-1,Je:void 0}}function K(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}T.prototype.h=function(e){this.s=e},T.prototype.return=function(e){this.a={return:e},this.j=this.b},T.prototype.C=function(e){this.j=e},h("WeakMap",(function(e){function t(e){if(this.a=(s+=Math.random()+1).toString(),e){o(),c(),e=d(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(e){O(e,a)||r(e,a,{value:{}})}function i(e){var t=Object[e];t&&(Object[e]=function(e){return n(e),t(e)})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([[t,2],[n,3]]);return 2==i.get(t)&&3==i.get(n)&&(i.delete(t),i.set(n,4),!i.has(t)&&4==i.get(n))}catch(e){return!1}}())return e;var a="$jscomp_hidden_"+Math.random();i("freeze"),i("preventExtensions"),i("seal");var s=0;return t.prototype.set=function(e,t){if(n(e),!O(e,a))throw Error("WeakMap key fail: "+e);return e[a][this.a]=t,this},t.prototype.get=function(e){return O(e,a)?e[a][this.a]:void 0},t.prototype.has=function(e){return O(e,a)&&O(e[a],this.a)},t.prototype.delete=function(e){return!(!O(e,a)||!O(e[a],this.a))&&delete e[a][this.a]},t})),h("Map",(function(e){function t(){var e={};return e.Ja=e.next=e.head=e}function n(e,t){var n=e.a;return f((function(){if(n){for(;n.head!=e.a;)n=n.Ja;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function i(e,t){var n=t&&typeof t;"object"==n||"function"==n?a.has(t)?n=a.get(t):(n=""+ ++s,a.set(t,n)):n="p_"+t;var i=e.b[n];if(i&&O(e.b,n))for(var r=0;r<i.length;r++){var o=i[r];if(t!=t&&o.key!=o.key||t===o.key)return{id:n,list:i,index:r,ba:o}}return{id:n,list:i,index:-1,ba:void 0}}function r(e){if(this.b={},this.a=t(),this.size=0,e){e=d(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&!((r=i.next()).done||4!=r.value[0].x||"t"!=r.value[1]||!i.next().done)}catch(e){return!1}}())return e;o(),c();var a=new WeakMap;r.prototype.set=function(e,t){var n=i(this,e);return n.list||(n.list=this.b[n.id]=[]),n.ba?n.ba.value=t:(n.ba={next:this.a,Ja:this.a.Ja,head:this.a,key:e,value:t},n.list.push(n.ba),this.a.Ja.next=n.ba,this.a.Ja=n.ba,this.size++),this},r.prototype.delete=function(e){return!(!(e=i(this,e)).ba||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.b[e.id],e.ba.Ja.next=e.ba.next,e.ba.next.Ja=e.ba.Ja,e.ba.head=null,this.size--,!0)},r.prototype.clear=function(){this.b={},this.a=this.a.Ja=t(),this.size=0},r.prototype.has=function(e){return!!i(this,e).ba},r.prototype.get=function(e){return(e=i(this,e).ba)&&e.value},r.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},r.prototype.keys=function(){return n(this,(function(e){return e.key}))},r.prototype.values=function(){return n(this,(function(e){return e.value}))},r.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var s=0;return r})),h("Set",(function(e){function t(e){if(this.a=new Map,e){e=d(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.a.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&r.value[1]==t&&(!(r=i.next()).done&&r.value[0]!=t&&4==r.value[0].x&&r.value[1]==r.value[0]&&i.next().done)}catch(e){return!1}}()?e:(o(),c(),t.prototype.add=function(e){return this.a.set(e,e),this.size=this.a.size,this},t.prototype.delete=function(e){return e=this.a.delete(e),this.size=this.a.size,e},t.prototype.clear=function(){this.a.clear(),this.size=0},t.prototype.has=function(e){return this.a.has(e)},t.prototype.entries=function(){return this.a.entries()},t.prototype.values=function(){return this.a.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.a.forEach((function(i){return e.call(t,i,i,n)}))},t)})),h("Array.prototype.findIndex",(function(e){return e||function(e,t){return j(this,e,t).fe}})),h("Array.prototype.keys",(function(e){return e||function(){return function(e,t){c(),e instanceof String&&(e+="");var n=0,i={next:function(){if(n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i.next=function(){return{done:!0,value:void 0}},i.next()}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}})),h("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),h("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length,r=t||0;for(0>r&&(r=Math.max(r+i,0));r<i;r++){var a=n[r];if(a===e||Object.is(a,e))return!0}return!1}})),h("String.prototype.includes",(function(e){return e||function(e,t){return-1!==K(this,e,"includes").indexOf(e,t||0)}})),h("Array.from",(function(e){return e||function(e,t,n){c(),t=null!=t?t:function(e){return e};var i=[],r=e[Symbol.iterator];if("function"==typeof r)for(e=r.call(e);!(r=e.next()).done;)i.push(t.call(n,r.value));else{r=e.length;for(var a=0;a<r;a++)i.push(t.call(n,e[a]))}return i}})),h("String.prototype.startsWith",(function(e){return e||function(e,t){for(var n=K(this,e,"startsWith"),i=n.length,r=e.length,a=Math.max(0,Math.min(0|t,n.length)),o=0;o<r&&a<i;)if(n[a++]!=e[o++])return!1;return o>=r}})),h("Array.prototype.find",(function(e){return e||function(e,t){return j(this,e,t).Je}}));var B="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)O(i,r)&&(e[r]=i[r])}return e};h("Object.assign",(function(e){return e||B}));var F=this;function H(e,t){var n,i=e.split("."),r=F;i[0]in r||!r.execScript||r.execScript("var "+i[0]);for(;i.length&&(n=i.shift());)i.length||void 0===t?r=r[n]?r[n]:r[n]={}:r[n]=t}function V(e,t){function n(){}n.prototype=t.prototype,e.Dg=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Og=function(e,n,i){return t.prototype[n].apply(e,Array.prototype.slice.call(arguments,2))}}function q(e){this.c=Math.exp(Math.log(.5)/e),this.b=this.a=0}function z(e,t,n){var i=Math.pow(e.c,t);n=n*(1-i)+i*e.a,isNaN(n)||(e.a=n,e.b+=t)}function G(e){return e.a/(1-Math.pow(e.c,e.b))}function W(){this.b=new q(2),this.c=new q(5),this.a=0}F.a=!0,W.prototype.getBandwidthEstimate=function(e){return 128e3>this.a?e:Math.min(G(this.b),G(this.c))};var X={mb:0,jc:function(){},Z:function(){},error:function(){},m:function(){},info:function(){},debug:function(){},D:function(){},J:function(){}};e.console&&e.console.log.bind&&(X.Z=console.warn.bind(console),X.jc=console.error.bind(console),1<=X.mb&&(X.error=console.error.bind(console)),2<=X.mb&&(X.m=console.warn.bind(console)),3<=X.mb&&(X.info=console.info.bind(console)),4<=X.mb&&(X.debug=console.log.bind(console)),5<=X.mb&&(X.D=console.debug.bind(console)),6<=X.mb&&(X.J=console.debug.bind(console)));
/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
var Y=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;
/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/function $(e){var t;e instanceof $?(J(this,e.xa),this.jb=e.jb,this.wa=e.wa,Q(this,e.Jb),this.la=e.la,Z(this,e.a.clone()),this.Xa=e.Xa):e&&(t=String(e).match(Y))?(J(this,t[1]||"",!0),this.jb=ee(t[2]||""),this.wa=ee(t[3]||"",!0),Q(this,t[4]),this.la=ee(t[5]||"",!0),Z(this,t[6]||"",!0),this.Xa=ee(t[7]||"")):this.a=new ue(null)}function J(e,t,n){e.xa=n?ee(t,!0):t,e.xa&&(e.xa=e.xa.replace(/:$/,""))}function Q(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Jb=t}else e.Jb=null}function Z(e,t,n){t instanceof ue?e.a=t:(n||(t=te(t,oe)),e.a=new ue(t))}function ee(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function te(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ne),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ne(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(i=$.prototype).xa="",i.jb="",i.wa="",i.Jb=null,i.la="",i.Xa="",i.toString=function(){var e=[],t=this.xa;if(t&&e.push(te(t,ie,!0),":"),t=this.wa){e.push("//");var n=this.jb;n&&e.push(te(n,ie,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Jb)&&e.push(":",String(t))}return(t=this.la)&&(this.wa&&"/"!=t.charAt(0)&&e.push("/"),e.push(te(t,"/"==t.charAt(0)?ae:re,!0))),(t=this.a.toString())&&e.push("?",t),(t=this.Xa)&&e.push("#",te(t,se)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.xa&&(t=new $);var n=!!e.xa;n?J(t,e.xa):n=!!e.jb,n?t.jb=e.jb:n=!!e.wa,n?t.wa=e.wa:n=null!=e.Jb;var i=e.la;if(n)Q(t,e.Jb);else if(n=!!e.la){if("/"!=i.charAt(0))if(this.wa&&!this.la)i="/"+i;else{var r=t.la.lastIndexOf("/");-1!=r&&(i=t.la.substr(0,r+1)+i)}if(".."==i||"."==i)i="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var a=[],o=0;o<i.length;){var s=i[o++];"."==s?r&&o==i.length&&a.push(""):".."==s?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),r&&o==i.length&&a.push("")):(a.push(s),r=!0)}i=a.join("/")}}return n?t.la=i:n=""!==e.a.toString(),n?Z(t,e.a.clone()):n=!!e.Xa,n&&(t.Xa=e.Xa),t},i.clone=function(){return new $(this)};var ie=/[#\/\?@]/g,re=/[#\?:]/g,ae=/[#\?]/g,oe=/[#\?@]/g,se=/#/g;function ue(e){this.a=e||null}function ce(e){this.b=e,this.a=null}function le(e){this.b=e,this.a=null}function fe(e,t){var n={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0};this.i=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.f=null==e.baseDelay?n.baseDelay:e.baseDelay,this.h=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.g=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==t&&t)&&(this.a=1)}function de(e){return p((function t(){var n,i;return _(t,(function(t){switch(t.j){case 1:if(e.a>=e.i){if(!e.c)return t.return(Promise.reject());e.a=1,e.b=e.f}return n=e.a,e.a++,0==n?t.return():(i=e.b*(1+(2*Math.random()-1)*e.h),x(t,new Promise((function(e){new le(e).R(i/1e3)})),2));case 2:e.b*=e.g,k(t)}}))}))}function he(e,t,n,i){for(var r=[],a=3;a<arguments.length;++a)r[a-3]=arguments[a];this.severity=e,this.category=t,this.code=n,this.data=r,this.handled=!1}function pe(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n}function me(e,t){this.promise=e,this.me=t,this.a=!1}function ge(e){return new me(Promise.reject(e),(function(){return Promise.resolve()}))}function ve(){var e=Promise.reject(new he(2,7,7001));return e.catch((function(){})),new me(e,(function(){return Promise.resolve()}))}function ye(e){return new me(Promise.resolve(e),(function(){return Promise.resolve()}))}function be(e){return new me(e,(function(){return e.catch((function(){}))}))}function we(e){return new me(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))}function Te(t,n){for(var i in n=void 0===n?{}:n)this[i]=n[i];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function Se(){this.a={}}function Ee(){this.Sc=new Se,this.gc=this}function xe(e){var t=new Set;return function e(n){switch(typeof n){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;default:if(!n||n.buffer&&n.buffer.constructor==ArrayBuffer)return n;if(t.has(n))return null;var i=n.constructor==Array;if(n.constructor!=Object&&!i)return null;t.add(n);var r,a=i?[]:{};for(r in n)a[r]=e(n[r]);return i&&(a.length=n.length),a}}(e)}function ke(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function Ae(e,t){var n=e.indexOf(t);-1<n&&e.splice(n,1)}function Me(e,t,n){if(n||(n=ke),e.length!=t.length)return!1;t=t.slice();for(var i={},r=(e=d(e)).next();!r.done;i={item:i.item},r=e.next()){if(i.item=r.value,-1==(r=t.findIndex(function(e){return function(t){return n(e.item,t)}}(i))))return!1;t[r]=t[t.length-1],t.pop()}return 0==t.length}function Ie(){this.a=[]}function Pe(e,t){e.a.push(t.finally((function(){Ae(e.a,t)})))}function Ce(e){Ee.call(this),this.f=!1,this.g=new Ie,this.a=new Set,this.b=new Set,this.c=e||null}(i=ue.prototype).ja=null,i.nc=null,i.add=function(e,t){if(!this.ja&&(this.ja={},this.nc=0,this.a))for(var n=this.a.split("&"),i=0;i<n.length;i++){var r=n[i].indexOf("="),a=null;if(0<=r){var o=n[i].substring(0,r);a=n[i].substring(r+1)}else o=n[i];o=decodeURIComponent(o.replace(/\+/g," ")),a=a||"",this.add(o,decodeURIComponent(a.replace(/\+/g," ")))}return this.a=null,(n=this.ja.hasOwnProperty(e)&&this.ja[e])||(this.ja[e]=n=[]),n.push(t),this.nc++,this},i.toString=function(){if(this.a)return this.a;if(!this.ja)return"";var e,t=[];for(e in this.ja)for(var n=encodeURIComponent(e),i=this.ja[e],r=0;r<i.length;r++){var a=n;""!==i[r]&&(a+="="+encodeURIComponent(i[r])),t.push(a)}return this.a=t.join("&")},i.clone=function(){var e=new ue;if(e.a=this.a,this.ja){var t,n={};for(t in this.ja)n[t]=this.ja[t].concat();e.ja=n,e.nc=this.nc}return e},ce.prototype.R=function(t){var n=this;this.stop();var i=!0,r=null;return this.a=function(){e.clearTimeout(r),i=!1},r=e.setTimeout((function(){i&&n.b()}),1e3*t),this},ce.prototype.stop=function(){this.a&&(this.a(),this.a=null)},H("shaka.util.Timer",le),le.prototype.Gc=function(){return this.stop(),this.b(),this},le.prototype.tickNow=le.prototype.Gc,le.prototype.R=function(e){var t=this;return this.stop(),this.a=new ce((function(){t.b()})).R(e),this},le.prototype.tickAfter=le.prototype.R,le.prototype.Ka=function(e){var t=this;return this.stop(),this.a=new ce((function(){t.a.R(e),t.b()})).R(e),this},le.prototype.tickEvery=le.prototype.Ka,le.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},le.prototype.stop=le.prototype.stop,H("shaka.util.Error",he),he.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},he.Severity={RECOVERABLE:1,CRITICAL:2},he.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},he.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013},pe.prototype.resolve=function(){},pe.prototype.reject=function(){},H("shaka.util.AbortableOperation",me),me.failed=ge,me.aborted=ve,me.completed=ye,me.notAbortable=be,me.prototype.abort=function(){return this.a=!0,this.me()},me.prototype.abort=me.prototype.abort,me.all=we,me.prototype.finally=function(e){return this.promise.then((function(){return e(!0)}),(function(){return e(!1)})),this},me.prototype.finally=me.prototype.finally,me.prototype.Y=function(e,t){function n(n){return function(s){if(r.a&&n)a.reject(o);else{var u=n?e:t;u?i=function(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then((function(){}),(function(){}))})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}(u,s,a):(n?a.resolve:a.reject)(s)}}}function i(){return a.reject(o),r.abort()}var r=this,a=new pe,o=new he(2,7,7001);return this.promise.then(n(!0),n(!1)),new me(a,(function(){return i()}))},me.prototype.chain=me.prototype.Y,Te.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Te.prototype.stopImmediatePropagation=function(){this.a=!0},Te.prototype.stopPropagation=function(){},(i=Se.prototype).push=function(e,t){this.a.hasOwnProperty(e)?this.a[e].push(t):this.a[e]=[t]},i.get=function(e){return(e=this.a[e])?e.slice():null},i.getAll=function(){var e,t=[];for(e in this.a)t.push.apply(t,this.a[e]);return t},i.remove=function(e,t){var n=this.a[e];if(n)for(var i=0;i<n.length;++i)n[i]==t&&(n.splice(i,1),--i)},i.forEach=function(e){for(var t in this.a)e(t,this.a[t])},Ee.prototype.addEventListener=function(e,t){this.Sc.push(e,t)},Ee.prototype.removeEventListener=function(e,t){this.Sc.remove(e,t)},Ee.prototype.dispatchEvent=function(e){for(var t=this.Sc.get(e.type)||[],n=0;n<t.length;++n){e.target=this.gc,e.currentTarget=this.gc;var i=t[n];try{i.handleEvent?i.handleEvent(e):i.call(this,e)}catch(e){X.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.a)break}return e.defaultPrevented},Ie.prototype.destroy=function(){var e=[];return this.a.forEach((function(t){t.promise.catch((function(){})),e.push(t.abort())})),this.a=[],Promise.all(e)},V(Ce,Ee),H("shaka.net.NetworkingEngine",Ce),Ce.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},Ce.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Re={};function Ne(e,t,n){n=n||3;var i=Re[e];(!i||n>=i.priority)&&(Re[e]={priority:n,dg:t})}function De(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null}}function Le(){this.a=0}function Ue(e,t,n){me.call(this,e,t),this.b=n}function _e(){}function Oe(){this.a=new Se}function je(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.a=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter((function(e){return!n.has(e)})),function(e){var t=Ke;if(null==t){t=!1;try{var n={},i={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(e){t=!1}Ke=t}return t||!1}(e)?t:t.capture||!1}(e,i),this.target.addEventListener(t,n,this.a)}Ce.registerScheme=Ne,Ce.unregisterScheme=function(e){delete Re[e]},Ce.prototype.fg=function(e){this.a.add(e)},Ce.prototype.registerRequestFilter=Ce.prototype.fg,Ce.prototype.Fg=function(e){this.a.delete(e)},Ce.prototype.unregisterRequestFilter=Ce.prototype.Fg,Ce.prototype.We=function(){this.a.clear()},Ce.prototype.clearAllRequestFilters=Ce.prototype.We,Ce.prototype.gg=function(e){this.b.add(e)},Ce.prototype.registerResponseFilter=Ce.prototype.gg,Ce.prototype.Gg=function(e){this.b.delete(e)},Ce.prototype.unregisterResponseFilter=Ce.prototype.Gg,Ce.prototype.Xe=function(){this.b.clear()},Ce.prototype.clearAllResponseFilters=Ce.prototype.Xe,Ce.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}},Ce.makeRequest=De,Ce.prototype.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.g.destroy()},Ce.prototype.destroy=Ce.prototype.destroy,Ce.prototype.request=function(e,t){var n=this,i=new Le;if(this.f){var r=Promise.reject(new he(2,7,7001));return r.catch((function(){})),new Ue(r,(function(){return Promise.resolve()}),i)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?xe(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},t.uris=xe(t.uris);var a=(r=function(e,t,n){for(var i=ye(void 0),r={},a=(e=d(e.a)).next();!a.done;r={Ad:r.Ad},a=e.next())r.Ad=a.value,i=i.Y(function(e){return function(){return e.Ad(t,n)}}(r));return i.Y(void 0,(function(e){if(e&&7001==e.code)throw e;throw new he(2,1,1006,e)}))}(this,e,t)).Y((function(){return function e(t,n,i,r,a,o,s){var u=new $(i.uris[a]),c=u.xa,l=!1;c||(c=(c=location.protocol).slice(0,-1),J(u,c),i.uris[a]=u.toString()),c=c.toLowerCase();var f,d=(c=Re[c])?c.dg:null;return d?be(de(r)).Y((function(){return t.f?ve():(f=Date.now(),d(i.uris[a],i,n,(function(e,i,r){t.c&&1==n&&(t.c(e,i),l=!0,s.a=r)})))})).Y((function(e){return null==e.timeMs&&(e.timeMs=Date.now()-f),{response:e,Ef:l}}),(function(u){if(u&&7001==u.code)throw u;if(t.f)return ve();if(u&&1==u.severity)return t.dispatchEvent(new Te("retry",{error:u instanceof he?u:null})),a=(a+1)%i.uris.length,e(t,n,i,r,a,u,s);throw u||o})):ge(new he(2,1,1e3,u))}(n,e,t,new fe(t.retryParameters,!1),0,null,i)})),o=a.Y((function(t){return function(e,t,n){for(var i=ye(void 0),r=(e=d(e.b)).next();!r.done;r=e.next())i=i.Y(r.value.bind(null,t,n.response));return i.Y((function(){return n}),(function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof he&&(t=e.severity),new he(t,1,1007,e)}))}(n,e,t)})),s=Date.now(),u=0;r.promise.then((function(){u=Date.now()-s}),(function(){}));var c=0;return a.promise.then((function(){c=Date.now()}),(function(){})),r=new Ue((r=o.Y((function(t){var i=Date.now()-c,r=t.response;return r.timeMs+=u,r.timeMs+=i,t.Ef||!n.c||r.fromCache||1!=e||n.c(r.timeMs,r.data.byteLength),r}),(function(e){throw e&&(e.severity=2),e}))).promise,r.me,i),Pe(this.g,r),r},Ce.prototype.request=Ce.prototype.request,Ce.NumBytesRemainingClass=Le,w(Ue,me),Ce.PendingRequest=Ue,Ue.all=we,Ue.notAbortable=be,Ue.completed=ye,Ue.aborted=ve,Ue.failed=ge,H("shaka.util.IReleasable",_e),_e.prototype.release=function(){},H("shaka.util.EventManager",Oe),Oe.prototype.release=function(){this.hb(),this.a=null},Oe.prototype.release=Oe.prototype.release,Oe.prototype.B=function(e,t,n,i){this.a&&(e=new je(e,t,n,i),this.a.push(t,e))},Oe.prototype.listen=Oe.prototype.B,Oe.prototype.ua=function(e,t,n,i){var r=this;this.B(e,t,(function i(a){r.pa(e,t,i),n(a)}),i)},Oe.prototype.listenOnce=Oe.prototype.ua,Oe.prototype.pa=function(e,t,n){if(this.a)for(var i=this.a.get(t)||[],r=(i=d(i)).next();!r.done;r=i.next())(r=r.value).target!=e||n!=r.listener&&n||(r.pa(),this.a.remove(t,r))},Oe.prototype.unlisten=Oe.prototype.pa,Oe.prototype.hb=function(){if(this.a){for(var e=this.a.getAll(),t=(e=d(e)).next();!t.done;t=e.next())t.value.pa();this.a.a={}}},Oe.prototype.removeAll=Oe.prototype.hb,je.prototype.pa=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1},je.prototype.unlisten=je.prototype.pa;var Ke=void 0;function Be(e){return new $(e=ot(e)).wa}function Fe(e,t,n){function i(e){new DataView(r.buffer).setUint32(a,e.byteLength,!0),a+=4,r.set(e,a),a+=e.byteLength}if(!n||!n.byteLength)throw new he(2,6,6015);t="string"==typeof t?new Uint8Array(ut(t,!0)):new Uint8Array(t),e=ut(e=ot(e),!0);var r=new Uint8Array(12+e.byteLength+t.byteLength+n.byteLength),a=0;return i(new Uint8Array(e)),i(t),i(new Uint8Array(n)),r}function He(e,t){for(var n=[],i=d(e),r=i.next();!r.done;r=i.next())n.push(t(r.value));return n}function Ve(e,t){for(var n=d(e),i=n.next();!i.done;i=n.next())if(!t(i.value))return!1;return!0}function qe(e){var t=new Map;return Object.keys(e).forEach((function(n){t.set(n,e[n])})),t}function ze(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}function Ge(e,t){var n=e;return t&&(n+='; codecs="'+t+'"'),n}function We(e){var t=(e=e.split("."))[0];return e.pop(),[t,e.join(".")]}H("shaka.util.FairPlayUtils.defaultGetContentId",Be),H("shaka.util.FairPlayUtils.initDataTransform",Fe);var Xe=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Ye(){return!(!e.MediaSource||!MediaSource.isTypeSupported)}function $e(e){return""!=tt().canPlayType(e)}function Je(){return!!navigator.userAgent.match(/Edge?\//)}function Qe(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!et("Tizen")}function Ze(){if(!Qe())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function et(e){return(navigator.userAgent||"").includes(e)}function tt(){return it||(nt||(nt=new le((function(){it=null}))),(it=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(it=document.createElement("video")),nt.R(1),it)}var nt=null,it=null;function rt(e){if(!e)return"";239==(e=new Uint8Array(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=ct(e),e=escape(e);try{return decodeURIComponent(e)}catch(e){throw new he(2,2,2004)}}function at(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw X.error("Data has an incorrect length, must be even."),new he(2,2,2004);if(e instanceof ArrayBuffer)var i=e;else(n=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),i=n.buffer;e=Math.floor(e.byteLength/2),n=new Uint16Array(e),i=new DataView(i);for(var r=0;r<e;r++)n[r]=i.getUint16(2*r,t);return ct(n)}function ot(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return rt(t);if(254==t[0]&&255==t[1])return at(t.subarray(2),!1);if(255==t[0]&&254==t[1])return at(t.subarray(2),!0);var n=function(e,t){return e.byteLength<=t||32<=e[t]&&126>=e[t]}.bind(null,t);if(X.debug("Unable to find byte-order-mark, making an educated guess."),0==t[0]&&0==t[2])return at(e,!1);if(0==t[1]&&0==t[3])return at(e,!0);if(n(0)&&n(1)&&n(2)&&n(3))return rt(e);throw new he(2,2,2003)}function st(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}function ut(e,t){for(var n=new Uint8Array(2*e.length),i=new DataView(n.buffer),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n.buffer}function ct(e){if(!lt)for(var t=function(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(e){return!1}},n={size:65536};0<n.size;(n={size:n.size}).size/=2)if(t(n.size)){lt=function(e){return function(t){for(var n="",i=0;i<t.length;i+=e.size)n+=String.fromCharCode.apply(null,t.subarray(i,i+e.size));return n}}(n);break}return lt(e)}H("shaka.util.StringUtils.fromUTF8",rt),H("shaka.util.StringUtils.fromUTF16",at),H("shaka.util.StringUtils.fromBytesAutoDetect",ot),H("shaka.util.StringUtils.toUTF8",st),H("shaka.util.StringUtils.toUTF16",ut);var lt=null;H("shaka.util.StringUtils.resetFromCharCode",(function(){lt=null}));var ft={Hc:function(t,n){var i=ct(t);return n=null==n||n,i=e.btoa(i).replace(/\+/g,"-").replace(/\//g,"_"),n?i:i.replace(/=*$/,"")}};function dt(e,t){var n=this;t=void 0===t?1:t,this.F=e,this.u=new Set,this.h=this.l=null,this.V=!1,this.K=0,this.a=null,this.i=new Oe,this.b=new Map,this.v=[],this.o=new pe,this.f=null,this.g=function(t){n.o.reject(t),e.onError(t)},this.sa=new Map,this.$=new Map,this.T=new le((function(){return function(e){var t=e.sa,n=e.$;n.clear(),t.forEach((function(e,t){return n.set(t,e)})),(t=Array.from(n.values())).length&&t.every((function(e){return"expired"==e}))&&e.g(new he(2,6,6014)),e.F.yc(ze(n))}(n)})),this.c=!1,this.qa=new pe,this.G=!1,this.H=[],this.ra=!1,this.ea=new le((function(){!function(e){e.b.forEach((function(t,n){var i=t.rd,r=n.expiration;isNaN(r)&&(r=1/0),r!=i&&(e.F.onExpirationUpdated(n.sessionId,r),t.rd=r)}))}(n)})).Ka(t),this.o.catch((function(){}))}function ht(e,t,n){return e.v=n,e.G=0<n.length,pt(e,t)}function pt(t,n){var i=function(t){if(0==(t=qe(t.f.clearKeys)).size)return null;var n=[],i=[];t.forEach((function(e,t){var r=ft.Yc(t),a=ft.Yc(e);r={kty:"oct",kid:ft.Hc(r,!1),k:ft.Hc(a,!1)},n.push(r),i.push(r.kid)})),t=JSON.stringify({keys:n});var r=JSON.stringify({kids:i});return r=[{initData:new Uint8Array(st(r)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:r,keyIds:[]}}(t);if(i)for(var r=d(n),a=r.next();!a.done;a=r.next())a.value.drmInfos=[i];for((i=n.some((function(e){return 0<e.drmInfos.length})))||function(e,t){var n=[];t.forEach((function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})}));for(var i=d(e),r=i.next();!r.done;r=i.next())r.value.drmInfos=n}(n,a=qe(t.f.servers)),a=(r=d(n)).next();!a.done;a=r.next())for(var o=(a=d(a.value.drmInfos)).next();!o.done;o=a.next())Pt(o.value,qe(t.f.servers),qe(t.f.advanced||{}));return(a=function(e,t){for(var n=new Set,i=d(t),r=i.next();!r.done;r=i.next()){var a=d(r.value.drmInfos);for(r=a.next();!r.done;r=a.next())n.add(r.value)}for(i=d(n),r=i.next();!r.done;r=i.next())Pt(r.value,qe(e.f.servers),qe(e.f.advanced||{}));a=e.G?"required":"optional";var o=e.G?["persistent-license"]:["temporary"];for(i=new Map,n=d(n),r=n.next();!r.done;r=n.next())r=r.value,i.set(r.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:a,sessionTypes:o,label:r.keySystem,drmInfos:[]});for(n=d(t),r=n.next();!r.done;r=n.next()){r=r.value,a=r.audio,o=r.video;var s=a?Ge(a.mimeType,a.codecs):"",u=o?Ge(o.mimeType,o.codecs):"",c=d(r.drmInfos);for(r=c.next();!r.done;r=c.next()){r=r.value;var l=i.get(r.keySystem);l.drmInfos.push(r),r.distinctiveIdentifierRequired&&(l.distinctiveIdentifier="required"),r.persistentStateRequired&&(l.persistentState="required"),a&&l.audioCapabilities.push({robustness:r.audioRobustness||"",contentType:s}),o&&l.videoCapabilities.push({robustness:r.videoRobustness||"",contentType:u})}}return i}(t,n)).size?(a=wt(t,a),i?a:a.catch((function(){}))):(t.V=!0,Promise.resolve())}function mt(e){return p((function t(){var n;return _(t,(function(t){switch(t.j){case 1:if(!(e.l&&e.a&&e.a.serverCertificate&&e.a.serverCertificate.length)){t.C(0);break}return A(t,3),x(t,e.l.setServerCertificate(e.a.serverCertificate),5);case 5:t.s||X.m("Server certificates are not supported by the key system.  The server certificate has been ignored."),I(t,0);break;case 3:return n=P(t),t.return(Promise.reject(new he(2,6,6004,n.message)))}}))}))}function gt(e){var t=e.a?e.a.initData:[];return t.forEach((function(t){return vt(e,t.initDataType,t.initData)})),e.v.forEach((function(t){return Tt(e,t)})),t.length||e.v.length||e.o.resolve(),e.o}function vt(e,t,n){for(var i=e.b.values(),r=(i=d(i)).next();!r.done;r=i.next())if(ft.Da(n,r.value.initData)&&!et("Tizen 2"))return void X.debug("Ignoring duplicate init data.");!function(e,t,n){try{if(e.G){X.D("Creating new persistent session");var i=e.l.createSession("persistent-license")}else X.D("Creating new temporary session"),i=e.l.createSession()}catch(t){return void e.g(new he(2,6,6005,t.message))}e.i.B(i,"message",e.se.bind(e)),e.i.B(i,"keystatuseschange",e.qe.bind(e)),e.b.set(i,{initData:n,loaded:!1,rd:1/0,Ca:null});try{n=e.f.initDataTransform(n,e.a)}catch(n){return t=n,n instanceof he||(t=new he(2,6,6016,n)),void e.g(t)}i.generateRequest(t,n).catch((function(t){if(!e.c){if(e.b.delete(i),t.errorCode&&t.errorCode.systemCode){var n=t.errorCode.systemCode;0>n&&(n+=Math.pow(2,32)),n="0x"+n.toString(16)}e.g(new he(2,6,6006,t.message,t,n))}}))}(e,t,n)}function yt(e){return e?e.keySystem:""}function bt(e){return e=He(e=e.b.keys(),(function(e){return e.sessionId})),Array.from(e)}function wt(e,t){if(1==t.size&&t.has(""))return Promise.reject(new he(2,6,6e3));for(var n=d(t.values()),i=n.next();!i.done;i=n.next())0==(i=i.value).audioCapabilities.length&&delete i.audioCapabilities,0==i.videoCapabilities.length&&delete i.videoCapabilities;var r=n=new pe;return[!0,!1].forEach(function(e){var n=this;t.forEach((function(t,i){t.drmInfos.some((function(e){return!!e.licenseServerUri}))==e&&(r=r.catch(function(){if(!this.c)return navigator.requestMediaKeySystemAccess(i,[t])}.bind(n)))}))}.bind(e)),r=(r=r.catch((function(){return Promise.reject(new he(2,6,6001))}))).then(function(e){if(this.c)return Promise.reject();this.u.clear();var n=e.getConfiguration(),i=n.videoCapabilities||[],r=d(n.audioCapabilities||[]);for(n=r.next();!n.done;n=r.next())this.u.add(n.value.contentType.toLowerCase());for(n=(i=d(i)).next();!n.done;n=i.next())this.u.add(n.value.contentType.toLowerCase());i=e.keySystem,r=[];var a=[],o=[],s=[];return function(e,t,n,i,r){e.forEach((function(e){if(t.includes(e.licenseServerUri)||t.push(e.licenseServerUri),e.serverCertificate&&(n.some((function(t){return ft.Da(t,e.serverCertificate)}))||n.push(e.serverCertificate)),e.initData&&e.initData.forEach((function(e){i.some((function(t){return!(!t.keyId||t.keyId!=e.keyId)||t.initDataType==e.initDataType&&ft.Da(t.initData,e.initData)}))||i.push(e)})),e.keyIds)for(var a=0;a<e.keyIds.length;++a)r.includes(e.keyIds[a])||r.push(e.keyIds[a])}))}((n=t.get(e.keySystem)).drmInfos,r,a,o,s),1<a.length&&X.m("Multiple unique server certificates found! Only the first will be used."),1<r.length&&X.m("Multiple unique license server URIs found! Only the first will be used."),this.a={keySystem:i,licenseServerUri:r[0],distinctiveIdentifierRequired:"required"==n.distinctiveIdentifier,persistentStateRequired:"required"==n.persistentState,audioRobustness:(n.audioCapabilities?n.audioCapabilities[0].robustness:"")||"",videoRobustness:(n.videoCapabilities?n.videoCapabilities[0].robustness:"")||"",serverCertificate:a[0],initData:o,keyIds:s},this.a.licenseServerUri?e.createMediaKeys():Promise.reject(new he(2,6,6012,this.a.keySystem))}.bind(e)).then(function(e){if(this.c)return Promise.reject();X.info("Created MediaKeys object for key system",this.a.keySystem),this.l=e,this.V=!0}.bind(e)).catch(function(e){if(!this.c)return this.a=null,this.u.clear(),e instanceof he?Promise.reject(e):Promise.reject(new he(2,6,6002,e.message))}.bind(e)),n.reject(),r}function Tt(e,t){try{X.D("Attempting to load an offline session",t);var n=e.l.createSession("persistent-license")}catch(t){var i=new he(2,6,6005,t.message);return e.g(i),Promise.reject(i)}e.i.B(n,"message",e.se.bind(e)),e.i.B(n,"keystatuseschange",e.qe.bind(e));var r={initData:null,loaded:!1,rd:1/0,Ca:null};return e.b.set(n,r),n.load(t).then(function(e){return this.c?Promise.reject():(X.J("Loaded offline session",t,e),e?(r.loaded=!0,It(this)&&this.o.resolve(),n):(this.b.delete(n),void this.g(new he(2,6,6013))))}.bind(e),function(e){this.c||(this.b.delete(n),this.g(new he(2,6,6005,e.message)))}.bind(e))}function St(e,t){if(yt(t).startsWith("com.apple.fps")){var n=t.serverCertificate;e=Fe(e,Be(e),n)}return e}function Et(e,t){var n=t.target;X.D("Sending license request for session",n.sessionId,"of type",t.messageType);var i=e.b.get(n),r=e.a.licenseServerUri,a=e.f.advanced[e.a.keySystem];"individualization-request"==t.messageType&&a&&a.individualizationServer&&(r=a.individualizationServer),(r=De([r],e.f.retryParameters)).body=t.message,r.method="POST",r.licenseRequestType=t.messageType,r.sessionId=n.sessionId,"com.microsoft.playready"!=e.a.keySystem&&"com.chromecast.playready"!=e.a.keySystem||function(e){var t=at(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){X.debug("Unwrapping PlayReady request.");for(var n=(t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader"),i=0;i<n.length;++i)e.headers[n[i].getElementsByTagName("name")[0].textContent]=n[i].getElementsByTagName("value")[0].textContent;e.body=ft.Fa(t.getElementsByTagName("Challenge")[0].textContent).buffer}else X.debug("PlayReady request is already unwrapped."),e.headers["Content-Type"]="text/xml; charset=utf-8"}(r),e.a.keySystem.startsWith("com.apple.fps")&&e.f.fairPlayTransform&&function(e){var t=new Uint8Array(e.body);t="spc="+ft.Hc(t),e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=st(t)}(r);var o=Date.now();e.F.Db.request(2,r).promise.then(function(e){return this.c?Promise.reject():(this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&function(e){try{var t=rt(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=ft.Fa(t).buffer}(e),this.K+=(Date.now()-o)/1e3,X.D("Updating session",n.sessionId),n.update(e.data).then(function(){var e=this;this.F.onEvent(new Te("drmsessionupdate")),i&&(i.Ca&&i.Ca.resolve(),new le((function(){i.loaded=!0,It(e)&&e.o.resolve()})).R(Rt))}.bind(this)))}.bind(e),function(e){this.c||(e=new he(2,6,6007,e),this.g(e),i&&i.Ca&&i.Ca.reject(e))}.bind(e)).catch(function(e){this.c||(e=new he(2,6,6008,e.message),this.g(e),i&&i.Ca&&i.Ca.reject(e))}.bind(e))}function xt(){var e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],t=[{videoCapabilities:e,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:e}],n=new Map;return e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map((function(e){return function(e){return p((function i(){var r,a,o;return _(i,(function(i){switch(i.j){case 1:return A(i,2),x(i,navigator.requestMediaKeySystemAccess(e,t),4);case 4:return r=i.s,o=!!(a=r.getConfiguration().sessionTypes)&&a.includes("persistent-license"),et("Tizen 3")&&(o=!1),n.set(e,{persistentState:o}),x(i,r.createMediaKeys(),5);case 5:I(i,0);break;case 2:P(i),n.set(e,null),k(i)}}))}))}(e)})),Promise.all(e).then((function(){return ze(n)}))}function kt(e,t){var n=t.audio,i=t.video;if(n&&n.encrypted&&!Je()&&!e.u.has(Ge(n.mimeType,n.codecs).toLowerCase())||i&&i.encrypted&&!Je()&&!e.u.has(Ge(i.mimeType,i.codecs).toLowerCase()))return!1;var r=yt(e.a);return 0==t.drmInfos.length||t.drmInfos.some((function(e){return e.keySystem==r}))}function At(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],i=0;i<e.length;i++)for(var r=0;r<t.length;r++)if(e[i].keySystem==t[r].keySystem){var a=e[i];r=t[r];var o=[];o=(o=o.concat(a.initData||[])).concat(r.initData||[]);var s=[];s=(s=s.concat(a.keyIds)).concat(r.keyIds),n.push({keySystem:a.keySystem,licenseServerUri:a.licenseServerUri||r.licenseServerUri,distinctiveIdentifierRequired:a.distinctiveIdentifierRequired||r.distinctiveIdentifierRequired,persistentStateRequired:a.persistentStateRequired||r.persistentStateRequired,videoRobustness:a.videoRobustness||r.videoRobustness,audioRobustness:a.audioRobustness||r.audioRobustness,serverCertificate:a.serverCertificate||r.serverCertificate,initData:o,keyIds:s});break}return n}function Mt(e){return p((function t(){var n;return _(t,(function(t){switch(t.j){case 1:return n=Array.from(e.b.keys()),e.b.clear(),x(t,Promise.all(n.map((function(e){return p((function t(){return _(t,(function(t){switch(t.j){case 1:return X.D("Closing session",e.sessionId),A(t,2),x(t,function(e){return p((function t(){var n;return _(t,(function(t){switch(t.j){case 1:return n=new Promise((function(e,t){new le(t).R(Ct)})),A(t,2),x(t,Promise.race([Promise.all([e.close(),e.closed]),n]),4);case 4:I(t,0);break;case 2:P(t),X.m("Timeout waiting for session close"),k(t)}}))}))}(e),4);case 4:I(t,0);break;case 2:P(t),k(t)}}))}))}))),0)}}))}))}function It(e){return Ve(e=e.b.values(),(function(e){return e.loaded}))}function Pt(t,n,i){!t.keySystem||"org.w3.clearkey"==t.keySystem&&t.licenseServerUri||(n.size&&(n=n.get(t.keySystem)||"",t.licenseServerUri=n),t.keyIds||(t.keyIds=[]),(i=i.get(t.keySystem))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=i.persistentStateRequired),t.videoRobustness||(t.videoRobustness=i.videoRobustness),t.audioRobustness||(t.audioRobustness=i.audioRobustness),t.serverCertificate||(t.serverCertificate=i.serverCertificate)),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==t.keySystem&&(t.keySystem="com.chromecast.playready"))}H("shaka.util.Uint8ArrayUtils.toBase64",ft.Hc),ft.Fa=function(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n},H("shaka.util.Uint8ArrayUtils.fromBase64",ft.Fa),ft.Yc=function(t){for(var n=new Uint8Array(t.length/2),i=0;i<t.length;i+=2)n[i/2]=e.parseInt(t.substr(i,2),16);return n},H("shaka.util.Uint8ArrayUtils.fromHex",ft.Yc),ft.Ic=function(e){for(var t="",n=0;n<e.length;++n){var i=e[n].toString(16);1==i.length&&(i="0"+i),t+=i}return t},H("shaka.util.Uint8ArrayUtils.toHex",ft.Ic),ft.Da=function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!1;return!0},H("shaka.util.Uint8ArrayUtils.equal",ft.Da),ft.concat=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];for(var i=n=0;i<t.length;++i)n+=t[i].length;n=new Uint8Array(n);for(var r=i=0;r<t.length;++r)n.set(t[r],i),i+=t[r].length;return n},H("shaka.util.Uint8ArrayUtils.concat",ft.concat),(i=dt.prototype).destroy=function(){var e=this;return p((function t(){return _(t,(function(t){switch(t.j){case 1:return e.c?x(t,e.qa,0):(e.c=!0,x(t,function(e){return p((function t(){return _(t,(function(t){switch(t.j){case 1:return e.i.release(),e.i=null,e.o.reject(),e.ea.stop(),e.ea=null,e.T.stop(),e.T=null,x(t,Mt(e),2);case 2:if(!e.h){t.C(3);break}return A(t,4),x(t,e.h.setMediaKeys(null),6);case 6:I(t,5);break;case 4:P(t);case 5:e.h=null;case 3:e.a=null,e.u.clear(),e.l=null,e.v=[],e.f=null,e.g=null,e.F=null,k(t)}}))}))}(e),4));case 4:e.qa.resolve(),t.C(0)}}))}))},i.configure=function(e){this.f=e},i.Qb=function(e){var t=this;if(!this.l)return this.i.ua(e,"encrypted",(function(){t.g(new he(2,6,6010))})),Promise.resolve();this.h=e,this.i.ua(this.h,"play",(function(){for(var e=0;e<t.H.length;e++)Et(t,t.H[e]);t.ra=!0,t.H=[]})),"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.B(this.h,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return Mt(t)})),e=(e=this.h.setMediaKeys(this.l)).catch((function(e){return Promise.reject(new he(2,6,6003,e.message))}));var n=mt(this);return Promise.all([e,n]).then((function(){if(t.c)return Promise.reject();gt(t),t.a.initData.length||t.v.length||t.i.B(t.h,"encrypted",(function(e){return vt(t,e.initDataType,new Uint8Array(e.initData))}))})).catch((function(e){if(!t.c)return Promise.reject(e)}))},i.Tb=function(){for(var e=1/0,t=this.b.keys(),n=(t=d(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},i.se=function(e){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.ra?this.H.push(e):Et(this,e)},i.qe=function(e){e=e.target,X.J("Key status changed for session",e.sessionId);var t=this.b.get(e),n=!1;e.keyStatuses.forEach(function(e,i){if("string"==typeof i){var r=i;i=e,e=r}if("com.microsoft.playready"==this.a.keySystem&&16==i.byteLength&&(et("Trident/")||Je())){var a=(r=new DataView(i)).getUint32(0,!0),o=r.getUint16(4,!0),s=r.getUint16(6,!0);r.setUint32(0,a,!1),r.setUint16(4,o,!1),r.setUint16(6,s,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(t.loaded=!0),"expired"==e&&(n=!0),r=ft.Ic(new Uint8Array(i)),this.sa.set(r,e)}.bind(this));var i=e.expiration-Date.now();(0>i||n&&1e3>i)&&t&&!t.Ca&&(X.debug("Session has expired",e.sessionId),this.b.delete(e),e.close().catch((function(){}))),It(this)&&(this.o.resolve(),this.T.R(Nt))};var Ct=1,Rt=5,Nt=.5;function Dt(){this.a=new muxjs.mp4.CaptionParser,this.g=[],this.f={}}function Lt(){}function Ut(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function _t(e,t,n){return n=void 0===n?0:n,!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t+n>=e.start(0)}function Ot(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var n=0,i=e.length-1;0<=i&&e.end(i)>t;--i)n+=e.end(i)-Math.max(e.start(i),t);return n}function jt(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}Dt.prototype.init=function(e){var t=muxjs.mp4.probe;e=new Uint8Array(e),this.g=t.videoTrackIds(e),this.f=t.timescale(e),this.a.init()},Dt.prototype.b=function(e,t){var n=new Uint8Array(e);(n=this.a.parse(n,this.g,this.f))&&n.captions&&t(n.captions),this.a.clearParsedCaptions()},Dt.prototype.c=function(){this.a.resetCaptionStream()},Lt.prototype.init=function(){},Lt.prototype.b=function(){},Lt.prototype.c=function(){};var Kt={Ye:function(e,t){return e.reduce(function(e,t,n){return t.catch(e.bind(null,n))}.bind(null,t),Promise.reject())},Oc:function(e,t){return e.concat(t)},wc:function(){},Na:function(e){return null!=e}};function Bt(e,t){if(0==t.length)return e;var n=t.map((function(e){return new $(e)}));return e.map((function(e){return new $(e)})).map((function(e){return n.map(e.resolve.bind(e))})).reduce(Kt.Oc,[]).map((function(e){return e.toString()}))}function Ft(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}var Ht={Ua:"video",Nb:"audio",va:"text",Mg:"image",Kg:"application"};function Vt(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.i.bind(this)),this.a.on("done",this.h.bind(this))}function qt(t,n){return!(!e.muxjs||"mp2t"!=t.toLowerCase().split(";")[0].split("/")[1])&&(n?MediaSource.isTypeSupported(zt(n,t)):MediaSource.isTypeSupported(zt("audio",t))||MediaSource.isTypeSupported(zt("video",t)))}function zt(e,t){var n=t.replace(/mp2t/i,"mp4");"audio"==e&&(n=n.replace("video","audio"));var i=/avc1\.(66|77|100)\.(\d+)/.exec(n);if(i){var r="avc1.",a=i[1],o=Number(i[2]);r=("66"==a?r+"4200":"77"==a?r+"4d00":r+"6400")+(o>>4).toString(16),r+=(15&o).toString(16),n=n.replace(i[0],r)}return n}function Gt(e,t,n){this.startTime=e,this.direction=Qt,this.endTime=t,this.payload=n,this.region=new sn,this.position=null,this.positionAlign=Wt,this.size=0,this.textAlign=Xt,this.writingMode=Zt,this.lineInterpretation=en,this.line=null,this.lineHeight="",this.lineAlign=tn,this.displayAlign=$t,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=rn,this.fontStyle=an,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1}Vt.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},Vt.prototype.i=function(e){this.c=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.g.push(t)},Vt.prototype.h=function(){var e={data:ft.concat.apply(null,this.g),captions:this.c};this.b.resolve(e),this.f=!1},H("shaka.text.Cue",Gt),Gt.prototype.clone=function(){var e,t=new Gt(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t};var Wt="auto";Gt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Wt};var Xt="center",Yt={LEFT:"left",RIGHT:"right",CENTER:Xt,START:"start",END:"end"};Gt.textAlign=Yt;var $t="after",Jt={BEFORE:"before",CENTER:"center",AFTER:$t};Gt.displayAlign=Jt;var Qt="ltr";Gt.direction={HORIZONTAL_LEFT_TO_RIGHT:Qt,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Zt="horizontal-tb";Gt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Zt,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var en=0;Gt.lineInterpretation={LINE_NUMBER:en,PERCENTAGE:1};var tn="start",nn={CENTER:"center",START:tn,END:"end"};Gt.lineAlign=nn;var rn=400;Gt.fontWeight={NORMAL:rn,BOLD:700};var an="normal",on={NORMAL:an,ITALIC:"italic",OBLIQUE:"oblique"};function sn(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=un,this.scroll=cn}Gt.fontStyle=on,Gt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},H("shaka.text.CueRegion",sn);var un=1;sn.units={PX:0,PERCENTAGE:un,LINES:2};var cn="";function ln(e){this.g=null,this.c=e,this.f=this.o=0,this.h=1/0,this.b=this.a=null,this.l="",this.i=new Map}sn.scrollMode={NONE:cn,UP:"up"};var fn={};function dn(t){return!!(fn[t]||e.muxjs&&"application/cea-608"==t)}function hn(e,t){"application/cea-608"!=t&&(e.g=new fn[t])}function pn(e,t,n,i,r){for(var a=n+" "+i,o=new Map,s=(t=d(t)).next();!s.done;s=t.next()){var u=s.value;s=u.stream,o.has(s)||o.set(s,new Map),o.get(s).has(a)||o.get(s).set(a,[]),u.startTime+=r,u.endTime+=r,u.startTime>=e.f&&u.startTime<e.h&&(u=new Gt(u.startTime,u.endTime,u.text),o.get(s).get(a).push(u),s==e.l&&e.c.append([u]))}for(a=(r=d(o.keys())).next();!a.done;a=r.next())for(a=a.value,e.i.has(a)||e.i.set(a,new Map),s=(t=d(o.get(a).keys())).next();!s.done;s=t.next())s=s.value,u=o.get(a).get(s),e.i.get(a).set(s,u);e.a=null==e.a?Math.max(n,e.f):Math.min(e.a,Math.max(n,e.f)),e.b=Math.max(e.b,Math.min(i,e.h))}function mn(e,t,n){this.f=e,this.g=n,this.b={},this.a=null,this.c={},this.i=new Oe,this.v=!1,this.l={},this.o=t,e=this.u=new pe,t=new MediaSource,this.i.ua(t,"sourceopen",e.resolve),this.f.src=gn(t),this.h=t}H("shaka.text.TextEngine.registerParser",(function(e,t){fn[e]=t})),H("shaka.text.TextEngine.unregisterParser",(function(e){delete fn[e]})),ln.prototype.destroy=function(){return this.c=this.g=null,this.i.clear(),Promise.resolve()},ln.prototype.sc=function(e){try{return this.g.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new he(2,2,2009,e)}},ln.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.c||!this.c.remove(e,t)||null==this.a||t<=this.a||e>=this.b||(e<=this.a&&t>=this.b?this.a=this.b=null:e<=this.a&&t<this.b?this.a=t:e>this.a&&t>=this.b&&(this.b=e))}.bind(this))};var gn=e.URL.createObjectURL;function vn(e){var t=Ge(e.mimeType,e.codecs),n=function(e){var t=[e.mimeType];return Xe.forEach((function(n,i){var r=e[i];r&&t.push(n+'="'+r+'"')})),t.join(";")}(e);return dn(t)||MediaSource.isTypeSupported(n)||qt(t,e.type)}function yn(e,t){e.a||(e.a=new ln(e.g)),hn(e.a,t)}function bn(e){return!e.h||"ended"==e.h.readyState}function wn(e,t){if("text"==t)var n=e.a.a;else n=!(n=Sn(e,t))||1==n.length&&1e-6>n.end(0)-n.start(0)?null:1==n.length&&0>n.start(0)?0:n.length?n.start(0):null;return n}function Tn(e,t){return"text"==t?e.a.b:Ut(Sn(e,t))}function Sn(e,t){try{return e.b[t].buffered}catch(n){return t in e.b&&X.error("failed to get buffered range for "+t,n),null}}function En(t,n,i,r,a,o){return"text"==n?function(e,t,n,i){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==n||null==i)this.g.parseInit(new Uint8Array(t));else{var e={periodStart:this.o,segmentStart:n,segmentEnd:i};e=this.g.parseMedia(new Uint8Array(t),e).filter(function(e){return e.startTime>=this.f&&e.startTime<this.h}.bind(this)),this.c.append(e),null==this.a&&(this.a=Math.max(n,this.f)),this.b=Math.min(i,this.h)}}.bind(e))}(t.a,i,r,a):t.l[n]?function(e,t){e.f=!0,e.b=new pe,e.g=[],e.c=[];var n=new Uint8Array(t);return e.a.push(n),e.a.flush(),e.f&&e.b.reject(new he(2,3,3018)),e.b}(t.l[n],i).then(function(e){return this.a||yn(this,"text/vtt"),e.captions&&e.captions.length&&pn(this.a,e.captions,r,a,this.b.video.timestampOffset),An(this,n,this.Fe.bind(this,n,e.data.buffer))}.bind(t)):(o&&e.muxjs&&(t.a||yn(t,"text/vtt"),null==r&&null==a?t.o.init(i):t.o.b(i,(function(e){e.length&&pn(t.a,e,r,a,t.b.video.timestampOffset)}))),An(t,n,t.Fe.bind(t,n,i)))}function xn(e,t){var n=Tn(e,"video")||0;!function(e,t,n){if(e.l=t,t=e.i.get(t))for(var i=d(t.keys()),r=i.next();!r.done;r=i.next())(r=t.get(r.value).filter((function(e){return e.endTime<=n})))&&e.c.append(r)}(e.a,t,n)}function kn(e,t){return"text"==t?e.a?(e.o.c(),e.a.remove(0,1/0)):Promise.resolve():An(e,t,e.Ge.bind(e,t,0,e.h.duration))}function An(e,t,n){if(e.v)return Promise.reject();if(n={start:n,p:new pe},e.c[t].push(n),1==e.c[t].length)try{n.start()}catch(i){"QuotaExceededError"==i.name?n.p.reject(new he(2,3,3017,t)):n.p.reject(new he(2,3,3015,i)),In(e,t)}return n.p}function Mn(e,t){if(e.v)return Promise.reject();var n,i=[];for(n in e.b){var r=new pe,a={start:function(e){e.resolve()}.bind(null,r),p:r};e.c[n].push(a),i.push(r),1==e.c[n].length&&a.start()}return Promise.all(i).then(function(){try{t()}catch(t){var e=Promise.reject(new he(2,3,3015,t))}for(var n in this.b)In(this,n);return e}.bind(e),function(e){throw e}.bind(e))}function In(e,t){e.c[t].shift();var n=e.c[t][0];if(n)try{n.start()}catch(i){n.p.reject(new he(2,3,3015,i)),In(e,t)}}function Pn(e,t){return e=Rn(e),t=Rn(t),e.split("-")[0]==t.split("-")[0]}function Cn(e,t){e=Rn(e),t=Rn(t);var n=e.split("-"),i=t.split("-");return n[0]==i[0]&&1==n.length&&2==i.length}function Rn(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=Ln.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function Nn(e){return e.language?Rn(e.language):e.audio&&e.audio.language?Rn(e.audio.language):e.video&&e.video.language?Rn(e.video.language):"und"}function Dn(e,t){for(var n=Rn(e),i=new Set,r=d(t),a=r.next();!a.done;a=r.next())i.add(Rn(a.value));for(a=(r=d(i)).next();!a.done;a=r.next())if((a=a.value)==n)return a;for(a=(r=d(i)).next();!a.done;a=r.next())if(Cn(a=a.value,n))return a;for(a=(r=d(i)).next();!a.done;a=r.next()){var o=a=a.value,s=n;if(o=Rn(o),s=Rn(s),o=o.split("-"),s=s.split("-"),2==o.length&&2==s.length&&o[0]==s[0])return a}for(a=(i=d(i)).next();!a.done;a=i.next())if(Cn(n,r=a.value))return r;return null}(i=mn.prototype).destroy=function(){var e=this;this.v=!0;var t,n=[];for(t in this.c){var i=this.c[t],r=i[0];for(this.c[t]=i.slice(0,1),r&&n.push(r.p.catch(Kt.wc)),r=1;r<i.length;++r)i[r].p.reject()}for(var a in this.a&&n.push(this.a.destroy()),this.g&&n.push(this.g.destroy()),this.l)n.push(this.l[a].destroy());return Promise.all(n).then((function(){e.i&&(e.i.release(),e.i=null),e.f&&(e.f.removeAttribute("src"),e.f.load(),e.f=null),e.h=null,e.a=null,e.g=null,e.b={},e.l={},e.o=null,e.c={}}))},i.init=function(e,t){var n=this;return p((function i(){var r;return _(i,(function(i){switch(i.j){case 1:return r=Ht,x(i,n.u,2);case 2:e.forEach((function(e,i){var a=Ge(e.mimeType,e.codecs);i==r.va?yn(n,a):(!t&&MediaSource.isTypeSupported(a)||!qt(a,i)||(n.l[i]=new Vt,a=zt(i,a)),a=n.h.addSourceBuffer(a),n.i.B(a,"error",n.vg.bind(n,i)),n.i.B(a,"updateend",n.Gb.bind(n,i)),n.b[i]=a,n.c[i]=[])})),k(i)}}))}))},i.$c=function(e){if(e.total=jt(this.f.buffered),e.audio=jt(Sn(this,"audio")),e.video=jt(Sn(this,"video")),e.text=[],this.a){var t=this.a.a,n=this.a.b;null!=t&&null!=n&&e.text.push({start:t,end:n})}},i.remove=function(e,t,n){return"text"==e?this.a.remove(t,n):An(this,e,this.Ge.bind(this,e,t,n))},i.flush=function(e){return"text"==e?Promise.resolve():An(this,e,this.cf.bind(this,e))},i.endOfStream=function(e){return Mn(this,function(){bn(this)||(e?this.h.endOfStream(e):this.h.endOfStream())}.bind(this))},i.Ba=function(e){return Mn(this,function(){this.h.duration=e}.bind(this))},i.ca=function(){return this.h.duration},i.Fe=function(e,t){this.b[e].appendBuffer(t)},i.Ge=function(e,t,n){n<=t?this.Gb(e):this.b[e].remove(t,n)},i.Pe=function(e){var t=this.b[e].appendWindowStart,n=this.b[e].appendWindowEnd;this.b[e].abort(),this.b[e].appendWindowStart=t,this.b[e].appendWindowEnd=n,this.Gb(e)},i.cf=function(e){this.f.currentTime-=.001,this.Gb(e)},i.ug=function(e,t){0>t&&(t+=.001),this.b[e].timestampOffset=t,this.Gb(e)},i.rg=function(e,t,n){this.b[e].appendWindowStart=0,this.b[e].appendWindowEnd=n,this.b[e].appendWindowStart=t,this.Gb(e)},i.vg=function(e){this.c[e][0].p.reject(new he(2,3,3014,this.f.error?this.f.error.code:0))},i.Gb=function(e){var t=this.c[e][0];t&&(t.p.resolve(),In(this,e))};var Ln=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),Un={Vd:function(e,t){function n(e){var t="";e.video&&(t=We(e.video.codecs)[0]);var n="";return e.audio&&(n=We(e.audio.codecs)[0]),t+"-"+n}var i=e.periods.reduce((function(e,t){return e.concat(t.variants)}),[]);i=Un.$d(i,t);for(var r=new Se,a=(i=d(i)).next();!a.done;a=i.next()){var o=n(a=a.value);r.push(o,a)}var s=null,u=1/0;for(r.forEach((function(e,t){for(var n=0,i=0,r=d(t),a=r.next();!a.done;a=r.next())n+=a.value.bandwidth||0,++i;n/=i,X.debug("codecs",e,"avg bandwidth",n),n<u&&(s=e,u=n)})),i=(r=d(e.periods)).next();!i.done;i=r.next())(i=i.value).variants=i.variants.filter((function(e){return n(e)==s||(X.debug("Dropping Variant (better codec available)",e),!1)}))},ld:function(e,t,n){function i(e,t,n){return e>=t&&e<=n}var r=e.video;return!(r&&r.width&&r.height&&(!i(r.width,t.minWidth,Math.min(t.maxWidth,n.width))||!i(r.height,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))},Sd:function(e,t,n){var i=!1;return e.forEach((function(e){var r=e.allowedByApplication;e.allowedByApplication=Un.ld(e,t,n),r!=e.allowedByApplication&&(i=!0)})),i},filterNewPeriod:function(e,t,n,i){i.variants=i.variants.filter((function(i){if(e&&e.V&&!kt(e,i))return X.debug("Dropping variant - not compatible with key system",i),!1;var r=i.audio;return i=i.video,r&&!vn(r)?(X.debug("Dropping variant - audio not compatible with platform",Un.yb(r)),!1):i&&!vn(i)?(X.debug("Dropping variant - video not compatible with platform",Un.yb(i)),!1):r&&t&&!Un.Td(r,t)?(X.debug("Droping variant - not compatible with active audio","active audio",Un.yb(t),"variant.audio",Un.yb(r)),!1):!(i&&n&&!Un.Td(i,n))||(X.debug("Droping variant - not compatible with active video","active video",Un.yb(n),"variant.video",Un.yb(i)),!1)})),i.textStreams=i.textStreams.filter((function(e){var t=dn(Ge(e.mimeType,e.codecs));return t||X.debug("Dropping text stream. Is not supported by the platform.",e),t}))},Td:function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]},Qd:function(e){var t=e.audio,n=e.video,i=t?t.codecs:null,r=n?n.codecs:null,a=[];r&&a.push(r),i&&a.push(i);var o=[];n&&o.push(n.mimeType),t&&o.push(t.mimeType),o=o[0]||null;var s=[];t&&s.push(t.kind),n&&s.push(n.kind),s=s[0]||null;var u=new Set;return t&&t.roles.forEach((function(e){return u.add(e)})),n&&n.roles.forEach((function(e){return u.add(e)})),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:s,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:o,codecs:a.join(", "),audioCodec:i,videoCodec:r,primary:e.primary,roles:Array.from(u),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e},Fc:function(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}},ed:function(e){return e.__shaka_id||(e.__shaka_id=Un.Lf++),e.__shaka_id},Lf:0,Ff:function(e){var t=Un.ee(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),e.kind&&(t.roles=[e.kind]),t},de:function(e){var t=Un.ee(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind]),t},ee:function(e){return{id:Un.ed(e),active:!1,type:"",bandwidth:0,language:Rn(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},Bb:function(e){return e.allowedByApplication&&e.allowedByKeySystem},tf:function(e){return e.filter((function(e){return Un.Bb(e)}))},$d:function(e,t){for(var n=e.filter((function(e){return e.audio&&e.audio.channelsCount})),i=new Map,r=(n=d(n)).next();!r.done;r=n.next()){var a=(r=r.value).audio.channelsCount;i.has(a)||i.set(a,[]),i.get(a).push(r)}return 0==(n=Array.from(i.keys())).length?e:(r=n.filter((function(e){return e<=t}))).length?i.get(Math.max.apply(null,r)):i.get(Math.min.apply(null,n))},Sb:function(e,t,n){var i=e,r=e.filter((function(e){return e.primary}));r.length&&(i=r);var a=i.length?i[0].language:"";if(i=i.filter((function(e){return e.language==a})),t){var o=Dn(Rn(t),e.map((function(e){return e.language})));o&&(i=e.filter((function(e){return Rn(e.language)==o})))}if(n){if((e=Un.Zd(i,n)).length)return e;X.m("No exact match for the text role could be found.")}else if((e=i.filter((function(e){return 0==e.roles.length}))).length)return e;return(e=i.map((function(e){return e.roles})).reduce(Kt.Oc,[])).length?Un.Zd(i,e[0]):i},Zd:function(e,t){return e.filter((function(e){return e.roles.includes(t)}))},ce:function(e,t,n){for(var i=0;i<n.length;i++)if(n[i].audio==e&&n[i].video==t)return n[i];return null},Gf:function(e){return"audio"==e.type},Jf:function(e){return"video"==e.type},Cf:function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t},yb:function(e){return Un.Gf(e)?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:Un.Jf(e)?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}};function _n(){this.h=null,this.c=!1,this.b=new W,this.g=[],this.i=!1,this.a=this.f=null}function On(e,t){return e&&(t=t.filter((function(t){return Un.ld(t,e,{width:1/0,height:1/0})}))),t.sort((function(e,t){return e.bandwidth-t.bandwidth}))}function jn(e,t){this.a=e,this.b=t}function Kn(e,t){var n=new jn(2,6),i=Hn,r=i.a,a=n.b-r.b;(0<(n.a-r.a||a)?i.c:i.b)(i.a,n,e,t)}function Bn(e,t,n,i){X.Z([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function Fn(e,t,n,i){X.jc([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(""))}H("shaka.abr.SimpleAbrManager",_n),_n.prototype.stop=function(){this.h=null,this.c=!1,this.g=[],this.f=null},_n.prototype.stop=_n.prototype.stop,_n.prototype.init=function(e){this.h=e},_n.prototype.init=_n.prototype.init,_n.prototype.chooseVariant=function(){var e=On(this.a.restrictions,this.g),t=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!e.length&&(X.m("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),e=[(e=On(null,this.g))[0]]);for(var n=e[0]||null,i=0;i<e.length;++i){var r=e[i],a=r.bandwidth/this.a.bandwidthDowngradeTarget,o=(e[i+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;X.J("Bandwidth ranges:",(r.bandwidth/1e6).toFixed(3),(a/1e6).toFixed(3),(o/1e6).toFixed(3)),t>=a&&t<=o&&(n=r)}return this.f=Date.now(),n},_n.prototype.chooseVariant=_n.prototype.chooseVariant,_n.prototype.enable=function(){this.c=!0},_n.prototype.enable=_n.prototype.enable,_n.prototype.disable=function(){this.c=!1},_n.prototype.disable=_n.prototype.disable,_n.prototype.segmentDownloaded=function(e,t){X.J("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.f,"enabled="+this.c);var n=this.b;if(!(16e3>t)){var i=8e3*t/e,r=e/1e3;n.a+=t,z(n.b,r,i),z(n.c,r,i)}if(null!=this.f&&this.c)e:{if(X.J("Suggesting Streams..."),this.i){if(Date.now()-this.f<1e3*this.a.switchInterval){X.J("Still within switch interval...");break e}}else{if(!(128e3<=this.b.a)){X.J("Still waiting for a good estimate...");break e}this.i=!0}n=this.chooseVariant(),i=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),X.debug("Calling switch_(), bandwidth="+Math.round(i/1e3)+" kbps"),this.h(n)}},_n.prototype.segmentDownloaded=_n.prototype.segmentDownloaded,_n.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},_n.prototype.getBandwidthEstimate=_n.prototype.getBandwidthEstimate,_n.prototype.setVariants=function(e){this.g=e},_n.prototype.setVariants=_n.prototype.setVariants,_n.prototype.configure=function(e){this.a=e},_n.prototype.configure=_n.prototype.configure,jn.prototype.toString=function(){return"v"+this.a+"."+this.b};var Hn=null,Vn="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),qn="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),zn=["loop","playbackRate"],Gn=["pause","play"],Wn="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),Xn={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},Yn={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},$n=[["getConfiguration","configure"]],Jn=[["isTextTrackVisible","setTextTrackVisibility"]],Qn="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),Zn=["attach","detach","load","unload"];function ei(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Te){var n={};for(r in t){var i=t[r];i&&"object"==typeof i?"detail"==r&&(n[r]=i):r in Event||(n[r]=i)}return n}if(t instanceof Error){var r=new Set(["name","message","stack"]);for(n in t)r.add(n);for(n=(i=d(Object.getOwnPropertyNames(t))).next();!n.done;n=i.next())r.add(n.value);for(i={},n=(r=d(r)).next();!n.done;n=r.next())i[n=n.value]=t[n];r={__type__:"Error",contents:i}}else if(t instanceof TimeRanges)for(r={__type__:"TimeRanges",length:t.length,start:[],end:[]},n=0;n<t.length;++n)r.start.push(t.start(n)),r.end.push(t.end(n));else r=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return r}}))}function ti(e){return JSON.parse(e,(function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){n=t.contents;var i,r=Error(n.message);for(i in n)r[i]=n[i];n=r}else n=t;return n}))}function ni(e,t,n,i,r,a){this.T=e,this.f=new le(t),this.V=n,this.l=!1,this.v=i,this.K=r,this.G=a,this.b=this.h=!1,this.H="",this.i=null,this.o=this.sd.bind(this),this.u=this.Sf.bind(this),this.a={video:{},player:{}},this.F=0,this.c={},this.g=null,fi.add(this)}var ii=!1,ri=null;function ai(e){for(var t=d(fi),n=t.next();!n.done;n=t.next())oi(n.value,e)}function oi(e,t){X.debug("CastSender: onExistingSessionJoined");var n=e.G();e.g=new pe,e.l=!0,e.ud(n,t)}function si(e){for(var t=d(fi),n=t.next();!n.done;n=t.next()){n=n.value;var i=e;X.debug("CastSender: receiver status",i),ii="available"==i,n.f.Gc()}}function ui(e){var t=ri;t.removeUpdateListener(e.o),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.u)}function ci(e){for(var t in e.c){var n=e.c[t];delete e.c[t],n.reject(new he(1,7,7e3))}}function li(e,t){var n=ei(t),i=ri;try{i.sendMessage("urn:x-cast:com.google.shaka.v2",n,(function(){}),X.error)}catch(t){throw X.error("Cast session sendMessage threw",t),n=new he(2,8,8005,t),e.v("player",new Te("error",{detail:n})),e.vb(),n}}(i=ni.prototype).destroy=function(){return fi.delete(this),ci(this),ri&&ui(this),this.f&&(this.f.stop(),this.f=null),this.K=this.v=null,this.b=this.h=!1,this.u=this.o=this.g=this.c=this.a=this.i=null,Promise.resolve()},i.ha=function(){return this.b},i.xd=function(){return this.H},i.init=function(){if(e.chrome&&chrome.cast&&chrome.cast.isAvailable&&this.T.length){this.h=!0,this.f.Gc();var t=new chrome.cast.SessionRequest(this.T);t=new chrome.cast.ApiConfig(t,ai.bind(this),si.bind(this),"origin_scoped"),chrome.cast.initialize(t,(function(){X.debug("CastSender: init")}),(function(e){X.error("CastSender: init error",e)})),ii&&this.f.R(.02),(t=ri)&&t.status!=chrome.cast.SessionStatus.STOPPED?(X.debug("CastSender: re-using existing connection"),oi(this,t)):ri=null}},i.Gd=function(e){this.i=e,this.b&&li(this,{type:"appData",appData:this.i})},i.cast=function(e){return this.h?ii?this.b?Promise.reject(new he(1,8,8002)):(this.g=new pe,chrome.cast.requestSession(this.ud.bind(this,e),this.pe.bind(this)),this.g):Promise.reject(new he(1,8,8001)):Promise.reject(new he(1,8,8e3))},i.vb=function(){if(this.b){if(ci(this),ri){ui(this);try{ri.stop((function(){}),(function(){}))}catch(e){}ri=null}this.sd()}},i.get=function(e,t){if("video"==e){if(Gn.includes(t))return this.ye.bind(this,e,t)}else if("player"==e){if(Yn[t]&&!this.get("player","isLive")())return function(){};if(Qn.includes(t))return this.ye.bind(this,e,t);if(Zn.includes(t))return this.ig.bind(this,e,t);if(Xn[t])return this.ve.bind(this,e,t)}return this.ve(e,t)},i.set=function(e,t,n){this.a[e][t]=n,li(this,{type:"set",targetName:e,property:t,value:n})},i.ud=function(e,t){X.debug("CastSender: onSessionInitiated"),ri=t,t.addUpdateListener(this.o),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.u),this.sd(),li(this,{type:"init",initState:e,appData:this.i}),this.g.resolve()},i.pe=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.g.reject(new he(2,8,t,e))},i.ve=function(e,t){return this.a[e][t]},i.ye=function(e,t,n){for(var i=[],r=2;r<arguments.length;++r)i[r-2]=arguments[r];li(this,{type:"call",targetName:e,methodName:t,args:i})},i.ig=function(e,t,n){for(var i=[],r=2;r<arguments.length;++r)i[r-2]=arguments[r];r=new pe;var a=this.F.toString();this.F++,this.c[a]=r;try{li(this,{type:"asyncCall",targetName:e,methodName:t,args:i,id:a})}catch(e){r.reject(e)}return r},i.sd=function(){var e=!!ri&&"connected"==ri.status;if(X.debug("CastSender: connection status",e),this.b&&!e){for(var t in this.K(),this.a)this.a[t]={};ci(this)}this.H=(this.b=e)?ri.receiver.friendlyName:"",this.f.Gc()},i.Sf=function(e,t){var n=ti(t);switch(X.J("CastSender: message",n),n.type){case"event":var i=n.event;this.v(n.targetName,new Te(i.type,i));break;case"update":for(var r in i=n.update)for(var a in n=this.a[r]||{},i[r])n[a]=i[r][a];this.l&&(this.V(),this.l=!1);break;case"asyncComplete":if(r=n.id,n=n.error,a=this.c[r],delete this.c[r],a)if(n){for(i in r=new he(n.severity,n.category,n.code),n)r[i]=n[i];a.reject(r)}else a.resolve()}};var fi=new Set;function di(e,t,n){var i=this;Ee.call(this),this.c=e,this.b=t,this.i=this.g=this.f=this.l=this.h=null,this.u=n,this.o=new Map,this.a=new ni(n,(function(){return mi(i)}),(function(){return gi(i)}),(function(e,t){return yi(i,e,t)}),(function(){return vi(i)}),(function(){return pi(i)})),function(e){for(var t in e.a.init(),e.i=new Oe,Vn.forEach(function(e){this.i.B(this.c,e,this.G.bind(this))}.bind(e)),Wn.forEach(function(e){this.i.B(this.b,e,this.v.bind(this))}.bind(e)),e.h={},e.c)Object.defineProperty(e.h,t,{configurable:!1,enumerable:!0,get:e.F.bind(e,t),set:e.H.bind(e,t)});e.l={},hi(e,(function(t){Object.defineProperty(e.l,t,{configurable:!1,enumerable:!0,get:function(){return function e(t,n){if(t.o.has(n)&&(n=t.o.get(n)),"addEventListener"==n)return t.g.addEventListener.bind(t.g);if("removeEventListener"==n)return t.g.removeEventListener.bind(t.g);if("getMediaElement"==n)return function(){return this.h}.bind(t);if("getSharedConfiguration"==n)return X.m("Can't share configuration across a network. Returning copy."),t.a.get("player","getConfiguration");if("getNetworkingEngine"==n)return t.a.ha()&&X.m("NOTE: getNetworkingEngine() is always local!"),t.b.Ub.bind(t.b);if(t.a.ha()){if("getManifest"==n||"drmInfo"==n)return function(){return X.Z(n+"() does not work while casting!"),null};if("getManifestUri"==n)return Kn("getManifestUri",'Please use "getAssetUri" instead.'),e(t,"getAssetUri");if("attach"==n||"detach"==n)return function(){return X.Z(n+"() does not work while casting!"),Promise.resolve()}}return t.a.ha()&&0==Object.keys(t.a.a.video).length&&Xn[n]||!t.a.ha()?t.b[n].bind(t.b):t.a.get("player",n)}(e,t)}})})),function(e){var t=new Map;hi(e,(function(n,i){if(t.has(i)){var r=t.get(i);n.length<r.length?e.o.set(n,r):e.o.set(r,n)}else t.set(i,n)}))}(e),e.f=new Ee,e.f.gc=e.h,e.g=new Ee,e.g.gc=e.l}(this)}function hi(e,t){function n(e){return"constructor"!=e&&"function"==typeof i[e]&&!r.has(e)}var i=e.b,r=new Set;for(a in i)n(a)&&(r.add(a),t(a,i[a]));for(var a=Object.getPrototypeOf(i),o=Object.getPrototypeOf({});a&&a!=o;){for(var s=d(Object.getOwnPropertyNames(a)),u=s.next();!u.done;u=s.next())n(u=u.value)&&(r.add(u),t(u,i[u]));a=Object.getPrototypeOf(a)}}function pi(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.b.pc(),startTime:null};return e.c.pause(),zn.forEach(function(e){t.video[e]=this.c[e]}.bind(e)),e.c.ended||(t.startTime=e.c.currentTime),$n.forEach(function(e){var n=e[1];e=this.b[e[0]](),t.player[n]=e}.bind(e)),Jn.forEach(function(e){var n=e[1];e=this.b[e[0]](),t.playerAfterLoad[n]=e}.bind(e)),t}function mi(e){e.dispatchEvent(new Te("caststatuschanged"))}function gi(e){e.f.dispatchEvent(new Te(e.h.paused?"pause":"play"))}function vi(e){$n.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(e));var t=e.a.get("player","getAssetUri")(),n=e.a.get("video","ended"),i=Promise.resolve(),r=e.c.autoplay,a=null;n||(a=e.a.get("video","currentTime")),t&&(e.c.autoplay=!1,i=e.b.load(t,a));var o={};zn.forEach(function(e){o[e]=this.a.get("video",e)}.bind(e)),i.then((function(){e.c&&(zn.forEach(function(e){this.c[e]=o[e]}.bind(e)),Jn.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(e)),e.c.autoplay=r,t&&e.c.play())}),(function(t){e.b.dispatchEvent(new Te("error",{detail:t}))}))}function yi(e,t,n){e.a.ha()&&("video"==t?e.f.dispatchEvent(n):"player"==t&&e.g.dispatchEvent(n))}function bi(e,t,n,i){var r=this;Ee.call(this),this.a=e,this.b=t,this.c=new Oe,this.G={video:e,player:t},this.u=n||function(){},this.H=i||function(e){return e},this.v=!1,this.h=!0,this.g=0,this.o=!1,this.l=!0,this.i=this.f=null,this.F=new le((function(){Ti(r)})),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=e.re.bind(e),t.onSenderDisconnected=e.re.bind(e),t.onSystemVolumeChanged=e.bf.bind(e),e.i=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.i.onMessage=e.Nf.bind(e),e.f=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.f.onMessage=e.Xf.bind(e),t.start(),Vn.forEach(function(e){this.c.B(this.a,e,this.we.bind(this,"video"))}.bind(e)),Wn.forEach(function(e){this.c.B(this.b,e,this.we.bind(this,"player"))}.bind(e)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.b.Hd(3840,2160):e.b.Hd(1920,1080),e.c.B(e.a,"loadeddata",function(){this.o=!0}.bind(e)),e.c.B(e.b,"loading",function(){this.h=!1,wi(this)}.bind(e)),e.c.B(e.a,"playing",function(){this.h=!1,wi(this)}.bind(e)),e.c.B(e.a,"pause",function(){wi(this)}.bind(e)),e.c.B(e.b,"unloading",function(){this.h=!0,wi(this)}.bind(e)),e.c.B(e.a,"ended",function(){var e=this;new le((function(){e.a&&e.a.ended&&(e.h=!0,wi(e))})).R(5)}.bind(e))}(this)}function wi(e){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new Te("caststatuschanged")),Si(this)||ki(this))}.bind(e))}function Ti(e){e.F.R(.5);var t={video:{},player:{}};if(qn.forEach(function(e){t.video[e]=this.a[e]}.bind(e)),e.b.X())for(var n in Yn)0==e.g%Yn[n]&&(t.player[n]=e.b[n]());for(var i in Xn)0==e.g%Xn[i]&&(t.player[i]=e.b[i]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),e.o&&(e.g+=1),xi(e,{type:"update",update:t},e.f),Si(e)}function Si(e){return!(!e.l||!e.a.duration&&!e.b.X())&&(Ei(e),e.l=!1,!0)}function Ei(e,t){t=void 0===t?0:t;var n={contentId:e.b.pc(),streamType:e.b.X()?"LIVE":"BUFFERED",contentType:""};e.b.X()||(n.duration=e.a.duration),ki(e,t,n)}function xi(e,t,n,i){e.v&&(e=ei(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function ki(e,t,n){t=void 0===t?0:t,n=void 0===n?null:n;var i=e.a.playbackRate,r=Ai;i={mediaSessionId:0,playbackRate:i,playerState:r=e.h?r.IDLE:e.b.fd()?r.Ke:e.a.paused?r.Me:r.Ne,currentTime:e.a.currentTime,supportedMediaCommands:63,volume:{level:e.a.volume,muted:e.a.muted}},n&&(i.media=n),xi(e,{requestId:t,type:"MEDIA_STATUS",status:[i]},e.i)}e.__onGCastApiAvailable=function(e){if(e)for(var t=(e=d(fi)).next();!t.done;t=e.next())t.value.init()},V(di,Ee),H("shaka.cast.CastProxy",di),di.prototype.destroy=function(e){return e&&this.a.vb(),this.i&&(this.i.release(),this.i=null),e=[],this.b&&(e.push(this.b.destroy()),this.b=null),this.a&&(e.push(this.a.destroy()),this.a=null),this.l=this.h=this.c=null,Promise.all(e)},di.prototype.destroy=di.prototype.destroy,di.prototype.Df=function(){return this.h},di.prototype.getVideo=di.prototype.Df,di.prototype.vf=function(){return this.l},di.prototype.getPlayer=di.prototype.vf,di.prototype.Se=function(){return this.a.h&&ii},di.prototype.canCast=di.prototype.Se,di.prototype.ha=function(){return this.a.ha()},di.prototype.isCasting=di.prototype.ha,di.prototype.xd=function(){return this.a.xd()},di.prototype.receiverName=di.prototype.xd,di.prototype.cast=function(){var e=pi(this);return this.a.cast(e).then(function(){if(this.b)return this.b.Od()}.bind(this))},di.prototype.cast=di.prototype.cast,di.prototype.Gd=function(e){this.a.Gd(e)},di.prototype.setAppData=di.prototype.Gd,di.prototype.Cg=function(){var e=this.a;if(e.b){var t=e.G();chrome.cast.requestSession(e.ud.bind(e,t),e.pe.bind(e))}},di.prototype.suggestDisconnect=di.prototype.Cg,di.prototype.Ve=function(e){var t=this;return p((function n(){return _(n,(function(n){switch(n.j){case 1:return e==t.u?n.return():(t.u=e,t.a.vb(),x(n,t.a.destroy(),2));case 2:t.a=null,t.a=new ni(e,(function(){return mi(t)}),(function(){return gi(t)}),(function(e,n){return yi(t,e,n)}),(function(){return vi(t)}),(function(){return pi(t)})),t.a.init(),k(n)}}))}))},di.prototype.changeReceiverId=di.prototype.Ve,di.prototype.vb=function(){this.a.vb()},di.prototype.forceDisconnect=di.prototype.vb,di.prototype.F=function(e){if("addEventListener"==e)return this.f.addEventListener.bind(this.f);if("removeEventListener"==e)return this.f.removeEventListener.bind(this.f);if(this.a.ha()&&0==Object.keys(this.a.a.video).length){var t=this.c[e];if("function"!=typeof t)return t}return this.a.ha()?this.a.get("video",e):("function"==typeof(e=this.c[e])&&(e=e.bind(this.c)),e)},di.prototype.H=function(e,t){this.a.ha()?this.a.set("video",e,t):this.c[e]=t},di.prototype.G=function(e){this.a.ha()||this.f.dispatchEvent(new Te(e.type,e))},di.prototype.v=function(e){this.a.ha()||this.g.dispatchEvent(e)},V(bi,Ee),H("shaka.cast.CastReceiver",bi),bi.prototype.isConnected=function(){return this.v},bi.prototype.isConnected=bi.prototype.isConnected,bi.prototype.If=function(){return this.h},bi.prototype.isIdle=bi.prototype.If,bi.prototype.destroy=function(){var e=this;return p((function t(){var n;return _(t,(function(t){switch(t.j){case 1:return e.c&&(e.c.release(),e.c=null),n=[],e.b&&(n.push(e.b.destroy()),e.b=null),e.F&&(e.F.stop(),e.F=null),e.a=null,e.G=null,e.u=null,e.v=!1,e.h=!0,e.f=null,e.i=null,x(t,Promise.all(n),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),k(t)}}))}))},bi.prototype.destroy=bi.prototype.destroy,(i=bi.prototype).re=function(){this.g=0,this.l=!0,this.v=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,wi(this)},i.we=function(e,t){this.b&&(Ti(this),xi(this,{type:"event",targetName:e,event:t},this.f))},i.bf=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&xi(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.f),xi(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},i.Xf=function(e){var t=ti(e.data);switch(X.debug("CastReceiver: message",t),t.type){case"init":this.g=0,this.o=!1,this.l=!0,function(e,t,n){for(var i in t.player)e.b[i](t.player[i]);e.u(n),n=Promise.resolve();var r=e.a.autoplay;t.manifest&&(e.a.autoplay=!1,n=e.b.load(t.manifest,t.startTime)),n.then((function(){if(e.b){for(var n in t.video)e.a[n]=t.video[n];for(var i in t.playerAfterLoad)e.b[i](t.playerAfterLoad[i]);e.a.autoplay=r,t.manifest&&(e.a.play(),ki(e))}}),(function(t){e.b.dispatchEvent(new Te("error",{detail:t}))}))}(this,t.initState,t.appData),Ti(this);break;case"appData":this.u(t.appData);break;case"set":var n=t.targetName,i=t.property;if(t=t.value,"video"==n){var r=cast.receiver.CastReceiverManager.getInstance();if("volume"==i){r.setSystemVolumeLevel(t);break}if("muted"==i){r.setSystemVolumeMuted(t);break}}this.G[n][i]=t;break;case"call":(n=this.G[t.targetName])[t.methodName].apply(n,t.args);break;case"asyncCall":n=t.targetName,i=t.methodName,"player"==n&&"load"==i&&(this.g=0,this.o=!1),r=t.id,e=e.senderId;var a=this.G[n];t=a[i].apply(a,t.args),"player"==n&&"load"==i&&(t=t.then(function(){this.l=!0}.bind(this))),t.then(this.Ce.bind(this,e,r,null),this.Ce.bind(this,e,r))}},i.Nf=function(e){var t=ti(e.data);switch(X.debug("CastReceiver: message",t),t.type){case"PLAY":this.a.play(),ki(this);break;case"PAUSE":this.a.pause(),ki(this);break;case"SEEK":e=t.currentTime;var n=t.resumeState;null!=e&&(this.a.currentTime=Number(e)),n&&"PLAYBACK_START"==n?(this.a.play(),ki(this)):n&&"PLAYBACK_PAUSE"==n&&(this.a.pause(),ki(this));break;case"STOP":this.b.Od().then(function(){this.b&&ki(this)}.bind(this));break;case"GET_STATUS":Ei(this,Number(t.requestId));break;case"VOLUME":e=(n=t.volume).level,n=n.muted;var i=this.a.volume,r=this.a.muted;null!=e&&(this.a.volume=Number(e)),null!=n&&(this.a.muted=n),i==this.a.volume&&r==this.a.muted||ki(this);break;case"LOAD":this.g=0,this.l=this.o=!1,e=t.media,n=t.currentTime,i=this.H(e.contentId),r=t.autoplay||!0,this.u(e.customData),r&&(this.a.autoplay=!0),this.b.load(i,n).then(function(){this.b&&Ei(this)}.bind(this)).catch(function(e){var n="LOAD_FAILED";7==e.category&&7e3==e.code&&(n="LOAD_CANCELLED"),xi(this,{requestId:Number(t.requestId),type:n},this.i)}.bind(this));break;default:X.m("Unrecognized message type from the generic Chromecast controller!",t.type),xi(this,{requestId:Number(t.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}},i.Ce=function(e,t,n){this.b&&xi(this,{type:"asyncComplete",id:t,error:n},this.f,e)};var Ai={IDLE:"IDLE",Ne:"PLAYING",Ke:"BUFFERING",Me:"PAUSED"};function Mi(e,t){this.N=e,this.b=t==Ii,this.a=0}H("shaka.util.DataViewReader",Mi);var Ii=1;function Pi(){throw new he(2,3,3e3)}function Ci(){this.c=[],this.b=[],this.a=!1}function Ri(e){for(var t=null!=e.flags?12:8;e.reader.ya()&&!e.parser.a;)e.parser.Ac(e.start+t,e.reader,e.partialOkay)}function Ni(e){for(var t=null!=e.flags?12:8,n=e.reader.I();0<n&&!e.parser.a;--n)e.parser.Ac(e.start+t,e.reader,e.partialOkay)}function Di(e){return function(t){e(t.reader.gb(t.reader.N.byteLength-t.reader.ga()))}}function Li(e){for(var t=0,n=0;n<e.length;n++)t=t<<8|e.charCodeAt(n);return t}function Ui(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function _i(e){var t=this;this.a=[],this.b=[],this.data=[],(new Ci).L("moov",Ri).ia("pssh",(function(e){if(1<e.version)X.m("Unrecognized PSSH version found!");else{var n=e.reader.N;if(n=new Uint8Array(n.buffer,n.byteOffset-12,e.size),t.data.push(n),t.a.push(ft.Ic(e.reader.gb(16))),0<e.version){n=e.reader.I();for(var i=0;i<n;++i){var r=ft.Ic(e.reader.gb(16));t.b.push(r)}}}})).parse(e),0==this.data.length&&X.m("No pssh box found!")}Mi.Endianness={Lg:0,Ng:Ii},Mi.prototype.ya=function(){return this.a<this.N.byteLength},Mi.prototype.hasMoreData=Mi.prototype.ya,Mi.prototype.ga=function(){return this.a},Mi.prototype.getPosition=Mi.prototype.ga,Mi.prototype.jf=function(){return this.N.byteLength},Mi.prototype.getLength=Mi.prototype.jf,Mi.prototype.na=function(){try{var e=this.N.getUint8(this.a);return this.a+=1,e}catch(e){Pi()}},Mi.prototype.readUint8=Mi.prototype.na,Mi.prototype.$b=function(){try{var e=this.N.getUint16(this.a,this.b);return this.a+=2,e}catch(e){Pi()}},Mi.prototype.readUint16=Mi.prototype.$b,Mi.prototype.I=function(){try{var e=this.N.getUint32(this.a,this.b);return this.a+=4,e}catch(e){Pi()}},Mi.prototype.readUint32=Mi.prototype.I,Mi.prototype.xe=function(){try{var e=this.N.getInt32(this.a,this.b);return this.a+=4,e}catch(e){Pi()}},Mi.prototype.readInt32=Mi.prototype.xe,Mi.prototype.Kb=function(){try{if(this.b)var e=this.N.getUint32(this.a,!0),t=this.N.getUint32(this.a+4,!0);else t=this.N.getUint32(this.a,!1),e=this.N.getUint32(this.a+4,!1)}catch(e){Pi()}if(2097151<t)throw new he(2,3,3001);return this.a+=8,t*Math.pow(2,32)+e},Mi.prototype.readUint64=Mi.prototype.Kb,Mi.prototype.gb=function(e){this.a+e>this.N.byteLength&&Pi();var t=new Uint8Array(this.N.buffer,this.N.byteOffset+this.a,e);return this.a+=e,t},Mi.prototype.readBytes=Mi.prototype.gb,Mi.prototype.P=function(e){this.a+e>this.N.byteLength&&Pi(),this.a+=e},Mi.prototype.skip=Mi.prototype.P,Mi.prototype.ze=function(e){this.a<e&&Pi(),this.a-=e},Mi.prototype.rewind=Mi.prototype.ze,Mi.prototype.seek=function(e){(0>e||e>this.N.byteLength)&&Pi(),this.a=e},Mi.prototype.seek=Mi.prototype.seek,Mi.prototype.wd=function(){for(var e=this.a;this.ya()&&0!=this.N.getUint8(this.a);)this.a+=1;return e=new Uint8Array(this.N.buffer,this.N.byteOffset+e,this.a-e),this.a+=1,rt(e)},Mi.prototype.readTerminatedString=Mi.prototype.wd,H("shaka.util.Mp4Parser",Ci),Ci.prototype.L=function(e,t){var n=Li(e);return this.c[n]=0,this.b[n]=t,this},Ci.prototype.box=Ci.prototype.L,Ci.prototype.ia=function(e,t){var n=Li(e);return this.c[n]=1,this.b[n]=t,this},Ci.prototype.fullBox=Ci.prototype.ia,Ci.prototype.stop=function(){this.a=!0},Ci.prototype.stop=Ci.prototype.stop,Ci.prototype.parse=function(e,t){var n=new Uint8Array(e);for(n=new Mi(new DataView(n.buffer,n.byteOffset,n.byteLength),0),this.a=!1;n.ya()&&!this.a;)this.Ac(0,n,t)},Ci.prototype.parse=Ci.prototype.parse,Ci.prototype.Ac=function(e,t,n){var i=t.ga(),r=t.I(),a=t.I();switch(X.J("Parsing MP4 box",Ui(a)),r){case 0:r=t.N.byteLength-i;break;case 1:r=t.Kb()}var o=this.b[a];if(o){var s=null,u=null;1==this.c[a]&&(s=(u=t.I())>>>24,u&=16777215),a=i+r,n&&a>t.N.byteLength&&(a=t.N.byteLength),a-=t.ga(),t=0<a?t.gb(a):new Uint8Array(0),o({parser:this,partialOkay:n||!1,version:s,flags:u,reader:t=new Mi(new DataView(t.buffer,t.byteOffset,t.byteLength),0),size:r,start:i+e})}else t.P(Math.min(i+r-t.ga(),t.N.byteLength-t.ga()))},Ci.prototype.parseNext=Ci.prototype.Ac,Ci.children=Ri,Ci.sampleDescription=Ni,Ci.allData=Di,Ci.typeToString=Ui;var Oi={oc:function(e,t){var n=Oi.U(e,t);return 1!=n.length?null:n[0]},Wc:function(e,t,n){return 1!=(e=Oi.ae(e,t,n)).length?null:e[0]},U:function(e,t){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.tagName==t}))},ae:function(e,t,n){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.localName==n&&e.namespaceURI==t}))},getAttributeNS:function(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null},qc:function(e){return Array.prototype.every.call(e.childNodes,(function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}))?e.textContent.trim():null},M:function(e,t,n,i){i=void 0===i?null:i;var r=null;return null!=(e=e.getAttribute(t))&&(r=n(e)),null==r?i:r},ag:function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null},Ia:function(e){if(!e)return null;var t=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e);return t?(e=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(e)?e:null):(X.m("Invalid duration string:",e),null)},Cc:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},parseInt:function(e){return 0==(e=Number(e))%1?e:null},Bc:function(e){return 0==(e=Number(e))%1&&0<e?e:null},Hb:function(e){return 0==(e=Number(e))%1&&0<=e?e:null},parseFloat:function(e){return e=Number(e),isNaN(e)?null:e},$e:function(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e},ue:function(e,t){var n=new DOMParser;try{var i=n.parseFromString(e,"text/xml")}catch(e){}if(i&&i.documentElement.tagName==t)var r=i.documentElement;return r&&0<r.getElementsByTagName("parsererror").length?null:r},te:function(e,t){try{var n=rt(e);return Oi.ue(n,t)}catch(e){}}},ji=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Ki(e,t,n){var i=function(e){for(var t=[],n=(e=d(e)).next();!n.done;n=e.next())(n=Hi(n.value))&&t.push(n);return t}(e),r=null;e=[];var a=[],o=new Set(i.map((function(e){return e.keyId})));if(o.delete(null),1<o.size)throw new he(2,4,4010);if(n||(a=i.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.Ae||(r=e.init||r,!1)}))).length&&(0==(e=function(e,t,n){for(var i=[],r=(n=d(n)).next();!r.done;r=n.next()){r=r.value;var a=ji.get(r.Ae);if(a){var o;if(o=Oi.Wc(r.node,"urn:microsoft:playready","pro")){o=ft.Fa(o.textContent);var s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=o.length,c=s.length+16+u,l=new ArrayBuffer(c),f=new Uint8Array(l);l=new DataView(l);var h=0;l.setUint32(h,c),h+=4,l.setUint32(h,1886614376),h+=4,l.setUint32(h,0),h+=4,f.set(s,h),h+=s.length,l.setUint32(h,u),h+=4,f.set(o,h),o=[{initData:f,initDataType:"cenc",keyId:r.keyId}]}else o=null;o=Ft(a,r.init||e||o),(a=Fi.get(a))&&(o.licenseServerUri=a(r)),i.push(o)}else for(r=d(r=t(r.node)||[]),a=r.next();!a.done;a=r.next())i.push(a.value)}return i}(r,t,a)).length&&(e=[Ft("",r)])),i.length&&(n||!a.length))for(e=[],n=(t=d(ji.values())).next();!n.done;n=t.next())"org.w3.clearkey"!=(n=n.value)&&e.push(Ft(n,r));if(o=Array.from(o)[0]||null)for(n=(t=d(e)).next();!n.done;n=t.next())for(i=(n=d(n.value.initData)).next();!i.done;i=n.next())i.value.keyId=o;return{Xd:o,Pg:r,drmInfos:e,be:!0}}var Bi,Fi=(new Map).set("com.widevine.alpha",(function(e){return(e=Oi.Wc(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""})).set("com.microsoft.playready",(function(e){return(e=Oi.Wc(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,n=new DataView(e).getUint32(t,!0);if(t+=4,n!==e.byteLength)return X.m("PlayReady Object with invalid length encountered."),[];t+=2,n=[];for(var i=new DataView(e);t<e.byteLength-1;){var r=i.getUint16(t,!0);t+=2;var a=i.getUint16(t,!0);t+=2;var o=new Uint8Array(e,t,a);n.push({type:r,value:o}),t+=a}return n}((e=ft.Fa(e.textContent)).buffer).filter((function(e){return 1===e.type}))[0])?(e=at(e.value,!0),(e=Oi.ue(e,"WRMHEADER"))?function(e){for(var t=(e=d(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var n=(t=d(t.value.childNodes)).next();!n.done;n=t.next())if((n=n.value)instanceof Element&&"LA_URL"==n.tagName)return n.textContent;return""}(e):""):""}));function Hi(e){var t=e.getAttribute("schemeIdUri"),n=Oi.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID"),i=Oi.ae(e,"urn:mpeg:cenc:2013","pssh").map(Oi.qc);if(!t)return X.error("Missing required schemeIdUri attribute on","ContentProtection element",e),null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new he(2,4,4009);var r=[];try{r=i.map((function(e){return{initDataType:"cenc",initData:ft.Fa(e),keyId:null}}))}catch(e){throw new he(2,4,4007)}return{node:e,Ae:t,keyId:n,init:0<r.length?r:null}}function Vi(t,n,i,r,a){var o={RepresentationID:n,Number:i,Bandwidth:r,Time:a};return t.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(n,i,r,a){if("$$"==n)return"$";var s=o[i];if(null==s)return X.m("URL template does not have an available substitution for identifier",'"'+i+'":',t),n;switch("RepresentationID"==i&&r&&(X.m("URL template should not contain a width specifier for identifier",'"RepresentationID":',t),r=void 0),"Time"==i&&(s=Math.round(s)),a){case void 0:case"d":case"i":case"u":n=s.toString();break;case"o":n=s.toString(8);break;case"x":n=s.toString(16);break;case"X":n=s.toString(16).toUpperCase();break;default:n=s.toString()}return r=e.parseInt(r,10)||1,Array(Math.max(0,r-n.length)+1).join("0")+n}))}function qi(e,t){var n=zi(e,t,"timescale"),i=1;n&&(i=Oi.Bc(n)||1),n=zi(e,t,"duration"),(n=Oi.Bc(n||""))&&(n/=i);var r=zi(e,t,"startNumber"),a=Number(zi(e,t,"presentationTimeOffset"))||0,o=Oi.Hb(r||"");null!=r&&null!=o||(o=1);var s=Gi(e,t,"SegmentTimeline");if(r=null,s){r=i;var u=e.W.duration||1/0;s=Oi.U(s,"S");for(var c=[],l=-a,f=0;f<s.length;++f){var d=s[f],h=Oi.M(d,"t",Oi.Hb),p=Oi.M(d,"d",Oi.Hb),m=Oi.M(d,"r",Oi.parseInt);if(null!=h&&(h-=a),!p){X.m('"S" element must have a duration:','ignoring the remaining "S" elements.',d);break}if(h=null!=h?h:l,0>(m=m||0))if(f+1<s.length){if(null==(m=Oi.M(s[f+1],"t",Oi.Hb))){X.m('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',d);break}if(h>=m){X.m('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',d);break}m=Math.ceil((m-h)/p)-1}else{if(1/0==u){X.m('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',d);break}if(h/r>=u){X.m('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',d);break}m=Math.ceil((u*r-h)/p)-1}for(0<c.length&&h!=l&&(Math.abs((h-l)/r)>=1/15&&X.m("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",d),c[c.length-1].end=h/r),d=0;d<=m;++d)l=h+p,c.push({start:h/r,end:l/r,Hg:h}),h=l}r=c}return{timescale:i,da:n,ib:o,oa:a/i||0,Pd:a,S:r}}function zi(e,t,n){return[t(e.A),t(e.aa),t(e.ma)].filter(Kt.Na).map((function(e){return e.getAttribute(n)})).reduce((function(e,t){return e||t}))}function Gi(e,t,n){return[t(e.A),t(e.aa),t(e.ma)].filter(Kt.Na).map((function(e){return Oi.oc(e,n)})).reduce((function(e,t){return e||t}))}function Wi(e,t,n,i,r,a){if(a=void 0===a?0:a,Oi.getAttributeNS(e,"http://www.w3.org/1999/xlink","href")){var o=function(e,t,n,i,r,a){for(var o=Oi.getAttributeNS(e,"http://www.w3.org/1999/xlink","href"),s=Oi.getAttributeNS(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=0;u<e.attributes.length;u++){var c=e.attributes[u];"http://www.w3.org/1999/xlink"==c.namespaceURI&&(e.removeAttributeNS(c.namespaceURI,c.localName),--u)}if(5<=a)return ge(new he(2,4,4028));if("onLoad"!=s)return ge(new he(2,4,4027));var l=Bt([i],[o]);return r.request(0,De(l,t)).Y((function(i){if(!(i=Oi.te(i.data,e.tagName)))return ge(new he(2,4,4001,o));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;i.childNodes.length;){var s=i.childNodes[0];i.removeChild(s),e.appendChild(s)}for(s=0;s<i.attributes.length;s++){var u=i.attributes[s].nodeName,c=i.getAttribute(u);e.setAttribute(u,c)}return Wi(e,t,n,l[0],r,a+1)}))}(e,t,n,i,r,a);return n&&(o=o.Y(void 0,(function(){return Wi(e,t,n,i,r,a)}))),o}o=[];for(var s=0;s<e.childNodes.length;s++){var u=e.childNodes[s];u instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==Oi.getAttributeNS(u,"http://www.w3.org/1999/xlink","href")?(e.removeChild(u),--s):"SegmentTimeline"!=u.tagName&&o.push(Wi(u,t,n,i,r,a)))}return we(o).Y((function(){return e}))}function Xi(e,t,n){this.c=e,this.b=t,this.a=n}function Yi(e,t,n,i,r,a){this.position=e,this.startTime=t,this.endTime=n,this.c=i,this.b=r,this.a=a}function $i(e,t,n,i){var r,a=(new Ci).ia("sidx",(function(e){r=function(e,t,n,i){var r=[];i.reader.P(4);var a=i.reader.I();if(0==a)throw X.error("Invalid timescale."),new he(2,3,3005);if(0==i.version)var o=i.reader.I(),s=i.reader.I();else o=i.reader.Kb(),s=i.reader.Kb();i.reader.P(2);var u=i.reader.$b();for(e=e+i.size+s,s=0;s<u;s++){var c=i.reader.I(),l=(2147483648&c)>>>31;c&=2147483647;var f=i.reader.I();if(i.reader.P(4),1==l)throw X.error("Heirarchical SIDXs are not supported."),new he(2,3,3006);r.push(new Yi(r.length,o/a-t,(o+f)/a-t,(function(){return n}),e,e+c-1)),o+=f,e+=c}return i.parser.stop(),r}(t,i,n,e)}));if(e&&a.parse(e),r)return r;throw X.error('Invalid box type, expected "sidx".'),new he(2,3,3004)}function Ji(e){this.a=e}function Qi(e,t){for(;e.a.length&&e.a[e.a.length-1].startTime>=t;)e.a.pop();for(;e.a.length&&0>=e.a[0].endTime;)e.a.shift();if(0!=e.a.length){var n=e.a[e.a.length-1];e.a[e.a.length-1]=new Yi(n.position,n.startTime,t,n.c,n.b,n.a)}}function Zi(e){this.b=e,this.a=new Mi(e,0),Bi||(Bi=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function er(e){var t=tr(e);if(7<t.length)throw new he(2,3,3002);for(var n=0,i=0;i<t.length;i++)n=256*n+t[i];t=n,n=tr(e);e:{i=ft.Da;for(var r=0;r<Bi.length;r++)if(i(n,Bi[r])){i=!0;break e}i=!1}if(i)n=e.b.byteLength-e.a.ga();else{if(8==n.length&&224&n[1])throw new he(2,3,3001);for(i=n[0]&(1<<8-n.length)-1,r=1;r<n.length;r++)i=256*i+n[r];n=i}return n=e.a.ga()+n<=e.b.byteLength?n:e.b.byteLength-e.a.ga(),i=new DataView(e.b.buffer,e.b.byteOffset+e.a.ga(),n),e.a.P(n),new nr(t,i)}function tr(e){var t,n=e.a.na();for(t=1;8>=t&&!(n&1<<8-t);t++);if(8<t)throw new he(2,3,3002);var i=new Uint8Array(t);for(i[0]=n,n=1;n<t;n++)i[n]=e.a.na();return i}function nr(e,t){this.id=e,this.a=t}function ir(e){if(8<e.a.byteLength)throw new he(2,3,3002);if(8==e.a.byteLength&&224&e.a.getUint8(0))throw new he(2,3,3001);for(var t=0,n=0;n<e.a.byteLength;n++){t=256*t+e.a.getUint8(n)}return t}function rr(){}function ar(e){var t=new Zi(e.a);if(179!=(e=er(t)).id)throw X.m("Not a CueTime element."),new he(2,3,3013);if(e=ir(e),183!=(t=er(t)).id)throw X.m("Not a CueTrackPositions element."),new he(2,3,3012);t=new Zi(t.a);for(var n=0;t.ya();){var i=er(t);if(241==i.id){n=ir(i);break}}return{Ig:e,hg:n}}function or(e,t){var n=Gi(e,t,"Initialization");if(!n)return null;var i=e.A.ta,r=n.getAttribute("sourceURL");r&&(i=Bt(e.A.ta,[r])),r=0;var a=null;return(n=Oi.M(n,"range",Oi.Cc))&&(r=n.start,a=n.end),new Xi((function(){return i}),r,a)}function sr(e,t,n,i,r,a,o,s){var u=e.presentationTimeline,c=!e.tb||!e.W.hd,l=e.W.start,f=e.W.duration,d=t,h=null;return{createSegmentIndex:function(){var e=[d(i,r,a),"webm"==o?d(n.c(),n.b,n.a):null];return d=null,Promise.all(e).then((function(e){var t=e[0];e=e[1]||null,t="mp4"==o?$i(t,r,i,s):(new rr).parse(t,e,i,s),u.Eb(t,l),h=new Ji(t),c&&Qi(h,f)}))},findSegmentPosition:function(e){return h.find(e)},getSegmentReference:function(e){return h.get(e)}}}function ur(e){return e.ac}function cr(e,t){var n=or(e,lr),i=function(e){return[e.A.Qa,e.aa.Qa,e.ma.Qa].filter(Kt.Na).map((function(e){return Oi.U(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.getAttribute("indexRange")&&!e.he&&(e.he=!0,X.m("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{Kf:t.getAttribute("media"),start:(t=Oi.M(t,"mediaRange",Oi.Cc,{start:0,end:null})).start,end:t.end}}))}(e),r=qi(e,lr),a=r.ib;0==a&&(X.m("SegmentList@startNumber must be > 0"),a=1);var o=0;if(r.da?o=r.da*(a-1):r.S&&0<r.S.length&&(o=r.S[0].start),!(i={da:r.da,startTime:o,ib:a,oa:r.oa,S:r.S,cb:i}).da&&!i.S&&1<i.cb.length)throw X.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.A),new he(2,4,4002);if(!i.da&&!e.W.duration&&!i.S&&1==i.cb.length)throw X.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.A),new he(2,4,4002);if(i.S&&0==i.S.length)throw X.m("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.A),new he(2,4,4002);return a=r=null,e.ma.id&&e.A.id&&(r=t[a=e.ma.id+","+e.A.id]),o=function(e,t,n,i){var r=i.cb.length;i.S&&i.S.length!=i.cb.length&&(r=Math.min(i.S.length,i.cb.length),X.m("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",i.cb.length,"to",r));for(var a=[],o=i.startTime,s=0;s<r;s++){var u,c=i.cb[s],l=Bt(n,[c.Kf]);u=null!=i.da?o+i.da:i.S?i.S[s].end:o+e,a.push(new Yi(s+t,o,u,function(e){return e}.bind(null,l),c.start,c.end)),o=u}return a}(e.W.duration,i.ib,e.A.ta,i),r?(r.md(o),a=e.presentationTimeline.Wb(),r.Tc(a-e.W.start)):(e.presentationTimeline.Eb(o,e.W.start),r=new Ji(o),a&&e.tb&&(t[a]=r)),e.tb&&e.W.hd||Qi(r,e.W.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:r.find.bind(r),getSegmentReference:r.get.bind(r),initSegmentReference:n,oa:i.oa}}function lr(e){return e.Qa}function fr(e,t,n,i){var r=function(e){var t=zi(e,dr,"initialization");if(!t)return null;var n=e.A.id,i=e.bandwidth||null,r=e.A.ta;return new Xi((function(){var e=Vi(t,n,null,i,null);return Bt(r,[e])}),0,null)}(e),a=qi(e,dr),o=zi(e,dr,"media"),s=zi(e,dr,"index");if(o=(a={da:a.da,timescale:a.timescale,ib:a.ib,oa:a.oa,Pd:a.Pd,S:a.S,kd:o,Yb:s}).Yb?1:0,o+=a.S?1:0,0==(o+=a.da?1:0))throw X.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.A),new he(2,4,4002);if(1!=o&&(X.m("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.A),a.Yb?(X.info("Using the index URL template by default."),a.S=null):X.info("Using the SegmentTimeline by default."),a.da=null),!a.Yb&&!a.kd)throw X.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.A),new he(2,4,4002);if(a.Yb){if("mp4"!=(n=e.A.mimeType.split("/")[1])&&"webm"!=n)throw X.error("SegmentTemplate specifies an unsupported container type.",e.A),new he(2,4,4006);if("webm"==n&&!r)throw X.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",e.A),new he(2,4,4005);i=Vi(a.Yb,e.A.id,null,e.bandwidth||null,null),e=sr(e,t,r,i=Bt(e.A.ta,[i]),0,null,n,a.oa)}else a.da?(i||(e.presentationTimeline.od(a.da),e.presentationTimeline.pd(e.W.start)),e=function(e,t){var n=e.W.duration,i=t.da,r=t.ib,a=t.timescale,o=t.kd,s=e.bandwidth||null,u=e.A.id,c=e.A.ta;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0>e||n&&e>=n?null:Math.floor(e/i)},getSegmentReference:function(e){var t=e*i,l=t+i;return n&&(l=Math.min(l,n)),0>l||n&&t>=n?null:new Yi(e,t,l,(function(){var n=Vi(o,u,e+r,s,t*a);return Bt(c,[n])}),0,null)}}}(e,a)):(o=t=null,e.ma.id&&e.A.id&&(t=n[o=e.ma.id+","+e.A.id]),s=function(e,t){for(var n=[],i=0;i<t.S.length;i++){var r=i+t.ib;n.push(new Yi(r,t.S[i].start,t.S[i].end,function(e,t,n,i,r,a){return Bt(i,[e=Vi(e,t,r,n,a)]).map((function(e){return e.toString()}))}.bind(null,t.kd,e.A.id,e.bandwidth||null,e.A.ta,r,t.S[i].Hg+t.Pd),0,null))}return n}(e,a),i=!e.tb||!e.W.hd,t?(i&&Qi(new Ji(s),e.W.duration),t.md(s),n=e.presentationTimeline.Wb(),t.Tc(n-e.W.start)):(e.presentationTimeline.Eb(s,e.W.start),t=new Ji(s),o&&e.tb&&(n[o]=t)),i&&Qi(t,e.W.duration),e={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:r,oa:a.oa}}function dr(e){return e.cc}H("shaka.media.InitSegmentReference",Xi),Xi.prototype.Qc=function(){return this.c()},Xi.prototype.createUris=Xi.prototype.Qc,Xi.prototype.bd=function(){return this.b},Xi.prototype.getStartByte=Xi.prototype.bd,Xi.prototype.ad=function(){return this.a},Xi.prototype.getEndByte=Xi.prototype.ad,H("shaka.media.SegmentReference",Yi),Yi.prototype.ga=function(){return this.position},Yi.prototype.getPosition=Yi.prototype.ga,Yi.prototype.sc=function(){return this.startTime},Yi.prototype.getStartTime=Yi.prototype.sc,Yi.prototype.gf=function(){return this.endTime},Yi.prototype.getEndTime=Yi.prototype.gf,Yi.prototype.Qc=function(){return this.c()},Yi.prototype.createUris=Yi.prototype.Qc,Yi.prototype.bd=function(){return this.b},Yi.prototype.getStartByte=Yi.prototype.bd,Yi.prototype.ad=function(){return this.a},Yi.prototype.getEndByte=Yi.prototype.ad,H("shaka.media.SegmentIndex",Ji),Ji.prototype.destroy=function(){return this.a=null,Promise.resolve()},Ji.prototype.destroy=Ji.prototype.destroy,Ji.prototype.find=function(e){for(var t=this.a.length-1;0<=t;--t){var n=this.a[t];if(e>=n.startTime&&e<n.endTime)return n.position}return this.a.length&&e<this.a[0].startTime?this.a[0].position:null},Ji.prototype.find=Ji.prototype.find,Ji.prototype.get=function(e){return 0==this.a.length||0>(e-=this.a[0].position)||e>=this.a.length?null:this.a[e]},Ji.prototype.get=Ji.prototype.get,Ji.prototype.offset=function(e){for(var t=0;t<this.a.length;++t)this.a[t].startTime+=e,this.a[t].endTime+=e},Ji.prototype.offset=Ji.prototype.offset,Ji.prototype.md=function(e){for(var t=[],n=0,i=0;n<this.a.length&&i<e.length;){var r=this.a[n],a=e[i];r.startTime<a.startTime?(t.push(r),n++):(r.startTime>a.startTime?0==n?t.push(a):X.m("Refusing to rewrite original references on update!"):(.1<Math.abs(r.endTime-a.endTime)?t.push(new Yi(r.position,a.startTime,a.endTime,a.c,a.b,a.a)):t.push(r),n++),i++)}for(;n<this.a.length;)t.push(this.a[n++]);if(t.length)for(n=t[t.length-1].position+1;i<e.length;)r=new Yi(n++,(r=e[i++]).startTime,r.endTime,r.c,r.b,r.a),t.push(r);else t=e;this.a=t},Ji.prototype.merge=Ji.prototype.md,Ji.prototype.Tc=function(e){for(var t=0;t<this.a.length;++t)if(this.a[t].endTime>e)return void this.a.splice(0,t);this.a=[]},Ji.prototype.evict=Ji.prototype.Tc,Zi.prototype.ya=function(){return this.a.ya()},rr.prototype.parse=function(e,t,n,i){var r;if(440786851!=er(t=new Zi(new DataView(t))).id)throw X.error("Not an EBML element."),new he(2,3,3008);var a=er(t);if(408125543!=a.id)throw X.error("Not a Segment element."),new he(2,3,3009);for(t=a.a.byteOffset,a=new Zi(a.a),r=null;a.ya();){var o=er(a);if(357149030==o.id){r=o;break}}if(!r)throw X.error("Not an Info element."),new he(2,3,3010);for(a=new Zi(r.a),r=1e6,o=null;a.ya();){var s=er(a);if(2807729==s.id)r=ir(s);else if(17545==s.id)if(4==(o=s).a.byteLength)o=o.a.getFloat32(0);else{if(8!=o.a.byteLength)throw new he(2,3,3003);o=o.a.getFloat64(0)}}if(null==o)throw new he(2,3,3011);if(r=o*(a=r/1e9),475249515!=(e=er(new Zi(new DataView(e)))).id)throw X.error("Not a Cues element."),new he(2,3,3007);return function(e,t,n,i,r,a){function o(){return r}var s=[];e=new Zi(e.a);for(var u=null,c=null;e.ya();){var l=er(e);if(187==l.id){var f=ar(l);f&&(l=n*f.Ig,f=t+f.hg,null!=u&&s.push(new Yi(s.length,u-a,l-a,o,c,f-1)),u=l,c=f)}}return null!=u&&s.push(new Yi(s.length,u-a,i-a,o,c,null)),s}(e,t,a,r,n,i)};var hr={Ib:{},Zb:{},zd:function(e,t){hr.Zb[e]=t}};function pr(e,t,n){this.f=e,this.Dc=t,this.h=this.g=1/0,this.a=1,this.b=this.c=null,this.l=0,this.o=!0,this.i=0,this.u=void 0===n||n}function mr(e,t,n,i){return e=De(e,i),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function gr(){var e=this;this.b=this.a=null,this.f=[],this.c=null,this.l=[],this.h=1,this.o={},this.u=0,this.v=new q(5),this.i=new le((function(){!function(e){p((function t(){var n,i;return _(t,(function(t){switch(t.j){case 1:return X.info("Updating manifest..."),n=0,A(t,2),x(t,vr(e),4);case 4:n=t.s,I(t,3);break;case 2:i=P(t),e.b&&(i.severity=1,e.b.onError(i));case 3:if(!e.b)return t.return();Tr(e,n),k(t)}}))}))}(e)})),this.g=new Ie}function vr(e){var t=Date.now(),n=e.b.networkingEngine.request(0,De(e.f,e.a.retryParameters));return Pe(e.g,n),n.promise.then((function(t){if(e.b)return t.uri&&!e.f.includes(t.uri)&&e.f.unshift(t.uri),function(e,t,n){if(!(t=Oi.te(t,"MPD")))throw new he(2,4,4001,n);return t=Wi(t,e.a.retryParameters,e.a.dash.xlinkFailGracefully,n,e.b.networkingEngine),Pe(e.g,t),t.promise.then((function(t){return function(e,t,n){return p((function i(){var r,a,o,s,u,c,l,f,d,h,p,m,g,v,y,b,w,T,S,E,A,M,I,P;return _(i,(function(i){switch(i.j){case 1:s=Kt,c=[n],0<(l=(u=Oi).U(t,"Location").map(u.qc).filter(s.Na)).length&&(f=Bt(c,l),c=e.f=f),d=u.U(t,"BaseURL").map(u.qc),h=Bt(c,d),p=e.a.dash.ignoreMinBufferTime,m=0,p||(m=u.M(t,"minBufferTime",u.Ia)),e.u=u.M(t,"minimumUpdatePeriod",u.Ia,-1),g=u.M(t,"availabilityStartTime",u.ag),v=u.M(t,"timeShiftBufferDepth",u.Ia),y=u.M(t,"maxSegmentDuration",u.Ia),b=t.getAttribute("type")||"static",w=e.a.dash.ignoreSuggestedPresentationDelay,T=null,w||(T=u.M(t,"suggestedPresentationDelay",u.Ia)),e.c?S=e.c.presentationTimeline:(E=Math.max(e.a.dash.defaultPresentationDelay,1.5*m),S=new pr(g,null!=T?T:E,e.a.dash.autoCorrectDrift));for(var C={tb:"static"!=b,presentationTimeline:S,ma:null,W:null,aa:null,A:null,bandwidth:0,he:!1},R=h,N=Oi.M(t,"mediaPresentationDuration",Oi.Ia),D=[],L=0,U=Oi.U(t,"Period"),_=0;_<U.length;_++){var O=U[_];L=Oi.M(O,"start",Oi.Ia,L);var j=Oi.M(O,"duration",Oi.Ia),K=null;if(_!=U.length-1){var B=Oi.M(U[_+1],"start",Oi.Ia);null!=B&&(K=B-L)}else null!=N&&(K=N-L);if(B=1/15,K&&j&&Math.abs(K-j)>B&&X.m("There is a gap/overlap between Periods",O),null==K&&(K=j),O=yr(e,C,R,{start:L,duration:K,node:O,hd:null==K||_==U.length-1}),D.push(O),j=C.ma.id,e.l.includes(j)||(e.l.push(j),e.c&&(e.b.filterNewPeriod(O),e.c.periods.push(O))),null==K){_!=U.length-1&&X.m("Skipping Period",_+1,"and any subsequent Periods:","Period",_+1,"does not have a valid start time.",D[_+1]),L=null;break}L+=K}if(null==e.c&&e.b.filterAllPeriods(D),null!=N?(L!=N&&X.m("@mediaPresentationDuration does not match the total duration of all","Periods."),r=D,a=N,o=!1):(r=D,a=L,o=!0),A=a,M=r,S.dc("static"==b),"static"!=b&&o||S.Ba(A||1/0),S.X()&&!isNaN(e.a.availabilityWindowOverride)&&(v=e.a.availabilityWindowOverride),null==v&&(v=1/0),S.Jd(v),S.od(y||1),e.c){i.C(0);break}if(e.c={presentationTimeline:S,periods:M,offlineSessionIds:[],minBufferTime:m||0},!S.Ie()){i.C(0);break}return I=u.U(t,"UTCTiming"),x(i,function(e,t,n){n=n.map((function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}}));var i=e.a.dash.clockSyncUri;return!n.length&&i&&n.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),Kt.Ye(n,function(e){var n=e.scheme;switch(e=e.value,n){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Er(this,t,e,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Er(this,t,e,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return n=Date.parse(e),isNaN(n)?0:n-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return X.Z("NTP UTCTiming scheme is not supported"),Promise.reject();default:return X.Z("Unrecognized scheme in UTCTiming element",n),Promise.reject()}}.bind(e)).catch((function(){return X.Z("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0}))}(e,h,I),4);case 4:if(P=i.s,!e.b)return i.return();S.De(P),k(i)}}))}))}(e,t,n)}))}(e,t.data,t.uri)})).then((function(){var n=(Date.now()-t)/1e3;return z(e.v,1,n),n}))}function yr(e,t,n,i){if(t.ma=Sr(i.node,null,n),t.W=i,t.ma.id||(X.info("No Period ID given for Period with start time "+i.start+",  Assigning a default"),t.ma.id="__shaka_period_"+i.start),Oi.U(i.node,"EventStream").forEach(e.bg.bind(e,i.start,i.duration)),n=Oi.U(i.node,"AdaptationSet").map(e.$f.bind(e,t)).filter(Kt.Na),t.tb){t=[];for(var r=d(n),a=r.next();!a.done;a=r.next())for(var o=(a=d(a.value.kg)).next();!o.done;o=a.next())t.push(o.value);if(t.length!=new Set(t).size)throw new he(2,4,4018)}var s=n.filter((function(e){return!e.Nd}));if(n.filter((function(e){return e.Nd})).forEach((function(e){var t=e.streams[0],n=e.Nd;s.forEach((function(e){e.id==n&&e.streams.forEach((function(e){e.trickModeVideo=t}))}))})),t=br(s,"video"),r=br(s,"audio"),!t.length&&!r.length)throw new he(2,4,4004);for(n=e.a.disableAudio,r.length&&!n||(r=[null]),n=e.a.disableVideo,t.length&&!n||(t=[null]),n=[],a=0;a<r.length;a++)for(o=0;o<t.length;o++)wr(e,r[a],t[o],n);if(t=[],!e.a.disableText)for(e=br(s,"text"),r=0;r<e.length;r++)t.push.apply(t,e[r].streams);return{startTime:i.start,textStreams:t,variants:n}}function br(e,t){return e.filter((function(e){return e.contentType==t}))}function wr(e,t,n,i){if(t||n)if(t&&n){var r=t.drmInfos,a=n.drmInfos;if(!r.length||!a.length||0<At(r,a).length){a=At(t.drmInfos,n.drmInfos);for(var o=0;o<t.streams.length;o++)for(var s=0;s<n.streams.length;s++)r=(n.streams[s].bandwidth||0)+(t.streams[o].bandwidth||0),r={id:e.h++,language:t.language,primary:t.jd||n.jd,audio:t.streams[o],video:n.streams[s],bandwidth:r,drmInfos:a,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}}else for(a=t||n,o=0;o<a.streams.length;o++)r=a.streams[o].bandwidth||0,r={id:e.h++,language:a.language||"und",primary:a.jd,audio:t?a.streams[o]:null,video:n?a.streams[o]:null,bandwidth:r,drmInfos:a.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}function Tr(e,t){0>e.u||e.i.R(Math.max(3,e.u-t,G(e.v)))}function Sr(e,t,n){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,qd:null,audioSamplingRate:null},n=n||t.ta;var i=Oi.Hb,r=Oi.$e,a=Oi.U(e,"BaseURL").map(Oi.qc),o=e.getAttribute("contentType")||t.contentType,s=e.getAttribute("mimeType")||t.mimeType,u=e.getAttribute("codecs")||t.codecs;r=Oi.M(e,"frameRate",r)||t.frameRate;for(var c=e.getAttribute("sar")||t.pixelAspectRatio,l=Oi.U(e,"InbandEventStream"),f=t.emsgSchemeIdUris.slice(),h=(l=d(l)).next();!h.done;h=l.next())h=h.value.getAttribute("schemeIdUri"),f.includes(h)||f.push(h);return l=function(e){for(var t=0;t<e.length;++t){var n=e[t],i=n.getAttribute("schemeIdUri");if(i&&(n=n.getAttribute("value")))switch(i){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var r=parseInt(n,10);if(!r){X.m("Channel parsing failure! Ignoring scheme and value",i,n);continue}return r;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(r=parseInt(n,16))){X.m("Channel parsing failure! Ignoring scheme and value",i,n);continue}for(e=0;r;)1&r&&++e,r>>=1;return e;default:X.m("Unrecognized audio channel scheme:",i,n)}}return null}(l=Oi.U(e,"AudioChannelConfiguration"))||t.qd,h=Oi.M(e,"audioSamplingRate",i)||t.audioSamplingRate,o||(o=xr(s,u)),{ta:Bt(n,a),ac:Oi.oc(e,"SegmentBase")||t.ac,Qa:Oi.oc(e,"SegmentList")||t.Qa,cc:Oi.oc(e,"SegmentTemplate")||t.cc,width:Oi.M(e,"width",i)||t.width,height:Oi.M(e,"height",i)||t.height,contentType:o,mimeType:s,codecs:u,frameRate:r,pixelAspectRatio:c,emsgSchemeIdUris:f,id:e.getAttribute("id"),qd:l,audioSamplingRate:h}}function Er(e,t,n,i){return(t=De(t=Bt(t,[n]),e.a.retryParameters)).method=i,t=e.b.networkingEngine.request(4,t),Pe(e.g,t),t.promise.then((function(e){if("HEAD"==i){if(!e.headers||!e.headers.date)return X.m("UTC timing response is missing","expected date header"),0;e=e.headers.date}else e=rt(e.data);return e=Date.parse(e),isNaN(e)?(X.m("Unable to parse date from UTC timing response"),0):e-Date.now()}))}function xr(e,t){return dn(Ge(e,t))?"text":e.split("/")[0]}function kr(e,t,n,i){this.b=e,this.type=t,this.a=n,this.segments=i||null}function Ar(e,t,n,i){this.id=e,this.name=t,this.a=n,this.value=void 0===i?null:i}function Mr(e,t){this.name=e,this.value=t}function Ir(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function Pr(e,t){this.b=t,this.a=e}H("shaka.media.ManifestParser.registerParserByExtension",hr.zd),hr.Lb=function(e,t){hr.Ib[e]=t},H("shaka.media.ManifestParser.registerParserByMime",hr.Lb),hr.eg=function(){var e={};if(Ye()){for(var t in hr.Ib)e[t]=!0;for(var n in hr.Zb)e[n]=!0}t={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var i=(n=d(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!i.done;i=n.next())e[i=i.value]=Ye()?!!hr.Ib[i]:$e(i);for(var r in t)e[r]=Ye()?!!hr.Zb[r]:$e(t[r]);return e},hr.create=function(e,t,n,i){return p((function r(){var a,o;return _(r,(function(r){switch(r.j){case 1:return A(r,2),x(r,hr.hf(e,t,n,i),4);case 4:return a=r.s,r.return(new a);case 2:throw(o=P(r)).severity=2,o}}))}))},hr.hf=function(e,t,n,i){return p((function r(){var a,o,s,u,c;return _(r,(function(r){switch(r.j){case 1:if(a=hr,i){if(o=a.Ib[i.toLowerCase()])return r.return(o);X.m("Could not determine manifest type using MIME type ",i)}if(s=a.getExtension(e)){if(u=a.Zb[s])return r.return(u);X.m("Could not determine manifest type for extension ",s)}else X.m("Could not find extension for ",e);if(i){r.C(2);break}return x(r,a.rf(e,t,n),3);case 3:if(i=r.s){if(c=hr.Ib[i])return r.return(c);X.m("Could not determine manifest type using MIME type",i)}case 2:throw new he(2,4,4e3,e)}}))}))},hr.rf=function(e,t,n){return p((function i(){var r,a,o;return _(i,(function(i){switch(i.j){case 1:return(r=De([e],n)).method="HEAD",x(i,t.request(0,r).promise,2);case 2:return a=i.s,o=a.headers["content-type"],i.return(o?o.toLowerCase().split(";").shift():"")}}))}))},hr.getExtension=function(e){return 1==(e=new $(e).la.split("/").pop().split(".")).length?"":e.pop().toLowerCase()},hr.isSupported=function(e,t){return!!Ye()&&(t in hr.Ib||hr.getExtension(e)in hr.Zb)},H("shaka.media.PresentationTimeline",pr),pr.prototype.ca=function(){return this.g},pr.prototype.getDuration=pr.prototype.ca,pr.prototype.pf=function(){return this.a},pr.prototype.getMaxSegmentDuration=pr.prototype.pf,pr.prototype.Ba=function(e){this.g=e},pr.prototype.setDuration=pr.prototype.Ba,pr.prototype.xf=function(){return this.f},pr.prototype.getPresentationStartTime=pr.prototype.xf,pr.prototype.De=function(e){this.l=e},pr.prototype.setClockOffset=pr.prototype.De,pr.prototype.dc=function(e){this.o=e},pr.prototype.setStatic=pr.prototype.dc,pr.prototype.Jd=function(e){this.h=e},pr.prototype.setSegmentAvailabilityDuration=pr.prototype.Jd,pr.prototype.sg=function(e){this.Dc=e},pr.prototype.setDelay=pr.prototype.sg,pr.prototype.ff=function(){return this.Dc},pr.prototype.getDelay=pr.prototype.ff,pr.prototype.Eb=function(e,t){if(0!=e.length){var n=e[e.length-1].endTime+t;this.pd(e[0].startTime+t),this.a=e.reduce((function(e,t){return Math.max(e,t.endTime-t.startTime)}),this.a),this.b=Math.max(this.b,n),null!=this.f&&this.u&&(this.f=(Date.now()+this.l)/1e3-this.b-this.a),X.D("notifySegments:","maxSegmentDuration="+this.a)}},pr.prototype.notifySegments=pr.prototype.Eb,pr.prototype.pd=function(e){this.c=null==this.c?e:Math.min(this.c,e)},pr.prototype.notifyMinSegmentStartTime=pr.prototype.pd,pr.prototype.od=function(e){this.a=Math.max(this.a,e),X.D("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)},pr.prototype.notifyMaxSegmentDuration=pr.prototype.od,pr.prototype.offset=function(e){null!=this.c&&(this.c+=e),null!=this.b&&(this.b+=e)},pr.prototype.offset=pr.prototype.offset,pr.prototype.X=function(){return 1/0==this.g&&!this.o},pr.prototype.isLive=pr.prototype.X,pr.prototype.bb=function(){return 1/0!=this.g&&!this.o},pr.prototype.isInProgress=pr.prototype.bb,pr.prototype.Wb=function(){if(1/0==this.h)return this.i;var e=this.xb()-this.h;return Math.max(this.i,e)},pr.prototype.getSegmentAvailabilityStart=pr.prototype.Wb,pr.prototype.Ee=function(e){this.i=e},pr.prototype.setUserSeekStart=pr.prototype.Ee,pr.prototype.xb=function(){return this.X()||this.bb()?Math.min(Math.max(0,(Date.now()+this.l)/1e3-this.a-this.f),this.g):this.g},pr.prototype.getSegmentAvailabilityEnd=pr.prototype.xb,pr.prototype.Vb=function(e){var t=Math.max(this.c,this.i);if(1/0==this.h)return t;var n=this.xb()-this.h;return e=Math.min(n+e,this.Ga()),Math.max(t,e)},pr.prototype.getSafeSeekRangeStart=pr.prototype.Vb,pr.prototype.wb=function(){return this.Vb(0)},pr.prototype.getSeekRangeStart=pr.prototype.wb,pr.prototype.Ga=function(){var e=this.X()||this.bb()?this.Dc:0;return Math.max(0,this.xb()-e)},pr.prototype.getSeekRangeEnd=pr.prototype.Ga,pr.prototype.Ie=function(){return!(null==this.f||null!=this.b&&this.u)},pr.prototype.usingPresentationStartTime=pr.prototype.Ie,H("shaka.dash.DashParser",gr),(i=gr.prototype).configure=function(e){this.a=e},i.start=function(e,t){var n=this;return p((function i(){var r;return _(i,(function(i){switch(i.j){case 1:return n.f=[e],n.b=t,x(i,vr(n),2);case 2:if(r=i.s,n.b&&Tr(n,r),!n.b)throw new he(2,7,7001);return i.return(n.c)}}))}))},i.stop=function(){return this.a=this.b=null,this.f=[],this.c=null,this.l=[],this.o={},null!=this.i&&(this.i.stop(),this.i=null),this.g.destroy()},i.update=function(){vr(this).catch(function(e){this.b&&this.b.onError(e)}.bind(this))},i.onExpirationUpdated=function(){},i.$f=function(e,t){if(e.aa=Sr(t,e.ma,null),"image"==e.aa.contentType)return X.m("Skipping Image AdaptationSet",e.aa),null;var n=!1,i=Oi.U(t,"Role"),r=i.map((function(e){return e.getAttribute("value")})).filter(Kt.Na),a=void 0,o="text"==e.aa.contentType;o&&(a="subtitle");for(var s=0;s<i.length;s++){var u=i[s].getAttribute("schemeIdUri");if(null==u||"urn:mpeg:dash:role:2011"==u)switch(u=i[s].getAttribute("value"),u){case"main":n=!0;break;case"caption":case"subtitle":a=u}}var c=null,l=!1;Oi.U(t,"EssentialProperty").forEach((function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?c=e.getAttribute("value"):l=!0})),s=Oi.U(t,"Accessibility");var f=new Map;for(i={},u=(s=d(s)).next();!u.done;i={Rb:i.Rb},u=s.next()){var h=u.value;u=h.getAttribute("schemeIdUri"),h=h.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==u||"urn:scte:dash:cc:cea-708:2015"==u?(i.Rb=1,null!=h?h.split(";").forEach(function(e){return function(t){if(t.includes("=")){var n=(t=t.split("="))[0].startsWith("CC")?t[0]:"CC"+t[0];t=t[1].split(",")[0].split(":").pop()}else n="CC"+e.Rb,e.Rb+=2;f.set(n,Rn(t))}}(i)):f.set("CC1","und")):"urn:mpeg:dash:role:2011"==u&&null!=h&&(r.push(h),"captions"==h&&(a="caption"))}if(l)return null;var p=Ki(i=Oi.U(t,"ContentProtection"),this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);if(i=Rn(t.getAttribute("lang")||"und"),s=t.getAttribute("label"),(u=Oi.U(t,"Label"))&&u.length&&((u=u[0]).textContent&&(s=u.textContent)),0==(r=(u=Oi.U(t,"Representation")).map(this.cg.bind(this,e,p,a,i,s,n,r,f)).filter((function(e){return!!e}))).length){if(this.a.dash.ignoreEmptyAdaptationSet||o)return null;throw new he(2,4,4003)}return e.aa.contentType&&"application"!=e.aa.contentType||(e.aa.contentType=xr(r[0].mimeType,r[0].codecs),r.forEach((function(t){t.type=e.aa.contentType}))),r.forEach((function(e){p.drmInfos.forEach((function(t){e.keyId&&t.keyIds.push(e.keyId)}))})),o=u.map((function(e){return e.getAttribute("id")})).filter(Kt.Na),{id:e.aa.id||"__fake__"+this.h++,contentType:e.aa.contentType,language:i,jd:n,streams:r,drmInfos:p.drmInfos,Nd:c,kg:o}},i.cg=function(e,t,n,i,r,a,o,s,u){if(e.A=Sr(u,e.aa,null),!function(e){var t=e.ac?1:0;if(t+=e.Qa?1:0,0==(t+=e.cc?1:0))return"text"==e.contentType||"application"==e.contentType||(X.m("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',e),!1);return 1!=t&&(X.m("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",e),e.ac?(X.info("Using SegmentBase by default."),e.Qa=null):X.info("Using SegmentList by default."),e.cc=null),!0}(e.A))return X.m("Skipping Representation",e.A),null;e.bandwidth=Oi.M(u,"bandwidth",Oi.Bc)||0;var c=e.A.contentType;c="text"==c||"application"==c;try{var l=this.lg.bind(this);if(e.A.ac)var f=function(e,t){var n=Number(zi(e,ur,"presentationTimeOffset"))||0,i=zi(e,ur,"timescale"),r=1;i&&(r=Oi.Bc(i)||1),n=n/r||0,i=or(e,ur);var a=e.A.contentType;if(r=e.A.mimeType.split("/")[1],"text"!=a&&"mp4"!=r&&"webm"!=r)throw X.error("SegmentBase specifies an unsupported container type.",e.A),new he(2,4,4006);if("webm"==r&&!i)throw X.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",e.A),new he(2,4,4005);a=Gi(e,ur,"RepresentationIndex");var o=zi(e,ur,"indexRange"),s=e.A.ta;if(o=Oi.Cc(o||""),a){var u=a.getAttribute("sourceURL");u&&(s=Bt(e.A.ta,[u])),o=Oi.M(a,"range",Oi.Cc,o)}if(!o)throw X.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",e.A),new he(2,4,4002);return{createSegmentIndex:(r=sr(e,t,i,s,o.start,o.end,r,n)).createSegmentIndex,findSegmentPosition:r.findSegmentPosition,getSegmentReference:r.getSegmentReference,initSegmentReference:i,oa:n}}(e,l);else if(e.A.Qa)f=cr(e,this.o);else if(e.A.cc)f=fr(e,l,this.o,!!this.c);else{var d=e.A.ta,h=e.W.duration||0;f={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<h?1:null},getSegmentReference:function(e){return 1!=e?null:new Yi(1,0,h,(function(){return d}),0,null)},initSegmentReference:null,oa:0}}}catch(e){if(c&&4002==e.code)return null;throw e}return u=function(e,t,n,i){var r=Ki(e,t,i);if(n.be)e=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,t=0==r.drmInfos.length,(0==n.drmInfos.length||e&&!t)&&(n.drmInfos=r.drmInfos),n.be=!1;else if(0<r.drmInfos.length&&(n.drmInfos=n.drmInfos.filter((function(e){return r.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==n.drmInfos.length))throw new he(2,4,4008);return r.Xd||n.Xd}(u=Oi.U(u,"ContentProtection"),this.a.dash.customScheme,t,this.a.dash.ignoreDrmInfo),{id:this.h++,originalId:e.A.id,createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,initSegmentReference:f.initSegmentReference,presentationTimeOffset:f.oa,mimeType:e.A.mimeType,codecs:e.A.codecs,frameRate:e.A.frameRate,pixelAspectRatio:e.A.pixelAspectRatio,bandwidth:e.bandwidth,width:e.A.width,height:e.A.height,kind:n,encrypted:0<t.drmInfos.length,keyId:u,language:i,label:r,type:e.aa.contentType,primary:a,trickModeVideo:null,emsgSchemeIdUris:e.A.emsgSchemeIdUris,roles:o,channelsCount:e.A.qd,audioSamplingRate:e.A.audioSamplingRate,closedCaptions:s}},i.bg=function(e,t,n){var i=Oi.Hb,r=n.getAttribute("schemeIdUri")||"",a=n.getAttribute("value")||"",o=Oi.M(n,"timescale",i)||1;Oi.U(n,"Event").forEach(function(n){var s=Oi.M(n,"presentationTime",i)||0,u=Oi.M(n,"duration",i)||0;u=(s=s/o+e)+u/o,null!=t&&(s=Math.min(s,e+t),u=Math.min(u,e+t)),n={schemeIdUri:r,value:a,startTime:s,endTime:u,id:n.getAttribute("id")||"",eventElement:n},this.b.onTimelineRegionAdded(n)}.bind(this))},i.lg=function(e,t,n){return e=mr(e,t,n,this.a.retryParameters),e=this.b.networkingEngine.request(1,e),Pe(this.g,e),e.promise.then((function(e){return e.data}))},hr.zd("mpd",gr),hr.Lb("application/dash+xml",gr),hr.Lb("video/vnd.mpeg.dash.mpd",gr),Ar.prototype.toString=function(){var e="#"+this.name,t=this.a?this.a.map((function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)})):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},Ar.prototype.getAttribute=function(e){var t=this.a.filter((function(t){return t.name==e}));return t.length?t[0]:null};var Cr={ub:function(e,t){return e.filter((function(e){return e.name==t}))},Ya:function(e,t){var n=Cr.ub(e,t);return n.length?n[0]:null},Xc:function(e,t,n){return e.filter((function(e){var i=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),i.value==t&&e.value==n}))},Pc:function(e,t){return Bt([e],[t])[0]},gd:function(e){return/^#(?!EXT)/m.test(e)}};function Rr(e){this.b=e,this.a=0}function Nr(e){Dr(e,/[ \t]+/gm)}function Dr(e,t){t.lastIndex=e.a;var n=t.exec(e.b);return n=null==n?null:{position:n.index,length:n[0].length,ng:n},e.a==e.b.length||null==n||n.position!=e.a?null:(e.a+=n.length,n.ng)}function Lr(e){return e.a==e.b.length?null:(e=Dr(e,/[^ \t\n]*/gm))?e[0]:null}function Ur(){this.a=0}function _r(e,t,n){var i=(t=(t=rt(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(i[0]))throw new he(2,4,4015);t=0;for(var r=1;r<i.length;r++)if(!Cr.gd(i[r])){var a=jr(e,i[r]);if(--e.a,Kr.includes(a.name)){t=1;break}"EXT-X-STREAM-INF"==a.name&&(r+=1)}for(r=[],a=1;a<i.length;)if(Cr.gd(i[a]))a+=1;else{var o=jr(e,i[a]);if(Br.includes(o.name)){if(1!=t)throw new he(2,4,4017);return new kr(n,t,r,e=Or(e,n,i=i.splice(a,i.length-a),r))}r.push(o),a+=1,"EXT-X-STREAM-INF"==o.name&&(o.a.push(new Mr("URI",i[a])),a+=1)}return new kr(n,t,r)}function Or(e,t,n,i){var r=[],a=[];return n.forEach((function(n){if(/^(#EXT)/.test(n))n=jr(e,n),Kr.includes(n.name)?i.push(n):a.push(n);else{if(Cr.gd(n))return[];n=Cr.Pc(t,n.trim()),r.push(new Pr(n,a)),a=[]}})),r}function jr(e,t){var n=e.a++,i=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!i)throw new he(2,4,4016,t);var r,a=i[1],o=i[2];if(i=[],o){var s;(s=Dr(o=new Rr(o),/^([^,=]+)(?:,|$)/g))&&(r=s[1]);for(var u=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;s=Dr(o,u);)i.push(new Mr(s[1],s[2]||s[3]))}return new Ar(n,a,i,r)}var Kr="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Br="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Fr(e){try{var t=Fr.parse(e);return ye({uri:e,vd:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return ge(e)}}function Hr(){var e=this;this.a=this.f=null,this.ea=1,this.G=new Map,this.V=new Set,this.b=new Map,this.c=null,this.v="",this.u=new Ur,this.T=0,this.h=new le((function(){!function(e){p((function t(){var n,i;return _(t,(function(t){switch(t.j){case 1:return X.info("Updating manifest..."),e.f?(A(t,2),x(t,e.update(),4)):t.return();case 4:n=e.T,e.h.R(n),I(t,0);break;case 2:if(i=P(t),!e.f)return t.return();i.severity=1,e.f.onError(i),e.h.R(.1),k(t)}}))}))}(e)})),this.g=ua,this.o=null,this.F=0,this.H=1/0,this.i=new Ie,this.K=[],this.l=new Map,this.$=!1}function Vr(e,t){return p((function n(){var i,r,a,o,s,u,c,l,f,d;return _(n,(function(n){switch(n.j){case 1:return i=Cr,r=ca,a=t.Qe,x(n,oa(e,De([a],e.a.retryParameters),0),2);case 2:if(o=n.s,1!=(s=_r(e.u,o.data,o.uri)).type)throw new he(2,4,4017);return c=(u=i.Ya(s.a,"EXT-X-MEDIA-SEQUENCE"))?Number(u.value):0,l=t.stream,x(n,Jr(e,t.Jc,s,c,l.mimeType,l.codecs),3);case 3:f=n.s,t.bc.a=f,d=f[f.length-1],i.Ya(s.a,"EXT-X-ENDLIST")&&(aa(e,r.Va),e.c.Ba(d.endTime)),k(n)}}))}))}function qr(e){e.forEach((function(e){if(e){var t=e.stream.codecs.split(",");t=t.filter((function(e){return"mp4a.40.34"!=e})),e.stream.codecs=t.join(",")}}))}function zr(e,t,n,i,r){return{id:e.ea++,language:t?t.language:"und",primary:!!t&&t.primary||!!n&&n.primary,audio:t,video:n,bandwidth:i,drmInfos:r,allowedByApplication:!0,allowedByKeySystem:!0}}function Gr(e,t,n){return p((function i(){var r,a,o,s,u,c,l,f,d,h,p;return _(i,(function(i){switch(i.j){case 1:if(r=ea(t,"URI"),e.b.has(r))return i.return(e.b.get(r));if(a=ea(t,"TYPE").toLowerCase(),o=Ht,"subtitles"==a&&(a=o.va),s=Rn(Ir(t,"LANGUAGE","und")),u=Ir(t,"NAME"),c=t.getAttribute("DEFAULT"),l="YES"==c,f=Ir(t,"CHANNELS"),"audio"==a)if(f){var m=f.split("/")[0];m=parseInt(m,10)}else m=null;else m=null;return d=m,h=Ir(t,"CHARACTERISTICS"),x(i,Wr(e,r,n,a,s,l,u,d,null,h),2);case 2:return p=i.s,e.b.has(r)?i.return(e.b.get(r)):null==p?i.return(null):(e.G.set(t.id,p),e.b.set(r,p),i.return(p))}}))}))}function Wr(e,t,n,i,r,a,o,s,u,c){return p((function l(){var f,h,m,g,v,y,b,w,T,S,E,k,M,C,R,N,D,L,U,O,j,K,B,F,H,V,q;return _(l,(function(l){switch(l.j){case 1:return h=(f=Cr).Pc(e.v,t),x(l,oa(e,De([h],e.a.retryParameters),0),2);case 2:if(m=l.s,h=m.uri,1!=(g=_r(e.u,m.data,h)).type)throw new he(2,4,4017);v=[],g.segments.forEach((function(e){e=f.ub(e.b,"EXT-X-KEY"),v.push.apply(v,e)})),y=!1,b=[],w=null;for(var z=d(v),G=z.next();!G.done;G=z.next())if(T=G.value,"NONE"!=(S=ea(T,"METHOD"))){if(y=!0,"AES-128"==S)return X.m("Unsupported HLS Encryption",S),e.$=!0,l.return(null);E=ea(T,"KEYFORMAT"),(M=(k=sa[E])?k(T):null)?(M.keyIds.length&&(w=M.keyIds[0]),b.push(M)):X.m("Unsupported HLS KEYFORMAT",E)}if(y&&!b.length)throw new he(2,4,4026);return function(e,t){var n=ca,i=Cr.Ya(t.a,"EXT-X-PLAYLIST-TYPE"),r=Cr.Ya(t.a,"EXT-X-ENDLIST");r=i&&"VOD"==i.value||r,i=i&&"EVENT"==i.value&&!r,i=!r&&!i,r?aa(e,n.Va):(aa(e,i?n.Rd:n.Le),n=ta(t.a,"EXT-X-TARGETDURATION"),n=Number(n.value),e.F=Math.max(n,e.F),e.H=Math.min(n,e.H))}(e,g),C=function(e,t){if(1==t.length)return t[0];var n=Zr(e,t);if(null!=n)return n;throw new he(2,4,4025,t)}(i,n),x(l,function(e,t,n,i){return p((function r(){var a,o,s,u,c,l,f,d,h;return _(r,(function(r){switch(r.j){case 1:return a=Ht,o=i.segments[0].a,s=new $(o),u=s.la.split(".").pop(),c=ra[t],(l=c[u])?r.return(l):t==a.va?n&&"vtt"!=n&&"wvtt"!=n?r.return("application/mp4"):r.return("text/vtt"):((f=De([o],e.a.retryParameters)).method="HEAD",x(r,oa(e,f,1),2));case 2:if(d=r.s,!(h=d.headers["content-type"]))throw new he(2,4,4021,u);return r.return(h.split(";")[0])}}))}))}(e,i,C,g),3);case 3:return R=l.s,ia.includes(R)&&(C=""),D=(N=f.Ya(g.a,"EXT-X-MEDIA-SEQUENCE"))?Number(N.value):0,A(l,4),x(l,Jr(e,t,g,D,R,C),6);case 6:L=l.s,I(l,5);break;case 4:if(4035==(U=P(l)).code)return X.Z("Skipping unsupported HLS stream",R,t),l.return(null);throw U;case 5:return O=L[0].startTime,j=L[L.length-1].endTime,K=j-O,B=new Ji(L),F=Xr(g),H=void 0,"text"==i&&(H="subtitle"),V=[],c&&V.push(c),q={id:e.ea++,originalId:o,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:B.find.bind(B),getSegmentReference:B.get.bind(B),initSegmentReference:F,presentationTimeOffset:0,mimeType:R,codecs:C,kind:H,encrypted:y,keyId:w,language:r,label:o,type:i,primary:a,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:V,channelsCount:s,audioSamplingRate:null,closedCaptions:u},l.return({stream:q,bc:B,drmInfos:b,Jc:t,Qe:h,nd:O,Qg:j,duration:K})}}))}))}function Xr(e){var t=Cr.ub(e.a,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new he(2,4,4020);var n=ea(t=t[0],"URI"),i=Cr.Pc(e.b,n);return e=0,n=null,(t=Ir(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),n=(e=Number(e[1]))+t-1),new Xi((function(){return[i]}),e,n)}function Yr(e,t,n,i){var r=t.b,a=t.a;t=ta(r,"EXTINF").value.split(","),t=i+Number(t[0]);var o=0,s=null;return(r=Cr.Ya(r,"EXT-X-BYTERANGE"))&&(o=r.value.split("@"),r=Number(o[0]),s=(o=o[1]?Number(o[1]):e.a+1)+r-1),new Yi(n,i,t,(function(){return[a]}),o,s)}function $r(e){e.c&&(e.K.forEach((function(t){e.c.Eb(t,0)})),e.K=[])}function Jr(e,t,n,i,r,a){return p((function o(){var s,u,c,l,f,d,h,m,g,v;return _(o,(function(o){switch(o.j){case 1:return s=n.segments,u=[],c=s[0].a,l=Yr(null,s[0],i,0),f=Xr(n),x(o,function(e,t,n,i,r,a){return p((function o(){var s,u,c,l,f,d,h,p,m;return _(o,(function(o){switch(o.j){case 1:if(e.o){if(s=e.b.get(t),u=s.bc,c=u.get(i.position))return X.D("Found segment start time in previous manifest"),o.return(c.startTime);X.debug("Unable to find segment start time in previous manifest!")}if(X.D("Fetching segment to find start time"),r=r.toLowerCase(),ia.includes(r))throw X.Z("Raw formats are not yet supported.  Skipping "+r),new he(1,4,4035);if("video/webm"==r)throw X.Z("WebM in HLS is not yet supported.  Skipping."),new he(1,4,4035);if("video/mp4"!=r&&"audio/mp4"!=r){o.C(2);break}return l=[Qr(e,i)],n&&l.push(Qr(e,n)),x(o,Promise.all(l),3);case 3:return f=o.s,d=f[0],h=f[1]||f[0],o.return(function(e,t,n,i){var r=0;if((new Ci).L("moov",Ri).L("trak",Ri).L("mdia",Ri).ia("mdhd",(function(e){e.reader.P(0==e.version?8:16),r=e.reader.I(),e.parser.stop()})).parse(i,!0),!r)throw X.error("Unable to find timescale in init segment!"),new he(2,4,4030,e,t);var a=0,o=!1;if((new Ci).L("moof",Ri).L("traf",Ri).ia("tfdt",(function(e){a=(0==e.version?e.reader.I():e.reader.Kb())/r,o=!0,e.parser.stop()})).parse(n,!0),!o)throw new he(2,4,4030,e,t);return a}(t,d.uri,d.data,h.data));case 2:if("video/mp2t"!=r){o.C(4);break}return x(o,Qr(e,i),5);case 5:return p=o.s,o.return(function(e,t,n){function i(){a.seek(o+188),71!=(s=a.na())&&(a.seek(o+192),s=a.na()),71!=s&&(a.seek(o+204),s=a.na()),71!=s&&r(),a.ze(1)}function r(){throw new he(2,4,4030,e,t)}for(var a=new Mi(new DataView(n),0),o=0,s=0;;)if(o=a.ga(),71!=(s=a.na())&&r(),8191==(8191&(n=a.$b())))i();else if(16384&n){if(0!=(n=(48&a.na())>>4)&&2!=n||r(),3==n&&(n=a.na(),a.P(n)),1==a.I()>>8){a.P(3),0!=(n=a.na()>>6)&&1!=n||r(),0==a.na()&&r(),n=a.na();var u=a.$b(),c=a.$b();return(1073741824*((14&n)>>1)+((65534&u)<<14|(65534&c)>>1))/9e4}i()}else i()}(t,p.uri,p.data));case 4:if("application/mp4"!=r&&!r.startsWith("text/")){o.C(6);break}return x(o,Qr(e,i),7);case 7:return m=o.s,o.return(function(e,t,n){return dn(e=Ge(e,t))?(hn(t=new ln(null),e),t.sc(n)):0}(r,a,m.data));case 6:throw new he(2,4,4030,t)}}))}))}(e,t,f,l,r,a),2);case 2:d=o.s,X.debug("First segment",c.split("/").pop(),"starts at",d);for(var y=0;y<s.length;++y)h=s[y],m=u[u.length-1],g=0==y?d:m.endTime,v=Yr(m,h,i+y,g),u.push(v);return e.K.push(u),$r(e),o.return(u)}}))}))}function Qr(e,t){return p((function n(){var i,r,a,o,s,u;return _(n,(function(n){switch(n.j){case 1:return i=1,r=mr(t.c(),t.b,t.b+2048-1,e.a.retryParameters),a=mr(t.c(),t.b,t.a,e.a.retryParameters),e.a.hls.useFullSegmentsForStartTime?n.return(oa(e,a,i)):(A(n,2),x(n,oa(e,r,i),4));case 4:return o=n.s,n.return(o);case 2:if(7001==(s=P(n)).code)throw s;return X.Z("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",r.uris[0]),x(n,oa(e,a,i),5);case 5:return u=n.s,n.return(u)}}))}))}function Zr(e,t){for(var n=na[e],i=0;i<n.length;i++)for(var r=0;r<t.length;r++)if(n[i].test(t[r].trim()))return t[r].trim();return"text"==e?"":null}function ea(e,t){var n=e.getAttribute(t);if(!n)throw new he(2,4,4023,t);return n.value}function ta(e,t){var n=Cr.Ya(e,t);if(!n)throw new he(2,4,4024,t);return n}H("shaka.net.DataUriPlugin",Fr),Fr.parse=function(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw X.error("Bad data URI, failed to parse scheme"),new he(2,1,1004,t);if(2>(n=n.slice(1).join(":").split(",")).length)throw X.error("Bad data URI, failed to extract encoding and MIME type"),new he(2,1,1004,t);var i=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=i.split(";"),i=n[0];var r=!1;return 1<n.length&&"base64"==n[n.length-1]&&(r=!0,n.pop()),{data:r?ft.Fa(t).buffer:st(t),contentType:i}},Ne("data",Fr),H("shaka.hls.HlsParser",Hr),(i=Hr.prototype).configure=function(e){this.a=e},i.start=function(e,t){var n=this;return p((function i(){var r,a;return _(i,(function(i){switch(i.j){case 1:return n.f=t,x(i,oa(n,De([e],n.a.retryParameters),0),2);case 2:return r=i.s,n.v=r.uri,x(i,function(e,t){return p((function n(){var i,r,a,o,s,u,c,l,f,h,m;return _(n,(function(n){switch(n.j){case 1:if(0!=(i=_r(e.u,t,e.v)).type)throw new he(2,4,4022);return x(n,function(e,t){return p((function n(){var i,r,a,o,s,u,c,l,f,h,m,g;return _(n,(function(n){switch(n.j){case 1:return i=Cr,r=Kt,a=t.a,o=i.ub(t.a,"EXT-X-MEDIA"),s=o.filter(function(e){return"SUBTITLES"==ea(e,"TYPE")}.bind(e)),u=s.map(function(e){var t=this;return p((function n(){var i;return _(n,(function(n){switch(n.j){case 1:return t.a.disableText?n.return(null):(A(n,2),x(n,function(e,t){return p((function n(){var i;return _(n,(function(n){switch(n.j){case 1:return ea(t,"TYPE"),x(n,Gr(e,t,[]),2);case 2:return i=n.s,n.return(i.stream)}}))}))}(t,e),4));case 4:return n.return(n.s);case 2:if(i=P(n),t.a.hls.ignoreTextStreamFailures)return n.return(null);throw i}}))}))}.bind(e)),c=o.filter((function(e){return"CLOSED-CAPTIONS"==ea(e,"TYPE")})),function(e,t){for(var n=d(t),i=n.next();!i.done;i=n.next()){ea(i=i.value,"TYPE");var r=Ir(i,"LANGUAGE")||"und";r=Rn(r);var a=ea(i,"GROUP-ID");i=ea(i,"INSTREAM-ID"),e.l.get(a)||e.l.set(a,new Map),e.l.get(a).set(i,r)}}(e,c),x(n,Promise.all(u),2);case 2:return l=n.s,f=i.ub(a,"EXT-X-STREAM-INF"),h=f.map(function(e){return function(e,t,n){return p((function i(){var r,a,o,s,u,c,l,f,h,m,g,v,y,b,w,T,S,E,k,A,M,I,P,C,R,N,D,L,U;return _(i,(function(i){switch(i.j){case 1:return r=Ht,a=Cr,o=[],e.a.disableVideo||o.push("avc1.42E01E"),e.a.disableAudio||o.push("mp4a.40.2"),s=o.join(","),u=Ir(t,"CODECS",s),c=function(e){for(var t=new Set,n=[],i=(e=d(e)).next();!i.done;i=e.next()){var r=We(i=i.value)[0];t.has(r)?X.debug("Ignoring duplicate codec"):(n.push(i),t.add(r))}return n}(u.split(/\s*,\s*/)),l=t.getAttribute("RESOLUTION"),h=f=null,m=Ir(t,"FRAME-RATE"),g=Number(ea(t,"BANDWIDTH")),l&&(v=l.value.split("x"),f=v[0],h=v[1]),y=(y=(y=a.ub(n.a,"EXT-X-MEDIA")).filter((function(e){return"CLOSED-CAPTIONS"!=ea(e,"TYPE")}))).filter((function(e){var t=Ir(e,"URI")||"";return"SUBTITLES"==(Ir(e,"TYPE")||"")||""!=t})),b=Ir(t,"AUDIO"),w=Ir(t,"VIDEO"),b?y=a.Xc(y,"AUDIO",b):w&&(y=a.Xc(y,"VIDEO",w)),(T=Zr(r.va,c))&&((S=Ir(t,"SUBTITLES"))&&((E=a.Xc(y,"SUBTITLES",S)).length&&(k=e.G.get(E[0].id))&&(k.stream.codecs=T)),Ae(c,T)),A=y.map(function(e){return Gr(this,e,c)}.bind(e)),M=[],I=[],x(i,Promise.all(A),2);case 2:if(C=(C=i.s).filter((function(e){return null!=e})),b?M=C:w&&(I=C),X.debug("Guessing stream type for",t.toString()),N=!1,M.length||I.length?M.length?(L=ea(t,"URI"),U=M[0].Jc,L==U?(X.debug("Guessing audio-only."),R=r.Nb,N=!0):(X.debug("Guessing video."),R=r.Ua)):(X.debug("Guessing audio."),R=r.Nb):1==c.length?(D=Zr(r.Ua,c),l||m||D?(X.debug("Guessing video-only."),R=r.Ua):(X.debug("Guessing audio-only."),R=r.Nb)):(X.debug("Guessing multiplexed audio+video."),R=r.Ua,c=[c.join(",")]),N){i.C(3);break}return x(i,function(e,t,n,i){return p((function r(){var a,o,s,u,c;return _(r,(function(r){switch(r.j){case 1:return a=Ht,o=ea(t,"URI"),e.b.has(o)?r.return(e.b.get(o)):(s=Ir(t,"CLOSED-CAPTIONS"),u=null,i==a.Ua&&s&&"NONE"!=s&&(u=e.l.get(s)),x(r,Wr(e,o,n,i,"und",!1,null,null,u,null),2));case 2:return null==(c=r.s)?r.return(null):e.b.has(o)?r.return(e.b.get(o)):(e.b.set(o,c),r.return(c))}}))}))}(e,t,c,R),4);case 4:P=i.s;case 3:if(P)P.stream.type==r.Nb?M=[P]:I=[P];else if(null===P)return X.debug("streamInfo is null"),i.return([]);return I&&qr(I),M&&qr(M),i.return(function(e,t,n,i,r,a,o){n.forEach(function(e){(e=e.stream)&&(e.width=Number(r)||void 0,e.height=Number(a)||void 0,e.frameRate=Number(o)||void 0)}.bind(e));var s=!!e.a&&e.a.disableAudio;t.length&&!s||(t=[null]);s=!!e.a&&e.a.disableVideo,(!n.length||s)&&(n=[null]);s=[];for(var u=(t=d(t)).next();!u.done;u=t.next()){u=u.value;for(var c=d(n),l=c.next();!l.done;l=c.next()){var f=l.value;l=u?u.stream:null;var h=f?f.stream:null,p=u?u.drmInfos:null,m=f?f.drmInfos:null;f=(f?f.Jc:"")+" - "+(u?u.Jc:"");var g=void 0;if(l&&h){if(p.length&&m.length&&!(0<At(p,m).length)){X.m("Incompatible DRM info in HLS variant.  Skipping.");continue}g=At(p,m)}else l?g=p:h&&(g=m);e.V.has(f)?X.debug("Skipping variant which only differs in text streams."):(l=zr(e,l,h,i,g),s.push(l),e.V.add(f))}}return s}(e,M,I,g,f,h,m))}}))}))}(this,e,t)}.bind(e)),x(n,Promise.all(h),3);case 3:return m=n.s,g=(g=m.reduce(r.Oc,[])).filter((function(e){return null!=e})),n.return({startTime:0,variants:g,textStreams:l.filter((function(e){return null!=e}))})}}))}))}(e,i),2);case 2:if(r=n.s,!e.f)throw new he(2,7,7001);if(e.$&&0==r.variants.length)throw X.info("No stream is created, because we don't support AES-128","encryption yet"),new he(2,4,4034);e.f.filterAllPeriods([r]),a=1/0,o=0,s=1/0;for(var g=d(e.b.values()),v=g.next();!v.done;v=g.next())u=v.value,a=Math.min(a,u.nd),o=Math.max(o,u.nd),"text"!=u.stream.type&&(s=Math.min(s,u.duration));if(e.g!=ca.Va?(e.c=new pr(0,3*e.F),e.c.dc(!1)):(e.c=new pr(null,0),e.c.dc(!0)),$r(e),e.g!=ca.Va){for(e.T=e.H,c=ca,e.g==c.Rd&&(l=e.c.Dc,isNaN(e.a.availabilityWindowOverride)||(l=e.a.availabilityWindowOverride),e.c.Jd(l)),f=0;95443.7176888889<=o;)f+=95443.7176888889,o-=95443.7176888889;if(f)for(X.debug("Offsetting live streams by",f,"to compensate for rollover"),v=(g=d(e.b.values())).next();!v.done;v=g.next())95443.7176888889>(h=v.value).nd?(X.D("Offset applied to",h.stream.type),h.stream.presentationTimeOffset=-f,h.bc.offset(f)):X.D("Offset NOT applied to",h.stream.type)}else for(e.c.Ba(s),e.c.offset(-a),v=(g=d(e.b.values())).next();!v.done;v=g.next())(m=v.value).stream.presentationTimeOffset=a,m.bc.offset(-a),Qi(m.bc,s);e.o={presentationTimeline:e.c,periods:[r],offlineSessionIds:[],minBufferTime:0},k(n)}}))}))}(n,r.data),3);case 3:return 0<(a=n.T)&&n.h.R(a),i.return(n.o)}}))}))},i.stop=function(){this.h&&(this.h.stop(),this.h=null);var e=[];return this.i&&(e.push(this.i.destroy()),this.i=null),this.a=this.f=null,this.G.clear(),this.V.clear(),this.b.clear(),this.o=null,Promise.all(e)},i.update=function(){if(this.g!=ca.Va){for(var e=[],t=d(this.b.values()),n=t.next();!n.done;n=t.next())e.push(Vr(this,n.value));return Promise.all(e)}},i.onExpirationUpdated=function(){};var na={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},ia=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],ra={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function aa(e,t){e.g=t,e.c&&e.c.dc(e.g==ca.Va),e.g!=ca.Va||e.h.stop()}function oa(e,t,n){if(!e.i)throw new he(2,7,7001);return t=e.f.networkingEngine.request(n,t),Pe(e.i,t),t.promise}var sa={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=ea(e,"METHOD");Kn("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var n=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];return n.includes(t)?(t=ea(e,"URI"),t=Fr.parse(t),t=Ft("com.widevine.alpha",[{initDataType:"cenc",initData:t=new Uint8Array(t.data)}]),(e=Ir(e,"KEYID"))&&(t.keyIds=[e.toLowerCase().substr(2)]),t):(X.error("Widevine in HLS is only supported with [",n.join(", "),"], not",t),null)}},ua="VOD",ca={Va:ua,Le:"EVENT",Rd:"LIVE"};function la(){this.a=new Map}function fa(e,t,n){da(e,t).text=n}function da(e,t){return e.a.has(t)||e.a.set(t,new ha),e.a.get(t)}function ha(){this.text=this.variant=null}function pa(e,t){this.a=e,this.b=new Set([e]);for(var n=d(t=t||[]),i=n.next();!i.done;i=n.next())this.add(i.value)}function ma(e,t){var n;if(!(n=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(n=e.audio&&t.audio)){n=e.audio;var i=t.audio;n=!(n.channelsCount==i.channelsCount&&ga(n,i)&&va(n.roles,i.roles))}return!n&&(n=e.video&&t.video)&&(n=!(ga(n=e.video,i=t.video)&&va(n.roles,i.roles))),!n}function ga(e,t){if(e.mimeType!=t.mimeType)return!1;var n=e.codecs.split(",").map((function(e){return We(e)[0]})),i=t.codecs.split(",").map((function(e){return We(e)[0]}));if(n.length!=i.length)return!1;n.sort(),i.sort();for(var r=0;r<n.length;r++)if(n[r]!=i[r])return!1;return!0}function va(e,t){var n=new Set(e),i=new Set(t);if(n.delete("main"),i.delete("main"),n.size!=i.size)return!1;for(var r=(n=d(n)).next();!r.done;r=n.next())if(!i.has(r.value))return!1;return!0}function ya(e){this.a=e,this.b=new ba(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}function ba(e,t,n,i,r){this.f=e,this.c=t,this.a=n,this.b=void 0===i?"":i,this.g=void 0===r?"":r}function wa(){this.a=Ea,this.b=(new Map).set(Ea,2).set(Sa,1)}function Ta(e,t,n){e.b.set(Ea,n).set(Sa,t)}hr.zd("m3u8",Hr),hr.Lb("application/x-mpegurl",Hr),hr.Lb("application/vnd.apple.mpegurl",Hr),pa.prototype.add=function(e){return ma(this.a,e)?(this.b.add(e),!0):(X.m("Rejecting variant - not compatible with root."),!1)},pa.prototype.values=function(){return this.b.values()},ya.prototype.create=function(e){var t=this,n=e.filter((function(e){return ma(t.a,e)}));return n.length?new pa(n[0],n):this.b.create(e)},ba.prototype.create=function(e){var t=[];t=function(e,t){var n=Dn(Rn(t),e.map((function(e){return Nn(e)})));return n?e.filter((function(e){return n==Nn(e)})):[]}(e,this.f);var n=e.filter((function(e){return e.primary}));for(t=t.length?t:n.length?n:e,this.c&&((e=function(e,t,n){return e.filter((function(e){if(n){var i=e[n];return i&&i.roles.includes(t)}return i=e.audio,e=e.video,i&&0<=i.roles.indexOf(t)||e&&0<=e.roles.indexOf(t)}))}(t,this.c,this.g)).length?t=e:X.m("No exact match for variant role could be found.")),this.a&&((e=Un.$d(t,this.a)).length?t=e:X.m("No exact match for the channel count could be found.")),this.b&&((e=function(e,t){return e.filter((function(e){return!!e.audio&&e.audio.label.toLowerCase()==t.toLowerCase()}))}(t,this.b)).length?t=e:X.m("No exact match for variant label could be found.")),e=new pa(t[0]),n=(t=d(t)).next();!n.done;n=t.next())n=n.value,ma(e.a,n)&&e.add(n);return e};var Sa=0,Ea=1;function xa(e,t){this.g=e,this.h=Aa(e),this.a=e.a.currentTime,this.f=Date.now()/1e3,this.b=!1,this.i=t,this.c=function(){}}function ka(e){this.a=e}function Aa(e){if(e.a.paused||0==e.a.playbackRate||0==e.a.buffered.length)var t=!1;else e:{t=e.a.buffered,e=e.a.currentTime;for(var n=0;n<t.length;n++){var i=t.start(n),r=t.end(n);if(!(e<i-.1||e>r-.5)){t=!0;break e}}t=!1}return t}function Ma(e,t,n,i,r){var a=this;this.a=e,this.v=t,this.u=n,this.l=r,this.f=new Oe,this.i=!1,this.o=e.readyState,this.c=!1,this.b=i,this.h=!1,this.f.B(e,"waiting",(function(){return Ia(a)})),this.g=new le((function(){Ia(a)})).Ka(.25)}function Ia(e){if(0!=e.a.readyState){if(e.a.seeking){if(!e.i)return}else e.i=!1;if(!e.a.paused){var t;if(e.a.readyState!=e.o&&(e.c=!1,e.o=e.a.readyState),!(t=!e.b)){var n=(t=e.b).g,i=Aa(n),r=n.a.currentTime,a=Date.now()/1e3;t.a==r&&t.h==i||(t.f=a,t.a=r,t.h=i,t.b=!1),(i=(r=a-t.f)>=t.i&&i&&!t.b)&&(t.c(t.a,r),t.b=!0,t.a=n.a.currentTime),t=!i}if(t){a=e.u.smallGapLimit,t=e.a.currentTime;e:{if((n=e.a.buffered)&&n.length&&!(1==n.length&&1e-6>n.end(0)-n.start(0)))for(i=Je()||et("Trident/")||et("Tizen")||et("CrKey")?.5:.1,r=0;r<n.length;r++)if(n.start(r)>t&&(0==r||n.end(r-1)-t<=i)){i=r;break e}i=null}if(null!=i&&(0!=i||e.h)){r=n.start(i);var o=e.v.Ga();if(!(r>=o)){a=(o=r-t)<=a;var s=!1;if(!(.001>o)){if(!a&&!e.c){e.c=!0;var u=new Te("largegap",{currentTime:t,gapSize:o});u.cancelable=!0,e.l(u),e.u.jumpLargeGaps&&!u.defaultPrevented?s=!0:X.info("Ignoring large gap at",t,"size",o)}(a||s)&&(0==i?X.info("Jumping forward",o,"seconds because of gap before start time of",r):X.info("Jumping forward",o,"seconds because of gap starting at",n.end(i-1),"and ending at",r),e.a.currentTime=r)}}}}}}}function Pa(e){var t=this;this.c=e,this.a=new Set,this.b=new le((function(){Ca(t,!1)})).Ka(.25)}function Ca(e,t){for(var n=d(e.a),i=n.next();!i.done;i=n.next())i.value.g(e.c.currentTime,t)}function Ra(e){for(var t=[],n=(e=d(e)).next();!n.done;n=e.next())for(var i=(n=d(n.value.variants)).next();!i.done;i=n.next())t.push(i.value);return t}function Na(e,t){for(var n=null,i=d(e),r=i.next();!r.done;r=i.next())t>=(r=r.value).startTime&&(n=r);return n}function Da(e){this.c=e,this.a=null,this.b=function(){}}function La(e){var t=this;this.a=e,this.f=!1,this.c=this.a.rc(),this.b=new le((function(){t.a.le(.25*t.c)}))}function Ua(e){e.b.stop();var t=e.f?0:e.c;if(0<=t)try{return void(e.a.rc()!=t&&e.a.Id(t))}catch(e){}e.b.Ka(.25),0!=e.a.rc()&&e.a.Id(0)}function _a(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=Oa.get(t),n.ua(e,t,i))}xa.prototype.release=function(){this.g=null,this.c=function(){}},Ma.prototype.release=function(){this.f&&(this.f.release(),this.f=null),null!=this.g&&(this.g.stop(),this.g=null),this.b&&(this.b.release(),this.b=null),this.a=this.v=this.l=null},Ma.prototype.td=function(){this.h=!0,Ia(this)},Pa.prototype.release=function(){this.b.stop();for(var e=d(this.a),t=e.next();!t.done;t=e.next())t.value.release();this.a.clear()},Da.prototype.release=function(){this.a=this.c=null,this.b=function(){}},Da.prototype.g=function(e){var t=this.a,n=this.c.periods;t!=(e=Na(n,e)||n[0])&&this.b(e),this.a=e},La.prototype.release=function(){this.b&&(this.b.stop(),this.b=null),this.a=null},La.prototype.set=function(e){this.c=e,Ua(this)};var Oa=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function ja(e,t,n){var i=this;this.a=e,this.g=t,this.f=n,this.h=!1,this.b=new Oe,this.c=new Va(e),_a(this.a,HTMLMediaElement.HAVE_METADATA,this.b,(function(){Fa(i,i.f)}))}function Ka(e){return e.h?e.a.currentTime:e.f}function Ba(e,t){0<e.a.readyState?qa(e.c,t):_a(e.a,HTMLMediaElement.HAVE_METADATA,e.b,(function(){Fa(e,e.f)}))}function Fa(e,t){.001>Math.abs(e.a.currentTime-t)?Ha(e):(e.b.ua(e.a,"seeking",(function(){Ha(e)})),qa(e.c,0==e.a.currentTime?t:e.a.currentTime))}function Ha(e){e.h=!0,e.b.B(e.a,"seeking",(function(){return e.g()}))}function Va(e){var t=this;this.b=e,this.h=10,this.g=this.c=this.f=0,this.a=new le((function(){0>=t.f?(X.m(["Failed to move playhead from",t.c,"to",t.g].join(" ")),t.a.stop()):t.b.currentTime!=t.c?t.a.stop():(t.b.currentTime=t.g,t.f--)}))}function qa(e,t){e.c=e.b.currentTime,e.g=t,e.f=e.h,e.b.currentTime=t,e.a.Ka(.1)}function za(e){var t=this;this.a=e,this.f=!1,this.c=null,this.b=new Oe,_a(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,(function(){null==t.c?t.f=!0:(t.b.ua(t.a,"seeking",(function(){t.f=!0})),t.a.currentTime=Math.max(0,t.a.currentTime+t.c))}))}function Ga(e,t,n,i,r,a){var o=this;this.c=e,this.a=t.presentationTimeline,this.F=t.minBufferTime||0,this.h=n,this.v=r,this.l=null,this.f=new Ma(e,t.presentationTimeline,n,function(e,t){if(!t.stallEnabled)return null;var n=t.stallSkip,i=new xa(new ka(e),t.stallThreshold);return function(e,t){e.c=t}(i,(function(t,i){X.debug("Stall detected at "+t+" for "+i+" seconds."),n?(X.debug("Seeking forward "+n+" seconds to break stall."),e.currentTime+=n):(X.debug("Pausing and unpausing to break stall."),e.pause(),e.play())})),i}(e,n),a),this.b=new ja(e,(function(){e:{var e=o.f;e.i=!0,e.h=!1,e.c=!1,e=Ka(o.b);var t=Xa(o,e);if(.001<Math.abs(t-e)){var n=Date.now()/1e3;if(!o.l||o.l<n-1){o.l=n,Ba(o.b,t),e=void 0;break e}}X.D("Seek to "+e),o.v(),e=void 0}return e}),function(e,t){return null==t?t=1/0>e.a.ca()?e.a.wb():e.a.Ga():0>t&&(t=e.a.Ga()+t),Wa(e,Ya(e,t))}(this,i)),this.i=new le((function(){if(0!=o.c.readyState&&!o.c.paused){var e=Ka(o.b),t=o.a.wb(),n=o.a.Ga();3>n-t&&(t=n-3),e<t&&(t=Xa(o,e),X.info("Jumping forward "+(t-e)+" seconds to catch up with the seek range."),o.c.currentTime=t)}})).Ka(.25)}function Wa(e,t){var n=e.a.ca();return t>=n?n-e.h.durationBackoff:t}function Xa(e,t){var n=_t.bind(null,e.c.buffered),i=Math.max(e.F,e.h.rebufferingGoal),r=e.h.safeSeekOffset,a=e.a.wb(),o=e.a.Ga(),s=e.a.ca();3>o-a&&(a=o-3);var u=e.a.Vb(i),c=e.a.Vb(r);return i=e.a.Vb(i+r),t>=s?(X.D("Playhead past duration."),Wa(e,t)):t>o?(X.D("Playhead past end."),o):t<a?n(c)?(X.D("Playhead before start & start is buffered"),c):(X.D("Playhead before start & start is unbuffered"),i):t>=u||n(t)?(X.D("Playhead in safe region or in buffered region."),t):(X.D("Playhead outside safe region & in unbuffered region."),i)}function Ya(e,t){var n=e.a.wb();return t<n||t>(n=e.a.Ga())?n:t}function $a(e){var t=this;this.b=function(){},this.a=new Set,this.f=e,this.c=new le((function(){for(var e=t.f(),n=d(t.a),i=n.next();!i.done;i=n.next())(i=i.value).endTime<e.start&&t.a.delete(i)})).Ka(2)}function Ja(e){var t=this;this.h=e,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.i=[{lb:null,kb:Za,ab:function(e,n){return t.a(e,n)}},{lb:Qa,kb:Za,ab:function(e,n){return t.a(e,n)}},{lb:eo,kb:Za,ab:function(e,n){return t.a(e,n)}},{lb:Za,kb:Qa,ab:function(e,n){return t.b(e,n)}},{lb:Za,kb:eo,ab:function(e,n){return t.b(e,n)}},{lb:Qa,kb:eo,ab:function(e,n){return t.c(e,n)}},{lb:eo,kb:Qa,ab:function(e,n){return t.c(e,n)}}]}ja.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.g=function(){},this.a=null},Va.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},za.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.a=null},za.prototype.o=function(e){this.c=this.f?this.c:e},za.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0},za.prototype.u=function(){},Ga.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.f&&(this.f.release(),this.f=null),this.i&&(this.i.stop(),this.i=null),this.c=this.b=this.a=this.h=null,this.v=function(){}},Ga.prototype.o=function(e){Ba(this.b,e)},Ga.prototype.g=function(){var e=Ka(this.b);return 0<this.c.readyState&&!this.c.paused?Ya(this,e):e},Ga.prototype.u=function(){this.f.td()},$a.prototype.release=function(){this.b=function(){},this.a.clear(),this.c.stop()},Ja.prototype.release=function(){this.h=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}},Ja.prototype.g=function(e,t){for(var n=d(this.h.a),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.f.get(i),a=e<i.startTime?Qa:e>i.endTime?eo:Za;this.f.set(i,a);for(var o=d(this.i),s=o.next();!s.done;s=o.next())(s=s.value).lb==r&&s.kb==a&&s.ab(i,t)}};var Qa=1,Za=2,eo=3;function to(e,t){this.a=t,this.c=e,this.g=null,this.l=1,this.v=Promise.resolve(),this.h=[],this.i=new Map,this.b=new Map,this.u=!1,this.H=null,this.G=this.f=this.o=!1,this.F=0}function no(e){return ro(e,"audio")}function io(e){return ro(e,"video")}function ro(e,t){var n=e.b.get(t);return n?n.Pa||n.stream:null}function ao(e,t){return p((function n(){var i,r,a,o,s,u,c,l,f;return _(n,(function(n){switch(n.j){case 1:return i=Ht,x(n,kn(e.a.O,i.va),2);case 2:return e.F++,e.G=!1,r=e.F,a=e.a.O,o=new Map,s=new Set,o.set(i.va,t),s.add(t),x(n,a.init(o,!1),3);case 3:return e.f?n.return():x(n,po(e,s),4);case 4:if(e.f)return n.return();u=e.a.O.g.isTextVisible()||e.g.alwaysStreamText,e.F!=r||e.b.has(i.va)||e.G||!u||(c=e.a.Za(),l=So(e,c),f=fo(t,l,0),e.b.set(i.va,f),Ao(e,f,0)),k(n)}}))}))}function oo(e,t){var n=e.b.get("video");if(n){var i=n.stream;if(i)if(X.debug("setTrickPlay",t),t){var r=i.trickModeVideo;r&&!n.Pa&&(X.debug("Engaging trick mode stream",r),uo(e,r,!1,0,!1),n.Pa=i)}else(i=n.Pa)&&(X.debug("Restoring non-trick-mode stream",i),n.Pa=null,uo(e,i,!0,0,!1))}}function so(e,t,n,i){var r=!1;if(t.video){var a=uo(e,t.video,n,i,!1);r=r||a}return t.audio&&(e=uo(e,t.audio,n,i,!1),r=r||e),r}function uo(e,t,n,i,r){var a=e.b.get(t.type);if(!a&&"text"==t.type&&e.g.ignoreTextStreamFailures)return ao(e,t),!0;if(!a)return!1;var o=Eo(e,t),s=Array.from(e.b.values()).every((function(e){return e.ka==a.ka}));return n&&o!=a.ka&&s?(X.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),e.b.forEach((function(t){co(e,t)})),!0):(a.Pa&&(X.debug("switch during trick play mode",t),t.trickModeVideo?(a.Pa=t,t=t.trickModeVideo,X.debug("switch found trick play stream",t)):(a.Pa=null,X.debug("switch found no special trick play stream"))),!(!(s=e.h[o])||!s.Mb)&&(!(!(s=e.i.get(t.id))||!s.Mb)&&(a.stream!=t||r?("text"==t.type&&yn(e.a.O,Ge(t.mimeType,t.codecs)),a.stream=t,a.vc=!0,X.debug("switch: switching to Stream "+Co(a)),function(e,t,n){if(!t.fb)return!1;var i=e.a.Za(),r=Tn(e.a.O,t.type),a=vo(e,t,i,r,n);return n=a&&a.a?a.a-a.b:null,a&&!n&&(n=(a.endTime-a.sc())*t.stream.bandwidth/8),!isNaN(n)&&((a=t.stream.initSegmentReference)&&(n+=(a.a?a.a-a.b:null)||0),a=e.a.getBandwidthEstimate(),8*n/a<r-i-Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal)||t.fb.b.a>n)}(e,a,o)&&(X.info("Aborting current segment request to switch."),a.fb.abort()),n&&(a.Wa?a.Kc=!0:a.Oa?(a.Sa=!0,a.lc=i,a.Kc=!0):(Mo(a),ko(e,a,!0,i).catch((function(t){e.a&&e.a.onError(t)})))),!0):(X.debug("switch: Stream "+Co(a)+" already active"),!1))))}function co(e,t){var n=Co(t);t.Wa?X.debug(n,"clear: already clearing the buffer"):t.Sa?X.debug(n,"clear: already waiting"):t.Oa?(X.debug(n,"clear: currently updating"),t.Sa=!0,t.lc=0):null==wn(e.a.O,t.type)?(X.debug(n,"clear: nothing buffered"),null==t.La&&Ao(e,t,0)):(X.debug(n,"clear: handling right now"),Mo(t),ko(e,t,!1,0).catch((function(t){e.a&&e.a.onError(t)})))}function lo(e,t,n,i,r){return p((function a(){var o,s,u,c,l,f,d;return _(a,(function(a){switch(a.j){case 1:return o=e.a.Za(),s=So(e,o),u=Ht,c=new Map,l=new Set,t&&(c.set(u.Nb,t),l.add(t)),n&&(c.set(u.Ua,n),l.add(n)),i&&(c.set(u.va,i),l.add(i)),f=e.a.O,d=e.g.forceTransmuxTS,x(a,f.init(c,d),2);case 2:return e.f?a.return():(function(e){var t=e.c.presentationTimeline.ca();1/0>t?e.a.O.Ba(t):e.a.O.Ba(Math.pow(2,32))}(e),x(a,po(e,l),3));case 3:if(e.f)return a.return();c.forEach((function(t,n){if(!e.b.has(n)){var i=fo(t,s,r);e.b.set(n,i),Ao(e,i,0)}})),k(a)}}))}))}function fo(e,t,n){return{stream:e,type:e.type,Cb:null,Ha:null,Pa:null,vc:!0,ka:t,endOfStream:!1,Oa:!1,La:null,Sa:!1,lc:0,Kc:!1,Wa:!1,yd:!1,Xb:!1,Bd:n||0,fb:null}}function ho(e,t){var n=e.h[t];if(n)return X.debug("(all) Period "+t+" is being or has been set up"),n.promise;X.debug("(all) setting up Period "+t),n={promise:new pe,Mb:!1},e.h[t]=n;for(var i=new Set,r=d(e.c.periods[t].variants),a=r.next();!a.done;a=r.next())(a=a.value).video&&i.add(a.video),a.video&&a.video.trickModeVideo&&i.add(a.video.trickModeVideo),a.audio&&i.add(a.audio);for(a=(r=d(e.c.periods[t].textStreams)).next();!a.done;a=r.next())i.add(a.value);return e.v=e.v.then(function(){if(!this.f)return po(this,i)}.bind(e)).then(function(){this.f||(this.h[t].promise.resolve(),this.h[t].Mb=!0,X.D("(all) setup Period "+t))}.bind(e)).catch(function(e){this.f||(this.h[t].promise.catch((function(){})),this.h[t].promise.reject(),delete this.h[t],X.m("(all) failed to setup Period "+t),this.a.onError(e))}.bind(e)),n.promise}function po(e,t){return p((function n(){var i,r,a,o,s,u,c;return _(n,(function(n){switch(n.j){case 1:i=[];for(var l=d(t),f=l.next();!f.done;f=l.next())r=f.value,(a=e.i.get(r.id))?(X.debug("(all) Stream "+r.id+" is being or has been set up"),i.push(a.promise)):(X.D("(all) setting up Stream "+r.id),e.i.set(r.id,{promise:new pe,Mb:!1}),i.push(r.createSegmentIndex()));return A(n,2),x(n,Promise.all(i),4);case 4:if(e.f)return n.return();I(n,3);break;case 2:if(o=P(n),e.f)return n.return();for(f=(n=d(t)).next();!f.done;f=n.next())s=f.value,e.i.get(s.id).promise.catch((function(){})),e.i.get(s.id).promise.reject(),e.i.delete(s.id);throw o;case 3:for(f=(l=d(t)).next();!f.done;f=l.next())u=f.value,(c=e.i.get(u.id)).Mb||(c.promise.resolve(),c.Mb=!0,X.D("(all) setup Stream "+u.id));k(n)}}))}))}function mo(e,t){if(!e.f){var n=Co(t);if(!t.Oa&&null!=t.La&&!t.Wa)if(t.La=null,t.Sa)X.debug(n,"skipping update and clearing the buffer"),ko(e,t,t.Kc,t.lc);else{try{var i=function(e,t){if(wo(t))return xn(e.a.O,t.stream.originalId||""),null;var n=Co(t),i=e.a.Za(),r=go(e,t,i);X.J(n,"timeNeeded="+r);var a=Eo(e,t.stream),o=So(e,r),s=function(e,t,n){return"text"==t?null==(e=e.a).b||e.b<n?0:e.b-Math.max(n,e.a):Ot(e=Sn(e,t),n)}(e.a.O,t.type,i);X.J(n,"update_:","presentationTime="+i,"bufferedAhead="+s);var u=Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal,e.g.bufferingGoal)*e.l;if(r>=e.c.presentationTimeline.ca())return X.debug(n,"buffered to end of presentation"),t.endOfStream=!0,"video"==t.type&&(r=e.b.get("text"))&&"application/cea-608"==r.stream.mimeType&&(r.endOfStream=!0),null;if(t.endOfStream=!1,t.ka=o,o!=a)return X.debug(n,"need Period "+o,"presentationTime="+i,"timeNeeded="+r,"currentPeriodIndex="+a),null;if(s>=u)return X.J(n,"buffering goal met"),.5;if(n=Tn(e.a.O,t.type),!(n=vo(e,t,i,n,a)))return 1;var c=1/0;return Array.from(e.b.values()).forEach((function(t){wo(t)||(t=go(e,t,i),c=Math.min(c,t))})),r>=c+e.c.presentationTimeline.a?1:(t.Bd=0,function(e,t,n,i,r){var a=Co(t),o=e.c.periods[i];X.D(a,"fetchAndAppend_:","presentationTime="+n,"currentPeriod.startTime="+o.startTime,"reference.position="+r.position,"reference.startTime="+r.startTime,"reference.endTime="+r.endTime);var s=t.stream,u=e.c.presentationTimeline.ca(),c=e.c.periods[i+1];i=function(e,t,n,i,r){if(!t.vc)return Promise.resolve();var a=Co(t);return n=e.c.periods[n].startTime-t.stream.presentationTimeOffset,X.D(a,"setting timestamp offset to "+n),X.D(a,"setting append window start to "+i),X.D(a,"setting append window end to "+r),i=function(e,t,n,i,r){return"text"==t?(e.a.o=n,(e=e.a).f=i,e.h=r,Promise.resolve()):Promise.all([An(e,t,e.Pe.bind(e,t)),An(e,t,e.ug.bind(e,t,n)),An(e,t,e.rg.bind(e,t,i,r))])}(e.a.O,t.type,n,i,r),t.stream.initSegmentReference?(X.D(a,"fetching init segment"),e=xo(e,t,t.stream.initSegmentReference).then(function(e){if(!this.f)return X.D(a,"appending init segment"),En(this.a.O,t.type,e,null,null,t.stream.closedCaptions&&0<t.stream.closedCaptions.size)}.bind(e)).catch((function(e){return t.vc=!0,Promise.reject(e)})),Promise.all([i,e])):i}(e,t,i,Math.max(0,o.startTime-.1),c?c.startTime+.01:u),t.Oa=!0,t.vc=!1,X.J(a,"fetching segment"),u=xo(e,t,r),Promise.all([i,u]).then(function(e){if(!this.f&&!this.o)return function(e,t,n,i,r,a,o){var s=Co(t),u=r.closedCaptions&&0<r.closedCaptions.size;return null!=r.emsgSchemeIdUris&&0<r.emsgSchemeIdUris.length&&(new Ci).ia("emsg",e.K.bind(e,i,a,r.emsgSchemeIdUris)).parse(o),function(e,t,n){var i=Co(t);X.J(i,"checking buffer length");var r=Math.max(e.g.bufferBehind,e.c.presentationTimeline.a),a=wn(e.a.O,t.type);if(null==a)return X.J(i,"buffer behind okay because nothing buffered:","presentationTime="+n,"bufferBehind="+r),Promise.resolve();var o=n-a,s=o-r;return 0>=s?(X.J(i,"buffer behind okay:","presentationTime="+n,"bufferedBehind="+o,"bufferBehind="+r,"underflow="+-s),Promise.resolve()):(X.D(i,"buffer behind too large:","presentationTime="+n,"bufferedBehind="+o,"bufferBehind="+r,"overflow="+s),e.a.O.remove(t.type,a,a+s).then(function(){this.f||X.D(i,"evicted "+s+" seconds")}.bind(e)))}(e,t,n).then(function(){if(!this.f)return X.D(s,"appending media segment"),En(this.a.O,t.type,o,a.startTime+i.startTime,a.endTime+i.startTime,u)}.bind(e)).then(function(){if(!this.f)return X.J(s,"appended media segment"),t.Cb=r,t.Ha=a,Promise.resolve()}.bind(e))}(this,t,n,o,s,r,e[1])}.bind(e)).then(function(){this.f||this.o||(t.Oa=!1,t.yd=!1,t.Sa||this.a.td(),Ao(this,t,0),function(e,t,n){if(!e.u){var i=Co(t);if(1==(t=Array.from(e.b.values())).length&&"text"==t[0].type||(e.u=t.every((function(e){return"text"==e.type||!e.Sa&&!e.Wa&&e.Ha}))),e.u){for(X.debug(i,"startup complete"),n=Eo(e,n),e.h[n]||ho(e,n).then(function(){this.f||(X.D(i,"calling onCanSwitch()..."),this.a.ne())}.bind(e)).catch(Kt.wc),n=0;n<e.c.periods.length;++n)ho(e,n).catch(Kt.wc);e.a.Yf&&(X.D(i,"calling onStartupComplete()..."),e.a.Yf())}}}(this,t,s),X.D(a,"finished fetch and append"))}.bind(e)).catch(function(e){this.f||this.o||(t.Oa=!1,"text"==t.type&&this.g.ignoreTextStreamFailures?(1001==e.code?X.m(a,"Text stream failed to download. Proceeding without it."):X.m(a,"Text stream failed to parse. Proceeding without it."),this.b.delete("text")):7001==e.code?(t.Oa=!1,t.La=null,Ao(this,t,0)):3017==e.code?function(e,t,n){var i=Co(t);if(Array.from(e.b.values()).some((function(e){return e!=t&&e.yd})))X.debug(i,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var r=Math.round(100*e.l);if(20<r)e.l-=.2;else{if(!(4<r))return X.error(i,"MediaSource threw QuotaExceededError too many times"),t.Xb=!0,e.o=!0,void e.a.onError(n);e.l-=.04}X.m(i,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*e.l))+"%"),t.yd=!0}Ao(e,t,4)}(this,t,e):(X.error(a,"failed fetch and append: code="+e.code),t.Xb=!0,e.severity=2,Po(this,e)))}.bind(e))}(e,t,i,a,n),null)}(e,t);null!=i&&(Ao(e,t,i),t.Xb=!1)}catch(t){return void Po(e,t)}i=Array.from(e.b.values()),function(e,t){var n=Co(t),i=Eo(e,t.stream);if(t.ka!=i){var r=t.ka,a=Array.from(e.b.values());a.every((function(e){return e.ka==r||wo(e)}))?a.every(To)?(X.debug(n,"all need Period "+r),ho(e,r).then(function(){if(!this.f)if(a.every(function(e){var t=To(e),n=Eo(this,e.stream);return!!wo(e)||t&&e.ka==r&&n!=r}.bind(this))){var e=this.c.periods[r];X.D(n,"calling onChooseStreams()...");var t=this.a.oe(e),i=new Map;t.variant&&t.variant.video&&i.set("video",t.variant.video),t.variant&&t.variant.audio&&i.set("audio",t.variant.audio),t.text&&i.set("text",t.text);for(var o=(t=d(this.b.keys())).next();!o.done;o=t.next())if(o=o.value,!i.has(o)&&"text"!=o)return X.error(n,"invalid Streams chosen: missing "+o+" Stream"),void this.a.onError(new he(2,5,5005));for(o=(t=d(Array.from(i.keys()))).next();!o.done;o=t.next())if(o=o.value,!this.b.has(o)){if("text"!=o)return X.error(n,"invalid Streams chosen: unusable "+o+" Stream"),void this.a.onError(new he(2,5,5005));lo(this,null,null,i.get("text"),e.startTime),i.delete(o)}for(o=(t=d(Array.from(this.b.keys()))).next();!o.done;o=t.next()){o=o.value;var s=this.b.get(o),u=i.get(o);if(u){var c=wo(s);c&&(s.ka=r,s.Bd=e.startTime),uo(this,u,!1,0,!1),c&&wo(s)||Ao(this,this.b.get(o),0)}else this.b.delete(o)}X.D(n,"calling onCanSwitch()..."),this.a.ne()}else X.debug(n,"ignoring transition to Period",r,"since another is happening")}.bind(e)).catch(Kt.wc)):X.debug(n,"all MediaStates need Period "+r+", but not all MediaStates are idle"):X.debug(n,"not all MediaStates need Period "+r)}}(e,t),e.u&&i.every((function(e){return e.endOfStream}))&&(X.D(n,"calling endOfStream()..."),e.a.O.endOfStream().then(function(){if(!this.f){var e=this.a.O.ca();0!=e&&e<this.c.presentationTimeline.ca()&&this.c.presentationTimeline.Ba(e)}}.bind(e)))}}}function go(e,t,n){return t.Cb&&t.Ha?(n=Eo(e,t.Cb),e.c.periods[n].startTime+t.Ha.endTime):Math.max(n,t.Bd)}function vo(e,t,n,i,r){var a=Co(t);return t.Ha&&t.stream==t.Cb?(i=t.Ha.position+1,X.J(a,"next position known:","position="+i),bo(e,t,r,i)):(t.Ha?(X.D(a,"next position unknown: another Stream buffered"),a=Eo(e,t.Cb),a=yo(e,t,e.c.periods[a].startTime+t.Ha.endTime,r)):(X.D(a,"next position unknown: nothing buffered"),a=yo(e,t,i||n,r)),null==a?null:(n=null,null==i&&(n=bo(e,t,r,Math.max(0,a-1))),n||bo(e,t,r,a)))}function yo(e,t,n,i){var r=Co(t);return e=e.c.periods[i],X.debug(r,"looking up segment:","presentationTime="+n,"currentPeriod.startTime="+e.startTime),n=Math.max(0,n-e.startTime),null==(t=t.stream.findSegmentPosition(n))&&X.m(r,"cannot find segment:","currentPeriod.startTime="+e.startTime,"lookupTime="+n),t}function bo(e,t,n,i){var r=Co(t);return n=e.c.periods[n],(t=t.stream.getSegmentReference(i))?(e=(i=e.c.presentationTimeline).Wb(),i=i.xb(),n.startTime+t.endTime<e||n.startTime+t.startTime>i?(X.J(r,"segment is not available:","currentPeriod.startTime="+n.startTime,"reference.startTime="+t.startTime,"reference.endTime="+t.endTime,"availabilityStart="+e,"availabilityEnd="+i),null):t):(X.D(r,"segment does not exist:","currentPeriod.startTime="+n.startTime,"position="+i),null)}function wo(e){return e&&"text"==e.type&&"application/cea-608"==e.stream.mimeType}function To(e){return!e.Oa&&null==e.La&&!e.Sa&&!e.Wa}function So(e,t){var n=Na(e.c.periods,t+1/15);return n?e.c.periods.indexOf(n):0}function Eo(e,t){for(var n=e.c.periods,i=0;i<n.length;i++){for(var r=n[i],a=new Set,o=d(r.variants),s=o.next();!s.done;s=o.next())(s=s.value).audio&&a.add(s.audio),s.video&&a.add(s.video),s.video&&s.video.trickModeVideo&&a.add(s.video.trickModeVideo);for(o=(r=d(r.textStreams)).next();!o.done;o=r.next())a.add(o.value);if(a.has(t))return i}return-1}function xo(e,t,n){var i=mr(n.c(),n.b,n.a,e.g.retryParameters);return X.J("fetching: reference=",n),e=e.a.Db.request(1,i),t.fb=e,e.promise.then((function(e){return t.fb=null,e.data}))}function ko(e,t,n,i){return p((function r(){var a,o,s,u;return _(r,(function(r){switch(r.j){case 1:return a=Co(t),t.Sa=!1,t.Kc=!1,t.lc=0,t.Wa=!0,t.Cb=null,t.Ha=null,X.debug(a,"clearing buffer"),i?(s=e.a.Za(),u=e.a.O.ca(),o=e.a.O.remove(t.type,s+i,u)):o=kn(e.a.O,t.type).then(function(){if(!this.f&&n)return this.a.O.flush(t.type)}.bind(e)),x(r,o,2);case 2:if(e.f)return r.return();X.debug(a,"cleared buffer"),t.Wa=!1,t.endOfStream=!1,Ao(e,t,0),k(r)}}))}))}function Ao(e,t,n){X.J(Co(t),"updating in "+n+" seconds"),t.La=new ce((function(){return p((function n(){var i;return _(n,(function(n){switch(n.j){case 1:return A(n,2),x(n,mo(e,t),4);case 4:I(n,0);break;case 2:i=P(n),e.a&&e.a.onError(i),k(n)}}))}))})).R(n)}function Mo(e){null!=e.La&&(e.La.stop(),e.La=null)}function Io(e){return p((function t(){return _(t,(function(t){switch(t.j){case 1:if(e.fb)return x(t,e.fb.abort(),0);t.C(0)}}))}))}function Po(e,t){de(e.H).then(function(){this.f||(this.a.onError(t),t.handled||this.g.failureCallback(t))}.bind(e))}function Co(e){return"("+e.type+":"+e.stream.id+")"}function Ro(e,t,n,i,r,a){if(200<=n&&299>=n&&202!=n)return{uri:r||i,vd:i,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};r=null;try{r=ot(t)}catch(e){}throw X.debug("HTTP error text:",r),new he(401==n||403==n?2:1,1,1001,i,n,r,e,a)}function No(e,t,n,i){var r=new No.b;qe(t.headers).forEach((function(e,t){r.append(t,e)}));var a=new No.a,o={Ud:!1,He:!1};if(e=new me(e=No.l(e,n,{body:t.body||void 0,headers:r,method:t.method,signal:a.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},o,i),(function(){return o.Ud=!0,a.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var s=new le((function(){o.He=!0,a.abort()}));s.R(t/1e3),e.finally((function(){s.stop()}))}return e}function Do(e,t,n,i){var r=new Do.f,a=Date.now(),o=0;return new me(new Promise((function(s,u){for(var c in r.open(t.method,e,!0),r.responseType="arraybuffer",r.timeout=t.retryParameters.timeout,r.withCredentials=t.allowCrossSiteCredentials,r.onabort=function(){u(new he(1,1,7001,e,n))},r.onload=function(t){for(var i=(t=t.target).getAllResponseHeaders().trim().split("\r\n"),r={},a=(i=d(i)).next();!a.done;a=i.next())r[(a=a.value.split(": "))[0].toLowerCase()]=a.slice(1).join(": ");try{var o=Ro(r,t.response,t.status,e,t.responseURL,n);s(o)}catch(e){u(e)}},r.onerror=function(t){u(new he(1,1,1002,e,t,n))},r.ontimeout=function(){u(new he(1,1,1003,e,n))},r.onprogress=function(e){var t=Date.now();(100<t-a||e.lengthComputable&&e.loaded==e.total)&&(i(t-a,e.loaded-o,e.total-e.loaded),o=e.loaded,a=t)},t.headers)r.setRequestHeader(c.toLowerCase(),t.headers[c]);r.send(t.body)})),(function(){return r.abort(),Promise.resolve()}))}function Lo(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function Uo(e,t,n){this.h=e,this.b=new Map,this.c=!1,this.g=t,this.f=n,this.a=new Lo}function _o(e,t,n,i,r,a){var o=function(e,t){e.b+=t;var n=e.g;return e.g++,e.c.set(n,t),n}(e.a,i);i=e.b.get(t)||Promise.resolve(),e.b.set(t,i.then((function(){return p((function t(){var i,s,u,c,l,f;return _(t,(function(t){switch(t.j){case 1:return x(t,function(e,t){return p((function n(){var i;return _(n,(function(n){switch(n.j){case 1:return x(n,e.h.request(1,t).promise,2);case 2:return i=n.s,n.return(i.data)}}))}))}(e,n),2);case 2:if(i=t.s,e.c)throw new he(2,9,7001);if(r)for(var d in s=new Uint8Array(i),(u=new _i(s)).data)c=Number(d),l=u.data[c],f=u.a[c],e.f(l,f);return e.a.close(o,i.byteLength),d=e.a,e.g(0==d.b?0:d.f/d.b,e.a.a),t.return(a(i))}}))}))})))}function Oo(e,t){var n=this;this.c=e,this.b=e.objectStore(t),this.a=new pe,e.onabort=function(e){e.preventDefault(),n.a.reject()},e.onerror=function(e){e.preventDefault(),n.a.reject()},e.oncomplete=function(){n.a.resolve()}}function jo(e,t){return new Promise((function(n,i){var r=e.b.openCursor();r.onerror=i,r.onsuccess=function(e){if(!(e=e.target.result))return n();t(e.key,e.value,e),e.continue()}}))}function Ko(e){this.b=e,this.a=[]}function Bo(e,t){return Fo(e,t,"readwrite")}function Fo(e,t,n){var i=new Oo(n=e.b.transaction([t],n),t);return e.a.push(i),i.promise().then((function(){Ae(e.a,i)}),(function(){Ae(e.a,i)})),i}function Ho(e,t,n){this.b=new Ko(e),this.c=t,this.a=n}function Vo(e){return Promise.reject(new he(2,9,9011,"Cannot add new value to "+e))}function qo(e,t,n,i){t=(e=Bo(e.b,t)).store();for(var r={},a=(n=d(n)).next();!a.done;r={key:r.key},a=n.next())r.key=a.value,t.delete(r.key).onsuccess=function(e){return function(){return i(e.key)}}(r);return e.promise()}function zo(e,t,n){return p((function i(){var r,a,o,s,u,c,l;return _(i,(function(i){switch(i.j){case 1:for(r=Fo(e.b,t,"readonly"),a=r.store(),o={},s=[],u={},c=d(n),l=c.next();!l.done;u={request:u.request,key:u.key},l=c.next())u.key=l.value,u.request=a.get(u.key),u.request.onsuccess=function(e){return function(){null==e.request.result&&s.push(e.key),o[e.key]=e.request.result}}(u);return x(i,r.promise(),2);case 2:if(s.length)throw new he(2,9,9012,"Could not find values for "+s);return i.return(n.map((function(e){return o[e]})))}}))}))}function Go(e){this.a=new Ko(e)}function Wo(){this.a=new Map}function Xo(e,t,n){if(!(e=e.a.get(t)))throw new he(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new he(2,9,9013,"Could not find cell with name "+n);return t}function Yo(e,t){$o.set(e,t)}to.prototype.destroy=function(){var e=this;return p((function t(){var n,i;return _(t,(function(t){switch(t.j){case 1:n=[];for(var r=d(e.b.values()),a=r.next();!a.done;a=r.next())Mo(i=a.value),n.push(Io(i));return x(t,Promise.all(n),2);case 2:e.b.clear(),e.i.clear(),e.a=null,e.c=null,e.v=null,e.h=null,e.g=null,e.f=!0,k(t)}}))}))},to.prototype.configure=function(e){this.g=e,this.H=new fe({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},to.prototype.start=function(){var e=this;return p((function t(){var n,i,r;return _(t,(function(t){switch(t.j){case 1:return n=e.a.Za(),i=So(e,n),(r=e.a.oe(e.c.periods[i])).variant||r.text?x(t,lo(e,r.variant?r.variant.audio:null,r.variant?r.variant.video:null,r.text,n),2):(X.error("init: no Streams chosen"),t.return(new he(2,5,5005)));case 2:if(e.f)return t.return();X.debug("init: completed initial Stream setup"),e.a&&e.a.Pf&&(X.D("init: calling onInitialStreamsSetup()..."),e.a.Pf()),k(t)}}))}))},to.prototype.K=function(e,t,n,i){var r=i.reader.wd(),a=i.reader.wd(),o=i.reader.I(),s=i.reader.I(),u=i.reader.I(),c=i.reader.I();i=i.reader.gb(i.reader.N.byteLength-i.reader.ga()),e=e.startTime+t.startTime+s/o,n.includes(r)&&("urn:mpeg:dash:event:2012"==r?this.a.Qf():this.a.onEvent(new Te("emsg",{detail:{startTime:e,endTime:e+u/o,schemeIdUri:r,value:a,timescale:o,presentationTimeDelta:s,eventDuration:u,id:c,messageData:i}})))},H("shaka.net.HttpFetchPlugin",No),No.l=function(e,t,n,i,r){return p((function a(){var o,s,u,c,l,f,d,h,m,g,v,y;return _(a,(function(a){switch(a.j){case 1:return o=No.g,s=No.c,f=l=0,d=Date.now(),A(a,2),x(a,o(e,n),4);case 4:return u=a.s,h=u.clone().body.getReader(),g=(m=u.headers.get("Content-Length"))?parseInt(m,10):0,new s({start:function(e){!function t(){return p((function n(){var i,a,o;return _(n,(function(n){switch(n.j){case 1:return A(n,2),x(n,h.read(),4);case 4:i=n.s,I(n,3);break;case 2:return a=P(n),X.D("error reading from stream",a.message),n.return();case 3:i.done||(l+=i.value.byteLength),(100<(o=Date.now())-d||i.done)&&(r(o-d,l-f,g-l),f=l,d=o),i.done?e.close():(e.enqueue(i.value),t()),k(n)}}))}))}()}}),x(a,u.arrayBuffer(),5);case 5:c=a.s,I(a,3);break;case 2:if(v=P(a),i.Ud)throw new he(1,1,7001,e,t);if(i.He)throw new he(1,1,1003,e,t);throw new he(1,1,1002,e,v,t);case 3:return y={},u.headers.forEach((function(e,t){y[t.trim()]=e})),a.return(Ro(y,c,u.status,e,u.url,t))}}))}))},No.isSupported=function(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!e.fetch||!e.AbortController)},No.isSupported=No.isSupported,No.g=e.fetch,No.a=e.AbortController,No.c=e.ReadableStream,No.b=e.Headers,No.isSupported()&&(Ne("http",No,2),Ne("https",No,2)),H("shaka.net.HttpXHRPlugin",Do),Do.f=e.XMLHttpRequest,Ne("http",Do,1),Ne("https",Do,1),Lo.prototype.close=function(e,t){if(this.c.has(e)){var n=this.c.get(e);this.c.delete(e),this.f+=n,this.a+=t}},Uo.prototype.destroy=function(){return this.c=!0,Promise.all(this.b.values()).then((function(){}),(function(){}))},Oo.prototype.abort=function(){try{this.c.abort()}catch(e){}return this.a.catch((function(){}))},Oo.prototype.store=function(){return this.b},Oo.prototype.promise=function(){return this.a},Ko.prototype.destroy=function(){return Promise.all(this.a.map((function(e){return e.abort()})))},(i=Ho.prototype).destroy=function(){return this.b.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return Vo(this.c)},i.removeSegments=function(e,t){return qo(this,this.c,e,t)},i.getSegments=function(e){var t=this;return p((function n(){var i;return _(n,(function(n){switch(n.j){case 1:return x(n,zo(t,t.c,e),2);case 2:return i=n.s,n.return(i.map((function(e){return t.Wd(e)})))}}))}))},i.addManifests=function(){return Vo(this.a)},i.updateManifestExpiration=function(e,t){var n=Bo(this.b,this.a),i=n.store();return i.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,i.put(n,e))},n.promise()},i.removeManifests=function(e,t){return qo(this,this.a,e,t)},i.getManifests=function(e){var t=this;return p((function n(){var i;return _(n,(function(n){switch(n.j){case 1:return x(n,zo(t,t.a,e),2);case 2:return i=n.s,n.return(i.map((function(e){return t.mc(e)})))}}))}))},i.getAllManifests=function(){var e=this;return p((function t(){var n,i;return _(t,(function(t){switch(t.j){case 1:return n=Fo(e.b,e.a,"readonly"),i=new Map,x(t,jo(n,(function(t,n){i.set(t,e.mc(n))})),2);case 2:return x(t,n.promise(),3);case 3:return t.return(i)}}))}))},i.Wd=function(e){return e},i.mc=function(e){return e},i.add=function(e,t){var n=this;return p((function i(){var r,a,o,s;return _(i,(function(i){switch(i.j){case 1:r=Bo(n.b,e),a=r.store(),o=[];for(var u=d(t),c=u.next();!c.done;c=u.next())s=c.value,a.add(s).onsuccess=function(e){o.push(e.target.result)};return x(i,r.promise(),2);case 2:return i.return(o)}}))}))},Go.prototype.destroy=function(){return this.a.destroy()},Go.prototype.getAll=function(){var e=this;return p((function t(){var n,i;return _(t,(function(t){switch(t.j){case 1:return n=Fo(e.a,"session-ids","readonly"),i=[],x(t,jo(n,(function(e,t){i.push(t)})),2);case 2:return x(t,n.promise(),3);case 3:return t.return(i)}}))}))},Go.prototype.add=function(e){for(var t=Bo(this.a,"session-ids"),n=t.store(),i=(e=d(e)).next();!i.done;i=e.next())n.add(i.value);return t.promise()},Go.prototype.remove=function(e){var t=this;return p((function n(){var i;return _(n,(function(n){switch(n.j){case 1:return x(n,jo(i=Bo(t.a,"session-ids"),(function(t,n,i){0<=e.indexOf(n.sessionId)&&i.delete()})),2);case 2:return x(n,i.promise(),0)}}))}))},Wo.prototype.destroy=function(){for(var e=[],t=d(this.a.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.a.clear(),Promise.all(e)},Wo.prototype.init=function(){var e=this;$o.forEach((function(t,n){var i=t();i?e.a.set(n,i):X.info("Skipping "+n+" as it is not supported on this platform")}));for(var t=[],n=d(this.a.values()),i=n.next();!i.done;i=n.next())t.push(i.value.init());return Promise.all(t)},Wo.prototype.erase=function(){var e=this;return p((function t(){var n,i;return _(t,(function(t){switch(t.j){case 1:return n=Array.from(e.a.values()),(i=0<n.length)||$o.forEach((function(e){(e=e())&&n.push(e)})),x(t,Promise.all(n.map((function(e){return e.erase()}))),2);case 2:if(!i)return x(t,Promise.all(n.map((function(e){return e.destroy()}))),0);t.C(0)}}))}))},H("shaka.offline.StorageMuxer.register",Yo),H("shaka.offline.StorageMuxer.unregister",(function(e){$o.delete(e)}));var $o=new Map;function Jo(e){Ho.apply(this,arguments)}function Qo(e){return function(e){var t=e.streams.filter((function(e){return"audio"==e.contentType})),n=e.streams.filter((function(e){return"video"==e.contentType}));if(!t.every((function(e){return e.variantIds}))||!n.every((function(e){return e.variantIds}))){t.forEach((function(e){e.variantIds=[]})),n.forEach((function(e){e.variantIds=[]}));var i=0;if(n.length&&!t.length){X.debug("Found video-only content. Creating variants for video.");var r=i++;n.forEach((function(e){e.variantIds.push(r)}))}if(!n.length&&t.length){X.debug("Found audio-only content. Creating variants for audio.");var a=i++;t.forEach((function(e){e.variantIds.push(a)}))}n.length&&t.length&&(X.debug("Found audio-video content. Creating variants."),t.forEach((function(e){n.forEach((function(t){var n=i++;e.variantIds.push(n),t.variantIds.push(n)}))})))}}(e),e.streams.forEach((function(){})),{startTime:e.startTime,streams:e.streams.map(Zo)}}function Zo(e){var t=e.initSegmentUri?ts(e.initSegmentUri):null;return{id:e.id,originalId:null,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(es),variantIds:e.variantIds}}function es(e){var t=ts(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function ts(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new he(2,9,9004,"Could not parse uri "+e)}function ns(e,t,n,i){Ho.call(this,e,t,n),this.f=i}function is(){this.g=this.c=this.b=this.a=this.f=null}function rs(e,t,n,i){this.a=e,this.g=t,this.f=n,this.c=i,this.b=["offline:",e,"/",t,"/",n,"/",i].join("")}function as(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new rs(t,n,i,Number(e[4])):null}function os(e,t){this.b=e,this.a=t}function ss(e,t,n){var i=t.streams.filter((function(e){return"audio"==e.contentType})),r=t.streams.filter((function(e){return"video"==e.contentType}));return i=function(e,t,n){for(var i=new Set,r=d(t),a=r.next();!a.done;a=r.next()){var o=d(a.value.variantIds);for(a=o.next();!a.done;a=o.next())i.add(a.value)}for(r=d(n),a=r.next();!a.done;a=r.next())for(o=d(a.value.variantIds),a=o.next();!a.done;a=o.next())i.add(a.value);for(r=new Map,i=d(i),a=i.next();!a.done;a=i.next())a=a.value,r.set(a,{id:a,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(t=d(t),i=t.next();!i.done;i=t.next())for(i=i.value,a=us(e,i),o=d(i.variantIds),i=o.next();!i.done;i=o.next())(i=r.get(i.value)).language=a.language,i.primary=i.primary||a.primary,i.audio=a;for(n=d(n),t=n.next();!t.done;t=n.next())for(i=t.value,t=us(e,i),a=d(i.variantIds),i=a.next();!i.done;i=a.next())(i=r.get(i.value)).primary=i.primary||t.primary,i.video=t;return r}(e,i,r),r=t.streams.filter((function(e){return"text"==e.contentType})).map((function(t){return us(e,t)})),t.streams.forEach((function(i){i=i.segments.map((function(t,n){return cs(e,n,t)})),n.Eb(i,t.startTime)})),{startTime:t.startTime,variants:Array.from(i.values()),textStreams:r}}function us(e,t){var n=t.segments.map((function(t,n){return cs(e,n,t)})),i=new Ji(n);return n={id:t.id,originalId:t.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return i.find(e)},getSegmentReference:function(e){return i.get(e)},initSegmentReference:null,presentationTimeOffset:t.presentationTimeOffset,mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate||void 0,pixelAspectRatio:t.pixelAspectRatio||void 0,kind:t.kind,encrypted:t.encrypted,keyId:t.keyId,language:t.language,label:t.label||null,type:t.contentType,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},null!=t.initSegmentKey&&(n.initSegmentReference=function(e,t){var n=new rs("segment",e.b,e.a,t);return new Xi((function(){return[n.toString()]}),0,null)}(e,t.initSegmentKey)),n}function cs(e,t,n){var i=new rs("segment",e.b,e.a,n.dataKey);return new Yi(t,n.startTime,n.endTime,(function(){return[i.toString()]}),0,null)}function ls(){this.a=null}function fs(e){var t=as(e);return t&&"manifest"==t.a?fs.h(e):t&&"segment"==t.a?fs.i(t.key(),t):ge(new he(2,1,9004,e))}function ds(e,t,n){return p((function i(){var r,a,o,s,u,c;return _(i,(function(i){switch(i.j){case 1:r=[];for(var l=[],f=d(n),h=f.next();!h.done;h=f.next()){h=h.value;for(var m=!1,g=d(l),v=g.next();!v.done;v=g.next())if(hs((v=v.value).info,h)){v.sessionIds.push(h.sessionId),m=!0;break}m||l.push({info:h,sessionIds:[h.sessionId]})}a=d(l),o=a.next();case 2:if(o.done){i.C(4);break}return s=o.value,u=function(e,t,n){return p((function i(){var r,a,o,s;return _(i,(function(i){switch(i.j){case 1:return r=new dt({Db:t,onError:function(){},yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),A(i,2),r.configure(e),x(i,function(e,t,n,i,r,a){var o=new Map;return o.set(t,{audioCapabilities:r,videoCapabilities:a,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t,drmInfos:[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:i,initData:null,keyIds:null}]}),wt(e,o)}(r,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:I(i,3);break;case 2:return a=P(i),X.m("Error initializing EME",a),x(i,r.destroy(),5);case 5:return i.return([]);case 3:return A(i,6),x(i,mt(r),8);case 8:I(i,7);break;case 6:return o=P(i),X.m("Error setting server certificate",o),x(i,r.destroy(),9);case 9:return i.return([]);case 7:return s=[],x(i,Promise.all(n.sessionIds.map((function(e){return p((function t(){var n;return _(t,(function(t){switch(t.j){case 1:return A(t,2),x(t,function(e,t){return p((function n(){var i,r,a;return _(n,(function(n){switch(n.j){case 1:return x(n,Tt(e,t),2);case 2:return(i=n.s)?(r=[],(a=e.b.get(i))&&(a.Ca=new pe,r.push(a.Ca)),X.J("Attempting to remove session",t),r.push(i.remove()),x(n,Promise.all(r),0)):(X.J("Ignoring attempt to remove missing session",t),n.return())}}))}))}(r,e),4);case 4:s.push(e),I(t,0);break;case 2:n=P(t),X.m("Error deleting offline session",n),k(t)}}))}))}))),10);case 10:return x(i,r.destroy(),11);case 11:return i.return(s)}}))}))}(e,t,s),x(i,u,5);case 5:c=i.s,r=r.concat(c),o=a.next(),i.C(2);break;case 4:return i.return(r)}}))}))}function hs(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Me(e.audioCapabilities,t.audioCapabilities,n)&&Me(e.videoCapabilities,t.videoCapabilities,n)}function ps(e,t){var n={Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null},i=this;this.h=t,this.c=e,this.f=n,this.i=null,this.g=[],this.b=this.a=null,this.l=!0,this.o=Promise.resolve().then((function(){return function(e){return p((function t(){return _(t,(function(t){switch(t.j){case 1:if(e.l){if(0==e.g.length||e.a&&!e.a.$a)var n=!1;else{e.a&&(e.a.za.eb(),e.a=null);var i=(n=e.g.shift()).create(e.f);i?(n.za.Fb(),e.a={node:i.node,payload:i.payload,$a:i.$a,za:n.za}):n.za.zc(),n=!0}return n?n=Promise.resolve():e.a?n=function(e){return p((function t(){var n,i;return _(t,(function(t){switch(t.j){case 1:return e.c=e.h.sf(e.c,e.f,e.a.node,e.a.payload),A(t,2),e.b=e.h.Ze(e.c,e.f,e.a.payload),x(t,e.b.promise,4);case 4:e.b=null,e.c==e.a.node&&(e.a.za.xc(),e.a=null),I(t,0);break;case 2:return 7001==(n=P(t)).code?e.a.za.eb():e.a.za.onError(n),e.a=null,e.b=null,i=e,x(t,e.h.handleError(e.f,n),5);case 5:i.c=t.s,k(t)}}))}))}(e):(e.h.Of(e.c),e.i=new pe,n=e.i),x(t,n,1)}t.C(0)}}))}))}(i)}))}function ms(e,t){var n={Fb:function(){},xc:function(){},eb:function(){},onError:function(){},zc:function(){},Sg:function(){}};return e.g.push({create:t,za:n}),e.b&&e.b.abort(),gs(e),n}function gs(e){e.i&&(e.i.resolve(),e.i=null)}function vs(e){this.a=null;for(var t=0;t<e.textTracks.length;++t){var n=e.textTracks[t];n.mode="disabled","Shaka Player TextTrack"==n.label&&(this.a=n)}this.a||(this.a=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function ys(e){if(e.startTime>=e.endTime)return X.m("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function bs(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var i=e.cues,r=i.length-1;0<=r;r--){var a=i[r];a&&t(a)&&e.removeCue(a)}e.mode=n}function ws(e,t,n,i,r){var a,o=r in i,s=!0;for(a in t){var u=r+"."+a,c=o?i[r]:n[a];o||a in n?void 0===t[a]?void 0===c||o?delete e[a]:e[a]=xe(c):c.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=xe(c)),u=ws(e[a],t[a],c,i,u),s=s&&u):typeof t[a]!=typeof c||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=c.constructor?(X.jc("Invalid config, wrong type for "+u),s=!1):("function"==typeof n[a]&&n[a].length!=t[a].length&&X.Z("Unexpected number of arguments for "+u),e[a]=t[a]):(X.jc("Invalid config, unrecognized key "+u),s=!1)}return s}function Ts(e,t){for(var n={},i=n,r=0,a=0;!(0>(r=e.indexOf(".",r)));)0!=r&&"\\"==e[r-1]||(i[a=e.substring(a,r).replace(/\\\./g,".")]={},i=i[a],a=r+1),r+=1;return i[e.substring(a).replace(/\\\./g,".")]=t,n}function Ss(){}function Es(){var e=5e5,t=1/0;navigator.connection&&(navigator.connection.downlink&&(e=1e6*navigator.connection.downlink),navigator.connection.saveData&&(t=360));var n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:St,fairPlayTransform:!0,updateExpirationTime:1},i={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},failureCallback:function(e){return X.error("Unhandled streaming error",e),[e]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};(et("Web0S")||et("Tizen")||et("CrKey"))&&(r.stallSkip=0);var a={trackSelectionCallback:function(e){return p((function t(){return _(t,(function(t){switch(t.j){case 1:return t.return(e)}}))}))},progressCallback:function(e,t){return[e,t]},usePersistentLicense:!0},o={drm:n,manifest:i,streaming:r,offline:a,abrFactory:_n,abr:{enabled:!0,defaultBandwidthEstimate:e,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return a.trackSelectionCallback=function(e){return p((function t(){return _(t,(function(t){switch(t.j){case 1:return t.return(function(e,t){var n=e.filter((function(e){return"variant"==e.type})),i=[],r=Dn(t,n.map((function(e){return e.language})));r&&(i=n.filter((function(e){return Rn(e.language)==r}))),0==i.length&&(i=n.filter((function(e){return e.primary}))),0==i.length&&(1<new Set(n.map((function(e){return e.language}))).size&&X.m("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),i=n);var a=i.filter((function(e){return e.height&&480>=e.height}));if(a.length&&(a.sort((function(e,t){return t.height-e.height})),i=a.filter((function(e){return e.height==a[0].height}))),n=[],i.length){var o=Math.floor(i.length/2);i.sort((function(e,t){return e.bandwidth-t.bandwidth})),n.push(i[o])}for(i=d(e),o=i.next();!o.done;o=i.next())"text"==(o=o.value).type&&n.push(o);return n}(e,o.preferredAudioLanguage))}}))}))},o}function xs(e,t,n){var i={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return ws(e,t,n||Es(),i,"")}function ks(){this.a=null,this.b=[]}function As(e,t){if(null==e.a)e.a={timestamp:Date.now()/1e3,state:t,duration:0};else{var n=Date.now()/1e3;e.a.duration=n-e.a.timestamp,e.a.state!=t&&(e.b.push(e.a),e.a={timestamp:n,state:t,duration:0})}}function Ms(e,t){var n=0;e.a&&e.a.state==t&&(n+=e.a.duration);for(var i=d(e.b),r=i.next();!r.done;r=i.next())n+=(r=r.value).state==t?r.duration:0;return n}function Is(){this.b=this.c=null,this.a=[]}function Ps(){this.f=this.u=this.h=this.b=this.i=this.l=this.o=this.g=this.v=NaN,this.a=new ks,this.c=new Is}function Cs(t,n){var i=this;Ee.call(this),this.i=bu,this.a=null,this.ob=!1,this.g=new Oe,this.Lc=this.l=this.Ob=this.c=this.u=this.f=this.ec=this.F=this.fc=this.H=this.qb=this.o=this.G=this.h=this.T=null,this.ke=1e9,this.hc=new Set,this.sb=!0,this.sa=null,this.je=!1,this.ge=0,this.ra=null,this.ea=new la,this.b=Hs(this),this.ic={width:1/0,height:1/0},this.v=null,this.Pb=new ba(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount),this.qa=this.b.preferredTextLanguage,this.nb=this.b.preferredTextRole,this.Mc=[],n&&n(this),this.T=function(e){return new Ce((function(t,n){e.l&&e.l.segmentDownloaded(t,n)}))}(this),this.g.B(e,"online",(function(){i.Cd()})),this.K={name:"detach"},this.V={name:"attach"},this.Ma={name:"unload"},this.Zc={name:"manifest-parser"},this.Uc={name:"manifest"},this.pb={name:"media-source"},this.Nc={name:"drm-engine"},this.$={name:"load"},this.dd={name:"src-equals-drm-engine"},this.rb={name:"src-equals"};var r=new Map;r.set(this.V,(function(e,t){return be(function(e,t,n){return null==t.w&&(t.w=n.w,e.g.B(t.w,"error",(function(){var t=au(e);t&&e.Ra(t)}))),e.a=t.w,Promise.resolve()}(i,e,t))})),r.set(this.K,(function(e){return e.w&&(i.g.pa(e.w,"error"),e.w=null),i.a=null,be(e=Promise.resolve())})),r.set(this.Ma,(function(e){return be(Ls(i,e))})),r.set(this.pb,(function(t){return be(t=function(t,n){return p((function i(){var r,a,o,s;return _(i,(function(i){switch(i.j){case 1:return r=e.muxjs?new Dt:new Lt,a=t.b.textDisplayFactory,o=new a,t.Rc=a,x(i,(s=new mn(n.w,r,o)).u,2);case 2:t.G=s,k(i)}}))}))}(i,t))})),r.set(this.Zc,(function(e,t){return be(function(e,t,n){return p((function i(){var r,a,o,s;return _(i,(function(i){switch(i.j){case 1:if(t.Ea=n.Ea,t.mimeType=n.mimeType,t.uri=n.uri,r=t.uri,a=e.T,e.Ob=r,t.Ea){e.u=t.Ea(),i.C(2);break}return o=e,x(i,hr.create(r,a,e.b.manifest.retryParameters,t.mimeType),3);case 3:o.u=i.s;case 2:s=xe(e.b.manifest),n.w&&"AUDIO"===n.w.nodeName&&(s.disableVideo=!0),e.u.configure(s),k(i)}}))}))}(i,e,t))})),r.set(this.Uc,(function(e){return function(e,t){var n=t.uri,i=e.T;e.ec=new $a((function(){return e.Be()})),function(e,t){e.b=t}(e.ec,(function(t){ru(e,"timelineregionadded",t)}));var r={networkingEngine:i,filterNewPeriod:function(t){return e.Vc(t)},filterAllPeriods:function(t){return Vs(e,t)},onTimelineRegionAdded:function(t){var n=e.ec;e:{for(var i=d(n.a),r=i.next();!r.done;r=i.next())if((r=r.value).schemeIdUri==t.schemeIdUri&&r.id==t.id&&r.startTime==t.startTime&&r.endTime==t.endTime){i=r;break e}i=null}null==i&&(n.a.add(t),n.b(t))},onEvent:function(t){return e.dispatchEvent(t)},onError:function(t){return e.Ra(t)}};return new me(Promise.resolve().then((function(){return p((function t(){var i;return _(t,(function(t){switch(t.j){case 1:return i=e,x(t,e.u.start(n,r),2);case 2:if(i.c=t.s,e.dispatchEvent(new Te("manifestparsed")),0==e.c.periods.length)throw new he(2,4,4014);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.some((function(e){return e.variants.some(t)}))&&(X.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),e.forEach((function(e){e.variants=e.variants.filter(t)})))}(e.c.periods),k(t)}}))}))})),(function(){return X.info("Aborting parser step..."),e.u.stop()}))}(i,e)})),r.set(this.Nc,(function(){return be(function(e){return p((function t(){return _(t,(function(t){switch(t.j){case 1:return e.h=Us(e,{Db:e.T,onError:function(t){e.Ra(t)},yc:function(t){ou(e,t)},onExpirationUpdated:function(t,n){su(e,t,n)},onEvent:function(t){e.dispatchEvent(t)}}),e.h.configure(e.b.drm),x(t,ht(e.h,Ra(e.c.periods),e.c.offlineSessionIds),2);case 2:Vs(e,e.c.periods),k(t)}}))}))}(i))})),r.set(this.$,(function(e,t){return be(function(e,t,n){return p((function i(){var r,a,o,s,u,c,l,f,h,p;return _(i,(function(i){switch(i.j){case 1:return t.startTime=n.startTime,r=t.w,a=t.uri,e.Ob=a,e.H=new La({rc:function(){return t.w.playbackRate},Id:function(e){t.w.playbackRate=e},le:function(e){t.w.currentTime+=e}}),e.v=new Ps,o=function(){return Xs(e)},s=function(){return Ws(e)},e.g.B(r,"playing",o),e.g.B(r,"pause",o),e.g.B(r,"ended",o),e.g.B(r,"ratechange",s),u=e.b.abrFactory,e.l&&e.Lc==u||(e.Lc=u,e.l=new u,e.l.configure(e.b.abr)),function(e,t){for(var n=0;n<t.length;n++){for(var i=t[n],r=new Map,a=d(i.variants),o=a.next();!o.done;o=a.next())if((o=o.value).video&&o.video.closedCaptions)for(var s=d((o=o.video).closedCaptions.keys()),u=s.next();!u.done;u=s.next())if(u=u.value,!r.has(u)){var c={id:e.ke++,originalId:u,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:o.closedCaptions.get(u),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:o.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};r.set(u,c)}for(r=d(r.values()),a=r.next();!a.done;a=r.next())i.textStreams.push(a.value)}}(e,e.c.periods),e.Pb=new ba(e.b.preferredAudioLanguage,e.b.preferredVariantRole,e.b.preferredAudioChannelCount),e.qa=e.b.preferredTextLanguage,function(e,t,n){0<t&&(e.X()?X.m("|playRangeStart| has been configured for live content. Ignoring the setting."):e.Ee(t)),n<e.ca()&&(e.X()?X.m("|playRangeEnd| has been configured for live content. Ignoring the setting."):e.Ba(n))}(e.c.presentationTimeline,e.b.playRangeStart,e.b.playRangeEnd),x(i,e.h.Qb(r),2);case 2:return e.l.init((function(t,n,i){n=void 0!==n&&n,i=void 0===i?0:i,X.debug("switch_");e:{for(var r=d(e.c.periods),a=r.next();!a.done;a=r.next())if((a=a.value).variants.includes(t)){r=a;break e}r=null}Bs(e,r,t,!0),e.f&&so(e.f,t,n,i)&&Qs(e)})),e.o=function(e,t){return new Ga(e.a,e.c,e.b.streaming,t,(function(){e.qb&&Ca(e.qb,!0),e.f&&function(e){function t(t){var r=e.a.O;return"text"==t?t=null!=(t=r.a).a&&null!=t.b&&(n>=t.a&&n<t.b):t=_t(t=Sn(r,t),n,i),t}var n=e.a.Za(),i=e.g.smallGapLimit,r=!1,a=So(e,n);if(Ve(e.b.values(),(function(e){return e.ka==a})))for(var o=d(e.b.keys()),s=o.next();!s.done;s=o.next())t(s=s.value)||(co(e,e.b.get(s)),r=!0);else Ve(e.b.keys(),t)||(X.debug("(all): seeked: unbuffered seek: clearing all buffers"),e.b.forEach((function(t){co(e,t)})),r=!0);r||X.debug("(all): seeked: buffered seek: presentationTime="+n)}(e.f),e.F&&Os(e)}),(function(t){return e.dispatchEvent(t)}))}(e,t.startTime),e.qb=function(e){var t=new Da(e.c);!function(e,t){e.b=t}(t,(function(){Zs(e)}));var n=new Ja(e.ec);!function(e,t,n,i){e.a=t,e.b=n,e.c=i}(n,(function(t){ru(e,"timelineregionenter",t)}),(function(t){ru(e,"timelineregionexit",t)}),(function(t,n){n||(ru(e,"timelineregionenter",t),ru(e,"timelineregionexit",t))}));var i=new Pa(e.a);return i.a.add(t),i.a.add(n),i}(e),c=Math.max(e.c.minBufferTime,e.b.streaming.rebufferingGoal),_s(e,c),e.f=function(e){return new to(e.c,{Za:function(){return e.o.g()},getBandwidthEstimate:function(){return e.l.getBandwidthEstimate()},O:e.G,Db:e.T,oe:e.Mf.bind(e),ne:e.Te.bind(e),onError:e.Ra.bind(e),onEvent:function(t){return e.dispatchEvent(t)},Qf:e.Rf.bind(e),td:e.Wf.bind(e)})}(e),e.f.configure(e.b.streaming),Un.Vd(e.c,e.b.preferredAudioChannelCount),e.i=wu,e.dispatchEvent(new Te("streaming")),x(i,e.f.start(),3);case 3:e.b.streaming.startAtSegmentBoundary&&(l=e.o.g(),f=function(e,t){function n(e,t){if(!e)return null;var n=e.findSegmentPosition(t-a.startTime);return null==n?null:(n=e.getSegmentReference(n))?n.startTime+a.startTime:null}var i=no(e.f),r=io(e.f),a=hu(e);return i=n(i,t),null!=(r=n(r,t))&&null!=i?Math.max(r,i):null!=r?r:null!=i?i:t}(e,l),e.o.o(f)),e.c.periods.forEach(e.Vc.bind(e)),Zs(e),Qs(e),h=hu(e)||e.c.periods[0],p=h.variants.some((function(e){return e.primary})),e.b.preferredAudioLanguage||p||X.m("No preferred audio language set.  We will choose an arbitrary language initially"),Ys(e,h.variants),e.g.ua(r,"loadedmetadata",(function(){e.v.b=Date.now()/1e3-n.Ld})),k(i)}}))}))}(i,e,t))})),r.set(this.dd,(function(e){return be(e=function(e,t){return p((function n(){var i,r;return _(n,(function(n){switch(n.j){case 1:return i=Ht,e.h=Us(e,{Db:e.T,onError:function(t){e.Ra(t)},yc:function(t){ou(e,t)},onExpirationUpdated:function(t,n){su(e,t,n)},onEvent:function(t){e.dispatchEvent(t)}}),e.h.configure(e.b.drm),r={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:i.Ua,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},x(n,ht(e.h,[r],[]),2);case 2:return x(n,e.h.Qb(t.w),0)}}))}))}(i,e))})),r.set(this.rb,(function(e,t){return function(e,t,n){function i(){return Xs(e)}if(t.uri=n.uri,t.startTime=n.startTime,e.Ob=t.uri,e.v=new Ps,e.o=new za(t.w),null!=t.startTime&&e.o.o(t.startTime),e.H=new La({rc:function(){return t.w.playbackRate},Id:function(e){t.w.playbackRate=e},le:function(e){t.w.currentTime+=e}}),_s(e,e.b.streaming.rebufferingGoal),e.g.B(t.w,"playing",i),e.g.B(t.w,"pause",i),e.g.B(t.w,"ended",i),e.g.B(t.w,"ratechange",(function(){return Ws(e)})),"none"!=e.a.preload&&e.g.ua(t.w,"loadedmetadata",(function(){e.v.b=Date.now()/1e3-n.Ld})),e.a.audioTracks&&(e.g.B(e.a.audioTracks,"addtrack",(function(){return Zs(e)})),e.g.B(e.a.audioTracks,"removetrack",(function(){return Zs(e)})),e.g.B(e.a.audioTracks,"change",(function(){return Zs(e)}))),e.a.textTracks){var r=e.a.textTracks;e.g.B(r,"addtrack",(function(){return Zs(e)})),e.g.B(r,"removetrack",(function(){return Zs(e)})),e.g.B(r,"change",(function(){return Zs(e)}))}t.w.src=t.uri,(et("Tizen")||et("Web0S"))&&t.w.load(),e.i=Tu,e.dispatchEvent(new Te("streaming"));var a=new pe;_a(e.a,HTMLMediaElement.HAVE_METADATA,e.g,(function(){a.resolve()}));var o=!1;return e.Mc.push((function(){o=!0})),_a(e.a,HTMLMediaElement.HAVE_CURRENT_DATA,e.g,(function(){return p((function t(){return _(t,(function(t){switch(t.j){case 1:if(o)return t.return();if(function(e){var t=e.b.preferredAudioLanguage;if(""!=t){e.Dd(t);var n=e.b.preferredVariantRole;""!=n&&e.Dd(t,n)}}(e),Ks(e).find((function(e){return"disabled"!=e.mode}))){t.C(2);break}return x(t,new Promise((function(t){e.g.ua(e.a.textTracks,"change",t),new le(t).R(1)})),2);case 2:if(o)return t.return();!function(e){var t=e.b.preferredTextLanguage;if(""!=t){e.Ed(t);var n=e.b.preferredTextRole;""!=n&&e.Ed(t,n)}}(e),k(t)}}))}))})),e.a.error?a.reject(au(e)):"none"==e.a.preload&&(X.Z('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),a.resolve()),e.g.ua(e.a,"error",(function(){a.reject(au(e))})),new me(a,(function(){return a.reject(new he(2,7,7001)),Promise.resolve()}))}(i,e,t)})),this.Ta=new ps(this.K,{sf:function(e,t,n,r){var a=null;return e==i.K&&(a=n==i.K?i.K:i.V),e==i.V&&(a=n==i.K||t.w!=r.w?i.K:n==i.V?i.V:n==i.pb||n==i.$?i.pb:n==i.rb?i.dd:null),e==i.pb&&(a=n==i.$&&t.w==r.w?i.Zc:i.Ma),e==i.Zc&&(a=gu(i.$,i.Uc,i.Ma,n,t,r)),e==i.Uc&&(a=gu(i.$,i.Nc,i.Ma,n,t,r)),e==i.Nc&&(a=gu(i.$,i.$,i.Ma,n,t,r)),e==i.dd&&(a=n==i.rb&&t.w==r.w?i.rb:i.Ma),e!=i.$&&e!=i.rb||(a=i.Ma),e==i.Ma&&(a=r.w&&t.w==r.w?i.V:i.K),a},Ze:function(e,t,n){return i.dispatchEvent(new Te("onstatechange",{state:e.name})),r.get(e)(t,n)},handleError:function(e,t){return p((function n(){return _(n,(function(n){switch(n.j){case 1:return X.m("The walker saw an error:"),t instanceof he?X.m("Error Code:",t.code):(X.m("Error Message:",t.message),X.m("Error Stack:",t.stack)),x(n,Ls(i,e),2);case 2:return n.return(e.w?i.V:i.K)}}))}))},Of:function(e){i.dispatchEvent(new Te("onstateidle",{state:e.name}))}}),t&&this.Qb(t,!0)}w(Jo,Ho),Jo.prototype.updateManifestExpiration=function(e,t){var n=Bo(this.b,this.a),i=n.store(),r=new pe;return i.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,i.put(n),r.resolve()):r.reject(new he(2,9,9012,"Could not find values for "+e))},n.promise().then((function(){return r}))},Jo.prototype.mc=function(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(Qo),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}},Jo.prototype.Wd=function(e){return{data:e.data}},w(ns,Ho),ns.prototype.hasFixedKeySpace=function(){return this.f},ns.prototype.addSegments=function(e){return this.f?Vo(this.c):this.add(this.c,e)},ns.prototype.addManifests=function(e){return this.f?Vo(this.a):this.add(this.a,e)},ns.prototype.mc=function(e){return null==e.expiration&&(e.expiration=1/0),e},(i=is.prototype).init=function(){var t=this,n=new pe,i=e.indexedDB.open("shaka_offline_db",4);return i.onsuccess=function(e){e=e.target.result,t.f=e;var i=e.objectStoreNames;i.contains("manifest")&&i.contains("segment")?(X.debug("Mounting v1 idb storage cell"),i=new Jo(e,"segment","manifest")):i=null,t.a=i,(i=e.objectStoreNames).contains("manifest-v2")&&i.contains("segment-v2")?(X.debug("Mounting v2 idb storage cell"),i=new ns(e,"segment-v2","manifest-v2",!0)):i=null,t.b=i,(i=e.objectStoreNames).contains("manifest-v3")&&i.contains("segment-v3")?(X.debug("Mounting v3 idb storage cell"),i=new ns(e,"segment-v3","manifest-v3",!1)):i=null,t.c=i,e.objectStoreNames.contains("session-ids")?(X.debug("Mounting session ID idb storage cell"),e=new Go(e)):e=null,t.g=e,n.resolve()},i.onupgradeneeded=function(e){e=e.target.result;for(var t=d(["segment-v3","manifest-v3","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},i.onerror=function(e){n.reject(new he(2,9,9001,i.error)),e.preventDefault()},n},i.destroy=function(){var e=this;return p((function t(){return _(t,(function(t){switch(t.j){case 1:if(!e.a){t.C(2);break}return x(t,e.a.destroy(),2);case 2:if(!e.b){t.C(4);break}return x(t,e.b.destroy(),4);case 4:if(!e.c){t.C(6);break}return x(t,e.c.destroy(),6);case 6:if(!e.g){t.C(8);break}return x(t,e.g.destroy(),8);case 8:e.f&&e.f.close(),k(t)}}))}))},i.getCells=function(){var e=new Map;return this.a&&e.set("v1",this.a),this.b&&e.set("v2",this.b),this.c&&e.set("v3",this.c),e},i.getEmeSessionCell=function(){return this.g},i.erase=function(){var t=this;return p((function n(){return _(n,(function(n){switch(n.j){case 1:if(!t.a){n.C(2);break}return x(n,t.a.destroy(),2);case 2:if(!t.b){n.C(4);break}return x(n,t.b.destroy(),4);case 4:if(!t.c){n.C(6);break}return x(n,t.c.destroy(),6);case 6:return t.f&&t.f.close(),x(n,function(){var t=new pe,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){X.m("Deleting","shaka_offline_db","is being blocked")},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new he(2,9,9001,n.error)),e.preventDefault()},t}(),8);case 8:return t.f=null,t.a=null,t.b=null,t.c=null,x(n,t.init(),0)}}))}))},Yo("idb",(function(){return et("CrKey")||!e.indexedDB?null:new is})),rs.prototype.Aa=function(){return this.g},rs.prototype.fa=function(){return this.f},rs.prototype.key=function(){return this.c},rs.prototype.toString=function(){return this.b},(i=ls.prototype).configure=function(){},i.start=function(e){var t=this;return p((function n(){var i,r,a,o,s;return _(n,(function(n){switch(n.j){case 1:return i=as(e),t.a=i,null==i||"manifest"!=i.a?n.return(Promise.reject(new he(2,1,9004,i))):(r=new Wo,M(n,2),x(n,r.init(),4));case 4:return x(n,Xo(r,i.Aa(),i.fa()),5);case 5:return x(n,n.s.getManifests([i.key()]),6);case 6:return a=n.s,o=a[0],s=new os(i.Aa(),i.fa()),n.return(function(e,t){var n=new pr(null,0);n.Ba(t.duration);var i=t.periods.map((function(t){return ss(e,t,n)})),r=t.drmInfo?[t.drmInfo]:[];return t.drmInfo&&i.forEach((function(e){e.variants.forEach((function(e){e.drmInfos=r}))})),{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,periods:i}}(s,o));case 2:return C(n),x(n,r.destroy(),7);case 7:R(n,0)}}))}))},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var n=this;return p((function i(){var r,a,o,s,u,c,l,f;return _(i,(function(i){switch(i.j){case 1:return r=n.a,a=new Wo,A(i,2,3),x(i,a.init(),5);case 5:return x(i,Xo(a,r.Aa(),r.fa()),6);case 6:return x(i,(o=i.s).getManifests([r.key()]),7);case 7:if(s=i.s,u=s[0],c=u.sessionIds.includes(e),l=null==u.expiration||u.expiration>t,!c||!l){i.C(3);break}return X.debug("Updating expiration for stored content"),x(i,o.updateManifestExpiration(r.key(),t),3);case 3:return C(i),x(i,a.destroy(),10);case 10:R(i,0);break;case 2:f=P(i),X.error("There was an error updating",r,f),i.C(3)}}))}))},hr.Lb("application/x-offline-manifest",ls),H("shaka.offline.OfflineScheme",fs),fs.h=function(e){return ye(e={uri:e,vd:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},fs.i=function(e,t){var n=new Wo;return ye(void 0).Y((function(){return n.init()})).Y((function(){return Xo(n,t.Aa(),t.fa())})).Y((function(e){return e.getSegments([t.key()])})).Y((function(e){return{uri:t,vd:t,data:e[0].data,headers:{}}})).finally((function(){return n.destroy()}))},Ne("offline",fs),ps.prototype.destroy=function(){var e=this;return p((function t(){return _(t,(function(t){switch(t.j){case 1:return e.l=!1,e.b&&e.b.abort(),gs(e),x(t,e.o,2);case 2:e.a&&e.a.za.eb();for(var n=d(e.g),i=n.next();!i.done;i=n.next())i.value.za.eb();e.a=null,e.g=[],e.h=null,k(t)}}))}))},H("shaka.text.SimpleTextDisplayer",vs),vs.prototype.remove=function(e,t){return!!this.a&&(bs(this.a,(function(n){return n.startTime<t&&n.endTime>e})),!0)},vs.prototype.remove=vs.prototype.remove,vs.prototype.append=function(e){var t=ys,n=e.map((function(e){if(e.nestedCues.length){var t=e.nestedCues.map((function(e){return e.spacer?"\n":e.payload+" "})).join("").replace(/ $/m,"");(e=e.clone()).nestedCues=[],e.payload=t}return e})),i=[];e=this.a.cues?Array.from(this.a.cues):[];for(var r={},a=(n=d(n)).next();!a.done;r={Ab:r.Ab},a=n.next())r.Ab=a.value,e.some(function(e){return function(t){return t.startTime==e.Ab.startTime&&t.endTime==e.Ab.endTime&&t.text==e.Ab.payload}}(r))||(a=t(r.Ab))&&i.push(a);i.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?i.indexOf(t)-i.indexOf(e):i.indexOf(e)-i.indexOf(t)})).forEach(function(e){this.a.addCue(e)}.bind(this))},vs.prototype.append=vs.prototype.append,vs.prototype.destroy=function(){return this.a&&bs(this.a,(function(){return!0})),this.a=null,Promise.resolve()},vs.prototype.destroy=vs.prototype.destroy,vs.prototype.isTextVisible=function(){return"showing"==this.a.mode},vs.prototype.isTextVisible=vs.prototype.isTextVisible,vs.prototype.setTextVisibility=function(e){this.a.mode=e?"showing":"hidden"},vs.prototype.setTextVisibility=vs.prototype.setTextVisibility,H("shaka.util.ConfigUtils.mergeConfigObjects",ws),H("shaka.util.ConfigUtils.convertToConfigObject",Ts),H("shaka.util.PlayerConfiguration",Ss),Ss.mergeConfigObjects=xs,V(Cs,Ee),H("shaka.Player",Cs),Cs.prototype.destroy=function(){var e=this;return p((function t(){var n;return _(t,(function(t){switch(t.j){case 1:return e.i==yu?t.return():(e.i=yu,n=ms(e.Ta,(function(){return{node:e.K,payload:{Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null},$a:!1}})),x(t,new Promise((function(t){n.Fb=function(){X.info("Preparing to destroy walker...")},n.xc=function(){t(),e.dispatchEvent(new Te("loaded"))},n.eb=function(){t()},n.onError=function(){t()},n.zc=function(){t()}})),2));case 2:return x(t,e.Ta.destroy(),3);case 3:if(e.g&&(e.g.release(),e.g=null),e.Lc=null,e.l=null,e.b=null,!e.T){t.C(0);break}return x(t,e.T.destroy(),5);case 5:e.T=null,k(t)}}))}))},Cs.prototype.destroy=Cs.prototype.destroy,Cs.version="v2.5.17";var Rs=["2","5"];Hn=new function(e){this.a=e,this.c=Bn,this.b=Fn}(new jn(Number(Rs[0]),Number(Rs[1])));var Ns=["output-restricted","internal-error"],Ds={};function Ls(e,t){return p((function n(){var i;return _(n,(function(n){switch(n.j){case 1:return e.i!=yu&&(e.i=bu),i=e.Mc.map((function(e){return e()})),e.Mc=[],x(n,Promise.all(i),2);case 2:if(e.dispatchEvent(new Te("unloading")),t.Ea=null,t.mimeType=null,t.startTime=null,t.uri=null,t.w&&(e.g.pa(t.w,"loadedmetadata"),e.g.pa(t.w,"playing"),e.g.pa(t.w,"pause"),e.g.pa(t.w,"ended"),e.g.pa(t.w,"ratechange")),e.qb&&(e.qb.release(),e.qb=null),e.fc&&(e.fc.stop(),e.fc=null),!e.u){n.C(3);break}return x(n,e.u.stop(),4);case 4:e.u=null;case 3:if(!e.l){n.C(5);break}return x(n,e.l.stop(),5);case 5:if(!e.f){n.C(7);break}return x(n,e.f.destroy(),8);case 8:e.f=null;case 7:if(e.H&&(e.H.release(),e.H=null),e.o&&(e.o.release(),e.o=null),!e.G){n.C(9);break}return x(n,e.G.destroy(),10);case 10:e.G=null;case 9:if(!t.w||!t.w.src){n.C(11);break}return x(n,new Promise((function(e){return new le(e).R(.1)})),12);case 12:t.w.removeAttribute("src"),t.w.load();case 11:if(!e.h){n.C(13);break}return x(n,e.h.destroy(),14);case 14:e.h=null;case 13:e.ea.a.clear(),e.Ob=null,e.F=null,e.hc.clear(),e.c=null,e.v=null,e.Rc=null,e.sb=!0,Gs(e),k(n)}}))}))}function Us(e,t){return new dt(t,e.b.drm.updateExpirationTime)}function _s(e,t){e.F=new wa,e.F.a=Sa,Ta(e.F,t,Math.min(.5,t/2)),Gs(e),e.fc=new le((function(){Os(e)})).Ka(.25)}function Os(e){switch(e.i){case Tu:var t=!!e.a.ended||Ut(e.a.buffered)>=e.a.duration-1;break;case wu:e:if(e.a.ended||bn(e.G))t=!0;else{if(e.c.presentationTimeline.X()){var n=e.c.presentationTimeline.xb();if(Ut(e.a.buffered)>=n){t=!0;break e}}t=!1}break;default:t=!1}var i=Ot(e.a.buffered,e.a.currentTime),r=t,a=(n=e.F).b.get(n.a);t=n.a,i=r||i>=a?Ea:Sa,n.a=i,t!=i&&Gs(e)}function js(e){if(e.u){var t=xe(e.b.manifest);e.a&&"AUDIO"===e.a.nodeName&&(t.disableVideo=!0),e.u.configure(t)}if(e.h&&e.h.configure(e.b.drm),e.f){e.f.configure(e.b.streaming);try{e.c.periods.forEach(e.Vc.bind(e))}catch(t){e.Ra(t)}var n=no(e.f),i=io(e.f);t=hu(e),n=Un.ce(n,i,t.variants),e.l&&n&&n.allowedByApplication&&n.allowedByKeySystem?Ys(e,t.variants):(X.debug("Choosing new streams after changing configuration"),$s(e,t))}if(e.G&&(t=e.b.textDisplayFactory,e.Rc!=t)){n=new t;var r=(i=e.G).g;i.g=n,r&&(n.setTextVisibility(r.isTextVisible()),r.destroy()),i.a&&(i.a.c=n),e.Rc=t,e.f&&((n=(t=e.f).b.get("text"))&&uo(t,n.stream,!0,0,!0))}e.l&&(e.l.configure(e.b.abr),e.b.abr.enabled&&!e.sb?e.l.enable():e.l.disable(),iu(e)),e.F&&(t=e.b.streaming.rebufferingGoal,e.c&&(t=Math.max(t,e.c.minBufferTime)),Ta(e.F,t,Math.min(.5,t/2)))}function Ks(e){return Array.from(e.a.textTracks).filter((function(e){return"metadata"!=e.kind&&"Shaka Player TextTrack"!=e.label}))}function Bs(e,t,n,i){da(e.ea,t).variant=n,(e=e.v.c).c!=n&&(e.c=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"variant",fromAdaptation:i,bandwidth:n.bandwidth}))}function Fs(e,t,n,i){fa(e.ea,t,n),(e=e.v.c).b!=n&&(e.b=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"text",fromAdaptation:i,bandwidth:null}))}function Hs(e){var t=Es();return t.streaming.failureCallback=function(t){e.X()&&[1001,1002,1003].includes(t.code)&&(t.severity=1,X.m("Live streaming error.  Retrying automatically..."),e.Cd())},t.textDisplayFactory=function(){return new vs(e.a)},t}function Vs(e,t){var n=e.f?no(e.f):null,i=e.f?io(e.f):null;if(t.forEach(Un.filterNewPeriod.bind(null,e.h,n,i)),0==(n=function(e,t){var n=0;return e.forEach((function(e){n+=t(e)?1:0})),n}(t,(function(e){return e.variants.some(Un.Bb)}))))throw new he(2,4,4032);if(n<t.length)throw new he(2,4,4011);t.forEach(function(e){Un.Sd(e.variants,this.b.restrictions,this.ic)&&this.f&&hu(this)==e&&Zs(this),uu(this,e.variants)}.bind(e))}function qs(e,t,n,i){return n=void 0!==n&&n,i=void 0===i?0:i,e.sb?(e.sa=t,e.je=n,e.ge=i,!0):((t=so(e.f,t,n,i))&&eu(e),t)}function zs(e,t){if(e.sb)return e.ra=t,!0;var n=uo(e.f,t,!0,0,!1);return n&&tu(e),n}function Gs(e){var t=e.fd();if(e.v&&e.F&&e.o){var n=e.H;n.f=t,Ua(n),Xs(e)}e.dispatchEvent(new Te("buffering",{buffering:t}))}function Ws(e){var t=e.a.playbackRate;0!=t&&e.H.set(t)}function Xs(e){if(e.v&&e.F){var t=e.v.a;e.F.a==Sa?As(t,"buffering"):e.a.paused?As(t,"paused"):e.a.ended?As(t,"ended"):As(t,"playing")}}function Ys(e,t){try{uu(e,t)}catch(t){return e.Ra(t),null}var n=t.filter((function(e){return Un.Bb(e)}));return n=e.Pb.create(n),e.l.setVariants(Array.from(n.values())),e.l.chooseVariant()}function $s(e,t){var n=Js(e,t,!1),i=Un.Sb(t.textStreams,e.qa,e.nb)[0]||null,r=!1;i&&(e.b.streaming.alwaysStreamText||e.uc())&&(Fs(e,t,i,!0),r=zs(e,i)),(n||r)&&Qs(e)}function Js(e,t,n){n=void 0===n||n;var i=Ys(e,t.variants),r=!1;return i&&(Bs(e,t,i,!0),r=qs(e,i,!0)),n&&r&&Qs(e),r}function Qs(e){cu(e,new Te("adaptation"))}function Zs(e){cu(e,new Te("trackschanged"))}function eu(e){cu(e,new Te("variantchanged"))}function tu(e){cu(e,new Te("textchanged"))}function nu(e){cu(e,new Te("texttrackvisibility"))}function iu(e){cu(e,new Te("abrstatuschanged",{Rg:e.b.abr.enabled}))}function ru(e,t,n){e.dispatchEvent(new Te(t,{detail:{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}}))}function au(e){if(!e.a.error)return null;var t=e.a.error.code;if(1==t)return null;var n=e.a.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new he(2,3,3016,t,n,e.a.error.message)}function ou(e,t){if(e.f){var n=hu(e),i=!1,r=Object.keys(t);0==r.length&&X.m("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var a=1==r.length&&"00"==r[0];a&&X.m("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),r.length&&e.c.periods.forEach((function(e){e.variants.forEach((function(e){Un.Cf(e).forEach((function(n){var r=e.allowedByKeySystem;n.keyId&&(n=t[a?"00":n.keyId],e.allowedByKeySystem=!!n&&!Ns.includes(n)),r!=e.allowedByKeySystem&&(i=!0)}))}))})),r=no(e.f);var o=io(e.f);(r=Un.ce(r,o,n.variants))&&!r.allowedByKeySystem&&(X.debug("Choosing new variants after key status changed"),Js(e,n)),i&&(Zs(e),Ys(e,n.variants))}}function su(e,t,n){e.u&&e.u.onExpirationUpdated&&e.u.onExpirationUpdated(t,n),e.dispatchEvent(new Te("expirationupdated"))}function uu(e,t){var n=e.h?ze(e.h.$):{},i=Object.keys(n);i=i.length&&"00"==i[0];for(var r=!1,a=!1,o=[],s=[],u=d(t),c=u.next();!c.done;c=u.next()){var l=[];(c=c.value).audio&&l.push(c.audio),c.video&&l.push(c.video);for(var f=(l=d(l)).next();!f.done;f=l.next())if((f=f.value).keyId){var h=n[i?"00":f.keyId];h?Ns.includes(h)&&(s.includes(h)||s.push(h)):o.includes(f.keyId)||o.push(f.keyId)}c.allowedByApplication?c.allowedByKeySystem&&(r=!0):a=!0}if(!r)throw new he(2,4,4012,{hasAppRestrictions:a,missingKeys:o,restrictedKeyStatuses:s})}function cu(e,t){p((function n(){return _(n,(function(n){switch(n.j){case 1:return x(n,Promise.resolve(),2);case 2:e.i!=yu&&e.dispatchEvent(t),k(n)}}))}))}function lu(e){for(var t=new Set,n=(e=d(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(Rn(n.language)):t.add("und");return t}function fu(e){for(var t=new Map,n=(e=d(e)).next();!n.done;n=e.next()){var i=n.value;n="und";var r=[];for(i.language&&(n=Rn(i.language)),(r="variant"==i.type?i.audioRoles:i.roles)&&r.length||(r=[""]),t.has(n)||t.set(n,new Set),r=(i=d(r)).next();!r.done;r=i.next())r=r.value,t.get(n).add(r)}var a=[];return t.forEach((function(e,t){for(var n=d(e),i=n.next();!i.done;i=n.next())a.push({language:t,role:i.value})})),a}function du(e){return null==(e=hu(e))?[]:e.variants.filter((function(e){return Un.Bb(e)}))}function hu(e){for(var t=e.o.g(),n=null,i=(e=d(e.c.periods)).next();!i.done;i=e.next())(i=i.value).startTime<=t&&(n=i);return n}function pu(e){var t=hu(e);return da(e.ea,t).variant}function mu(){return new he(2,7,7e3)}function gu(e,t,n,i,r,a){return i==e&&r.w==a.w&&r.uri==a.uri&&r.mimeType==a.mimeType&&r.Ea==a.Ea?t:n}function vu(e){return new Promise((function(t,n){e.eb=function(){return n(mu())},e.xc=function(){return t()},e.onError=function(e){return n(e)},e.zc=function(){return n(mu())}}))}Cs.registerSupportPlugin=function(e,t){Ds[e]=t},Cs.isBrowserSupported=function(){if(!(e.Promise&&e.Uint8Array&&Array.prototype.forEach))return!1;var t=Ze();return!(t&&12>t||!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration))&&(!!Ye()||$e("application/x-mpegurl"))},Cs.probeSupport=function(){return xt().then((function(e){for(var t=hr.eg(),n={},i=d('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),r=i.next();!r.done;r=i.next()){n[r=r.value]=Ye()?!!dn(r)||(MediaSource.isTypeSupported(r)||qt(r)):$e(r);var a=r.split(";")[0];n[a]=n[a]||n[r]}for(var o in e={manifest:t,media:n,drm:e},Ds)e[o]=Ds[o]();return e}))},Cs.prototype.Qb=function(e,t){if(t=void 0===t||t,this.i==yu)return Promise.reject(mu());var n={Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null};n.w=e,Ye()||(t=!1);var i=t?this.pb:this.V,r=ms(this.Ta,(function(){return{node:i,payload:n,$a:!1}}));return r.Fb=function(){return X.info("Starting attach...")},vu(r)},Cs.prototype.attach=Cs.prototype.Qb,Cs.prototype.detach=function(){var e=this;if(this.i==yu)return Promise.reject(mu());var t=ms(this.Ta,(function(){return{node:e.K,payload:{Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null},$a:!1}}));return t.Fb=function(){return X.info("Starting detach...")},vu(t)},Cs.prototype.detach=Cs.prototype.detach,Cs.prototype.Od=function(e){var t=this;if(e=void 0===e||e,this.i==yu)return Promise.reject(mu());Ye()||(e=!1);var n={Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null},i=ms(this.Ta,(function(i){var r=i.w&&e?t.pb:i.w?t.V:t.K;return n.w=i.w,{node:r,payload:n,$a:!1}}));return i.Fb=function(){return X.info("Starting unload...")},vu(i)},Cs.prototype.unload=Cs.prototype.Od,Cs.prototype.load=function(e,t,n){if(this.i==yu)return Promise.reject(mu());this.dispatchEvent(new Te("loading"));var i={Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null};i.uri=e,i.Ld=Date.now()/1e3,n&&"string"!=typeof n&&(Kn("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),i.Ea=function(){return new n}),n&&"string"==typeof n&&(i.mimeType=n),void 0!==t&&(i.startTime=t);var r=function(e,t){if(t.Ea)return!1;if(!Ye())return!0;var n=t.mimeType,i=t.uri||"";return n||(n={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[hr.getExtension(i)]),!!n&&(""!=(t.w||tt()).canPlayType(n)&&(!hr.isSupported(i,n)||Qe()&&e.b.streaming.useNativeHlsOnSafari))}(this,i)?this.rb:this.$,a=ms(this.Ta,(function(e){return null==e.w?null:(i.w=e.w,{node:r,payload:i,$a:!0})}));return a.Fb=function(){return X.info("Starting load of "+e+"...")},new Promise((function(e,t){a.zc=function(){return t(new he(2,7,7002))},a.xc=function(){return e()},a.eb=function(){return t(mu())},a.onError=function(e){return t(e)}}))},Cs.prototype.load=Cs.prototype.load,Cs.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Ts(e,t));var n=xs(this.b,e,Hs(this));return js(this),n},Cs.prototype.configure=Cs.prototype.configure,Cs.prototype.getConfiguration=function(){var e=Hs(this);return xs(e,this.b,Hs(this)),e},Cs.prototype.getConfiguration=Cs.prototype.getConfiguration,Cs.prototype.mg=function(){for(var e in this.b)delete this.b[e];xs(this.b,Hs(this),Hs(this)),js(this)},Cs.prototype.resetConfiguration=Cs.prototype.mg,Cs.prototype.kf=function(){return this.i},Cs.prototype.getLoadMode=Cs.prototype.kf,Cs.prototype.qf=function(){return this.a},Cs.prototype.getMediaElement=Cs.prototype.qf,Cs.prototype.Ub=function(){return this.T},Cs.prototype.getNetworkingEngine=Cs.prototype.Ub,Cs.prototype.pc=function(){return this.Ob},Cs.prototype.getAssetUri=Cs.prototype.pc,Cs.prototype.nf=function(){return Kn("getManifestUri",'Please use "getAssetUri" instead.'),this.pc()},Cs.prototype.getManifestUri=Cs.prototype.nf,Cs.prototype.X=function(){return this.c?this.c.presentationTimeline.X():!(!this.a||!this.a.src)&&1/0==this.a.duration},Cs.prototype.isLive=Cs.prototype.X,Cs.prototype.bb=function(){return!!this.c&&this.c.presentationTimeline.bb()},Cs.prototype.isInProgress=Cs.prototype.bb,Cs.prototype.Hf=function(){if(this.c){if(!this.c.periods.length)return!1;var e=this.c.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},Cs.prototype.isAudioOnly=Cs.prototype.Hf,Cs.prototype.Be=function(){if(this.c){var e=this.c.presentationTimeline;return{start:e.wb(),end:e.Ga()}}return this.a&&this.a.src&&(e=this.a.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},Cs.prototype.seekRange=Cs.prototype.Be,Cs.prototype.keySystem=function(){return yt(this.drmInfo())},Cs.prototype.keySystem=Cs.prototype.keySystem,Cs.prototype.drmInfo=function(){return this.h?this.h.a:null},Cs.prototype.drmInfo=Cs.prototype.drmInfo,Cs.prototype.Tb=function(){return this.h?this.h.Tb():1/0},Cs.prototype.getExpiration=Cs.prototype.Tb,Cs.prototype.fd=function(){return!!this.F&&this.F.a==Sa},Cs.prototype.isBuffering=Cs.prototype.fd,Cs.prototype.uf=function(){if(this.H){var e=this.H;e=e.f?0:e.c}else e=0;return e},Cs.prototype.getPlaybackRate=Cs.prototype.uf,Cs.prototype.Eg=function(e){0==e?X.Z("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.H&&this.H.set(e),this.i==wu&&oo(this.f,1<Math.abs(e)))},Cs.prototype.trickPlay=Cs.prototype.Eg,Cs.prototype.Ue=function(){this.i==Tu&&this.H.set(1),this.i==wu&&(this.H.set(1),oo(this.f,!1))},Cs.prototype.cancelTrickPlay=Cs.prototype.Ue,Cs.prototype.cd=function(){if(this.c&&this.o){for(var e=pu(this),t=[],n=d(du(this)),i=n.next();!i.done;i=n.next()){i=i.value;var r=Un.Qd(i);r.active=i==e,t.push(r)}return t}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map((function(e){return Un.de(e)})):[]},Cs.prototype.getVariantTracks=Cs.prototype.cd,Cs.prototype.zb=function(){if(this.c&&this.o){for(var e=function(e){var t=hu(e);if(null==t)return null;if(!da(e.ea,t).text){var n=Un.Sb(t.textStreams,e.qa,e.nb);n.length&&fa(e.ea,t,n[0])}return da(e.ea,t).text}(this),t=[],n=d(function(e){var t=hu(e);return null==t?[]:t.textStreams.filter((function(t){return!e.hc.has(t)}))}(this)),i=n.next();!i.done;i=n.next()){i=i.value;var r=Un.Fc(i);r.active=i==e,t.push(r)}return t}return this.a&&this.a.src&&this.a.textTracks?Ks(this).map((function(e){return Un.Ff(e)})):[]},Cs.prototype.getTextTracks=Cs.prototype.zb,Cs.prototype.Fd=function(e){if(this.c&&this.f){var t=hu(this),n=t.textStreams.find((function(t){return t.id==e.id}));n?(Fs(this,t,n,!1),zs(this,n),this.qa=n.language):X.error("No stream with id",e.id)}else if(this.a&&this.a.src&&this.a.textTracks){for(n=(t=d(t=Ks(this))).next();!n.done;n=t.next())n=n.value,Un.ed(n)==e.id?n.mode=this.ob?"showing":"hidden":n.mode="disabled";tu(this)}},Cs.prototype.selectTextTrack=Cs.prototype.Fd,Cs.prototype.og=function(){Kn("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var e=this.zb().filter((function(e){return"application/cea-608"==e.mimeType}));0<e.length?this.Fd(e[0]):X.m("Unable to find the text track embedded in the video.")},Cs.prototype.selectEmbeddedTextTrack=Cs.prototype.og,Cs.prototype.Jg=function(){Kn("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var e=this.zb().filter((function(e){return e.active}))[0];return!!e&&"application/cea-608"==e.mimeType},Cs.prototype.usingEmbeddedTextTrack=Cs.prototype.Jg,Cs.prototype.pg=function(e,t,n){if(n=void 0===n?0:n,this.c&&this.f){var i=hu(this);this.b.abr.enabled&&X.Z("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var r=i.variants.find((function(t){return t.id==e.id}));r?Un.Bb(r)?(Bs(this,i,r,!1),qs(this,r,t,n),this.Pb=new ya(r),Ys(this,i.variants)):X.error("Unable to switch to restricted track",e.id):X.error("No variant with id",e.id)}else if(this.a&&this.a.audioTracks){for(n=(t=d(t=Array.from(this.a.audioTracks))).next();!n.done;n=t.next())n=n.value,Un.ed(n)==e.id&&(n.enabled=!0);eu(this)}},Cs.prototype.selectVariantTrack=Cs.prototype.pg,Cs.prototype.ef=function(){return fu(this.cd())},Cs.prototype.getAudioLanguagesAndRoles=Cs.prototype.ef,Cs.prototype.Bf=function(){return fu(this.zb())},Cs.prototype.getTextLanguagesAndRoles=Cs.prototype.Bf,Cs.prototype.df=function(){return Array.from(lu(this.cd()))},Cs.prototype.getAudioLanguages=Cs.prototype.df,Cs.prototype.Af=function(){return Array.from(lu(this.zb()))},Cs.prototype.getTextLanguages=Cs.prototype.Af,Cs.prototype.Dd=function(e,t){if(this.c&&this.o){var n=hu(this);this.Pb=new ba(e,t||"",0,"","audio"),Js(this,n)}else if(this.a&&this.a.audioTracks){var i=Array.from(this.a.audioTracks);n=Rn(e);for(var r=(i=d(i)).next();!r.done;r=i.next()){r=r.value;var a=Un.de(r);Rn(a.language)!=n||t&&!a.roles.includes(t)||(r.enabled=!0)}eu(this)}},Cs.prototype.selectAudioLanguage=Cs.prototype.Dd,Cs.prototype.Ed=function(e,t){if(this.c&&this.o){var n=hu(this);this.qa=e,this.nb=t||"";var i=Un.Sb(n.textStreams,this.qa,this.nb)[0]||null;i&&(Fs(this,n,i,!1),(this.b.streaming.alwaysStreamText||this.uc())&&zs(this,i))}else{var r=Rn(e);(n=this.zb().filter((function(e){return Rn(e.language)==r&&(!t||e.roles.includes(t))}))[0])&&this.Fd(n)}},Cs.prototype.selectTextLanguage=Cs.prototype.Ed,Cs.prototype.qg=function(e){if(this.c&&this.o){for(var t=hu(this),n=null,i=d(du(this)),r=i.next();!r.done;r=i.next())if((r=r.value).audio.label==e){n=r;break}null==n?X.m("No variants were found with label: "+e+". Ignoring the request to switch."):(this.Pb=new ba(n.language,"",0,e),Js(this,t))}},Cs.prototype.selectVariantsByLabel=Cs.prototype.qg,Cs.prototype.uc=function(){var e=this.ob;return this.G?this.G.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Ks(this).some((function(e){return"showing"==e.mode})):e},Cs.prototype.isTextTrackVisible=Cs.prototype.uc,Cs.prototype.tg=function(e){var t=this;return p((function n(){var i,r,a,o;return _(n,(function(n){switch(n.j){case 1:if(t.ob==(i=!!e))return n.return();if(t.ob=i,t.i!=wu){if(t.a&&t.a.src&&t.a.textTracks)for(var s=d(Ks(t)),u=s.next();!u.done;u=s.next())"disabled"!=(r=u.value).mode&&(r.mode=i?"showing":"hidden");n.C(2);break}if(t.G.g.setTextVisibility(i),t.b.streaming.alwaysStreamText){n.C(2);break}if(!i){!function(e){e.G=!0;var t=e.b.get("text");t&&(Mo(t),Io(t).catch((function(){})),e.b.delete("text"))}(t.f),n.C(2);break}if(ro(t.f,"text")){n.C(2);break}if(a=hu(t),!(0<(o=Un.Sb(a.textStreams,t.qa,t.nb)).length)){n.C(2);break}return x(n,ao(t.f,o[0]),2);case 2:nu(t),k(n)}}))}))},Cs.prototype.setTextTrackVisibility=Cs.prototype.tg,Cs.prototype.wf=function(){if(!this.X())return X.m("getPlayheadTimeAsDate is for live streams!"),null;var e=this.Ta.f,t=0;if(this.o)t=this.o.g();else if(e){if(null==e.startTime)return new Date;t=e.startTime}return this.c?new Date(1e3*(this.c.presentationTimeline.f+this.a.currentTime)):this.a&&this.a.getStartDate?(e=this.a.getStartDate(),isNaN(e.getTime())?(X.m("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(e.getTime()+1e3*t)):(X.m("No way to get playhead time as Date!"),null)},Cs.prototype.getPlayheadTimeAsDate=Cs.prototype.wf,Cs.prototype.yf=function(){if(!this.X())return X.m("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1e3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?(X.m("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):e}return X.m("No way to get presentation start time as Date!"),null},Cs.prototype.getPresentationStartTimeAsDate=Cs.prototype.yf,Cs.prototype.$c=function(){var e={total:[],audio:[],video:[],text:[]};return this.i==Tu&&(e.total=jt(this.a.buffered)),this.i==wu&&this.G.$c(e),e},Cs.prototype.getBufferedInfo=Cs.prototype.$c,Cs.prototype.getStats=function(){if(this.i!=wu&&this.i!=Tu)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};Xs(this);var e=this.a;if(e.getVideoPlaybackQuality){e=e.getVideoPlaybackQuality();var t=this.v,n=Number(e.totalVideoFrames);t.o=Number(e.droppedVideoFrames),t.l=n,this.v.i=Number(e.corruptedVideoFrames)}this.h?e=(e=this.h).K?e.K:NaN:e=NaN,this.v.h=e,this.i==wu&&((e=pu(this))&&(this.v.u=e.bandwidth),e&&e.video&&(t=this.v,n=e.video.height||NaN,t.v=e.video.width||NaN,t.g=n),e=this.l.getBandwidthEstimate(),this.v.f=e);var i=this.v;e=i.v,t=i.g,n=i.u;for(var r=i.l,a=i.o,o=i.i,s=i.f,u=i.b,c=Ms(i.a,"playing"),l=Ms(i.a,"paused"),f=Ms(i.a,"buffering"),h=i.h,p=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=d(e.b),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.a&&n.push(t(e.a)),n}(i.a),m=[],g=(i=d(i.c.a)).next();!g.done;g=i.next())g=g.value,m.push({timestamp:g.timestamp,id:g.id,type:g.type,fromAdaptation:g.fromAdaptation,bandwidth:g.bandwidth});return{width:e,height:t,streamBandwidth:n,decodedFrames:r,droppedFrames:a,corruptedFrames:o,estimatedBandwidth:s,loadLatency:u,playTime:c,pauseTime:l,bufferingTime:f,licenseTime:h,stateHistory:p,switchHistory:m}},Cs.prototype.getStats=Cs.prototype.getStats,Cs.prototype.addTextTrack=function(e,t,n,i,r,a){var o=this;return p((function s(){var u,c,l,f,d,h,p,m,g;return _(s,(function(s){switch(s.j){case 1:if(o.i==Tu)throw X.error("Cannot add text when loaded with src="),Error("State error!");if(o.i!=wu)throw X.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");if(u=hu(o),c=Ht,l=o.c.periods.indexOf(u),d=(f=l+1)>=o.c.periods.length?o.c.presentationTimeline.ca():o.c.periods[f].startTime,1/0==(h=d-u.startTime))throw new he(1,4,4033);return p=new Yi(1,0,h,(function(){return[e]}),0,null),m={id:o.ke++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(e){return 1==e?p:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:i,codecs:r||"",kind:n,encrypted:!1,keyId:null,language:t,label:a||null,type:c.va,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},o.hc.add(m),u.textStreams.push(m),x(s,ao(o.f,m),2);case 2:return(g=ro(o.f,"text"))&&fa(o.ea,u,g),o.hc.delete(m),X.debug("Choosing new streams after adding a text stream"),$s(o,u),Zs(o),s.return(Un.Fc(m))}}))}))},Cs.prototype.addTextTrack=Cs.prototype.addTextTrack,Cs.prototype.Hd=function(e,t){this.ic.width=e,this.ic.height=t},Cs.prototype.setMaxHardwareResolution=Cs.prototype.Hd,Cs.prototype.Cd=function(){if(this.i==wu){var e=this.f;if(e.f)X.error("Unable to retry after StreamingEngine is destroyed!"),e=!1;else if(e.o)X.error("Unable to retry after StreamingEngine encountered a fatal error!"),e=!1;else{for(var t=d(e.b.values()),n=t.next();!n.done;n=t.next()){var i=Co(n=n.value);n.Xb&&(X.info(i,"Retrying after failure..."),n.Xb=!1,Ao(e,n,.1))}e=!0}}else e=!1;return e},Cs.prototype.retryStreaming=Cs.prototype.Cd,Cs.prototype.lf=function(){return this.c},Cs.prototype.getManifest=Cs.prototype.lf,Cs.prototype.mf=function(){return this.u?this.u.constructor:null},Cs.prototype.getManifestParserFactory=Cs.prototype.mf,(i=Cs.prototype).Vc=function(e){var t=this.f?no(this.f):null,n=this.f?io(this.f):null;if(Un.filterNewPeriod(this.h,t,n,e),!(t=e.variants).some(Un.Bb))throw new he(2,4,4011);if(uu(this,e.variants),Un.Sd(t,this.b.restrictions,this.ic)&&this.f&&hu(this)==e&&Zs(this),e=this.h?this.h.a:null)for(n=(t=d(t)).next();!n.done;n=t.next())for(var i=(n=d(n.value.drmInfos)).next();!i.done;i=n.next())if((i=i.value).keySystem==e.keySystem)for(var r=(i=d(i.initData||[])).next();!r.done;r=i.next())r=r.value,vt(this.h,r.initDataType,r.initData)},i.Mf=function(e){X.debug("onChooseStreams_",e);try{X.J("onChooseStreams_, choosing variant from ",e.variants),X.J("onChooseStreams_, choosing text from ",e.textStreams),this.sb=!0,this.l.disable(),iu(this),X.debug("Choosing new streams after period changed");var t=Ys(this,e.variants),n=Un.Sb(e.textStreams,this.qa,this.nb)[0]||null;this.sa&&(e.variants.includes(this.sa)&&(t=this.sa),this.sa=null),this.ra&&(e.textStreams.includes(this.ra)&&(n=this.ra),this.ra=null),t&&Bs(this,e,t,!0),n&&Fs(this,e,n,!0);var i=this.f,r=i.b.get("video");if(r)var a=i.c.periods[r.ka];else{var o=i.b.get("audio");a=o?i.c.periods[o.ka]:null}var s=t?t.audio:null;if(!a&&n){var u;if(u=s){e=n;var c=Rn(this.b.preferredTextLanguage),l=Rn(s.language),f=Rn(e.language);u=Pn(f,c)&&!Pn(l,f)}u&&(this.ob=!0),this.ob&&this.G.g.setTextVisibility(!0),nu(this)}var d=this.b.streaming.alwaysStreamText||this.uc()?{variant:t,text:n}:{variant:t,text:null};return X.J("onChooseStreams_, chose variant ",d.variant),X.J("onChooseStreams_, chose text ",d.text),d}catch(e){return this.Ra(e),{variant:null,text:null}}},i.Te=function(){X.debug("canSwitch_"),this.sb=!1,this.b.abr.enabled&&(this.l.enable(),iu(this)),this.sa&&(so(this.f,this.sa,this.je,this.ge),eu(this),this.sa=null),this.ra&&(uo(this.f,this.ra,!0,0,!1),tu(this),this.ra=null)},i.Rf=function(){this.u&&this.u.update&&this.u.update()},i.Wf=function(){this.o&&this.o.u()},i.Ra=function(e){if(this.i!=yu){var t=new Te("error",{detail:e});this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)}};var yu=0,bu=1,wu=2,Tu=3;function Su(e,t){var n=ss(new os(e.Aa(),e.fa()),t.periods[0],new pr(null,0)),i=t.appMetadata||{};return n=Eu(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i}}function Eu(e){for(var t=[],n=Un.tf(e.variants),i=(n=d(n)).next();!i.done;i=n.next())t.push(Un.Qd(i.value));for(n=(e=d(e.textStreams)).next();!n.done;n=e.next())t.push(Un.Fc(n.value));return t}function xu(){this.a={}}function ku(e,t){var n=t.audio,i=t.video;if(n&&!i&&(e.a[n.id]=n.bandwidth||t.bandwidth),!n&&i&&(e.a[i.id]=i.bandwidth||t.bandwidth),n&&i){var r=n.bandwidth||393216,a=i.bandwidth||t.bandwidth-r;0>=a&&(X.m("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),a=t.bandwidth),e.a[n.id]=r,e.a[i.id]=a}}function Au(e,t){var n=e.a[t];return null==n&&(n=0,X.error("Asking for bitrate of stream not given to the estimator")),0==n&&X.m("Using bitrate of 0, this stream won't affect progress"),n}function Mu(e){this.a=!1,this.b=new pe,this.c=e}function Iu(e){var t=new Cu;e.periods.forEach((function(e,n){var i=Nu(e.variants);if(0==n)for(var r=(i=d(i.a)).next();!r.done;r=i.next())t.add(r.value);else!function(e,t){e.a=e.a.filter((function(e){return Ru(t,e)}))}(t,i)}));for(var n=(e=d(e.periods)).next();!n.done;n=e.next())(n=n.value).variants=n.variants.filter((function(e){return Ru(t,new Pu(e))}))}function Pu(e){var t=e.audio;e=e.video,this.b=t?t.mimeType:null,this.a=t?t.codecs.split(".")[0]:null,this.f=e?e.mimeType:null,this.c=e?e.codecs.split(".")[0]:null}function Cu(){this.a=[]}function Ru(e,t){return e.a.some((function(e){return t.b==e.b&&t.a==e.a&&t.f==e.f&&t.c==e.c}))}function Nu(e){for(var t=new Cu,n=(e=d(e)).next();!n.done;n=e.next())t.add(new Pu(n.value));return t}function Du(e){var t=this;if(e&&e.constructor!=Cs)throw new he(2,9,9008);this.b=this.a=null,e?(this.a=e.b,this.b=e.Ub()):(this.a=Es(),this.b=new Ce),this.f=!1,this.c=[],this.g=[];var n=!e;this.h=new Mu((function(){return p((function e(){var i;return _(e,(function(e){switch(e.j){case 1:return i=function(){},x(e,Promise.all(t.g.map((function(e){return e.then(i,i)}))),2);case 2:if(!n){e.C(3);break}return x(e,t.b.destroy(),3);case 3:t.a=null,t.b=null,k(e)}}))}))}))}function Lu(){if(Ye())e:{for(var e=d($o.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Uu(e,t){for(var n=[],i=d(e.periods),r=i.next();!r.done;r=i.next())for(var a=(r=d(r.value.streams)).next();!a.done;a=r.next())a=a.value,t&&"video"==a.contentType?n.push({contentType:Ge(a.mimeType,a.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=a.contentType||n.push({contentType:Ge(a.mimeType,a.codecs),robustness:e.drmInfo.audioRobustness});return n}function _u(e,t,n){return p((function i(){return _(i,(function(i){switch(i.j){case 1:return x(i,function(e,t,n,i){return p((function r(){var a,o,s;return _(r,(function(r){switch(r.j){case 1:return i.drmInfo?(a=function(e){var t=Array.from(e.a.keys());if(!t.length)throw new he(2,9,9e3,"No supported storage mechanisms found");return e.a.get(t[0]).getEmeSessionCell()}(n),o=i.sessionIds.map((function(e){return{sessionId:e,keySystem:i.drmInfo.keySystem,licenseUri:i.drmInfo.licenseServerUri,serverCertificate:i.drmInfo.serverCertificate,audioCapabilities:Uu(i,!1),videoCapabilities:Uu(i,!0)}})),x(r,ds(t,e,o),2)):r.return();case 2:return s=r.s,x(r,a.remove(s),3);case 3:return x(r,a.add(o.filter((function(e){return-1==s.indexOf(e.sessionId)}))),0)}}))}))}(e.b,e.a.drm,n,t),0)}}))}))}function Ou(e,t,n,i){function r(){s+=1,e.a.offline.progressCallback(u,s/o)}var a=function(e){var t=[];return e.periods.forEach((function(e){e.streams.forEach((function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach((function(e){t.push(e.dataKey)}))}))})),t}(i),o=a.length+1,s=0,u=Su(n,i);return Promise.all([t.removeSegments(a,r),t.removeManifests([n.key()],r)])}function ju(e,t,n,i,r,a){var o={id:a.id,originalId:a.originalId,primary:a.primary,presentationTimeOffset:a.presentationTimeOffset||0,contentType:a.type,mimeType:a.mimeType,codecs:a.codecs,frameRate:a.frameRate,pixelAspectRatio:a.pixelAspectRatio,kind:a.kind,language:a.language,label:a.label,width:a.width||null,height:a.height||null,initSegmentKey:null,encrypted:a.encrypted,keyId:a.keyId,segments:[],variantIds:[]};r=r.presentationTimeline.Wb();var s=a.id,u=a.initSegmentReference;return u&&(u=mr(u.c(),u.b,u.a,e.a.streaming.retryParameters),_o(t,s,u,.5*Au(i,a.id),!0,(function(t){return p((function i(){var r;return _(i,(function(i){switch(i.j){case 1:return x(i,n.addSegments([{data:t}]),2);case 2:r=i.s,e.c.push(r[0]),o.initSegmentKey=r[0],k(i)}}))}))}))),function(e,t,n){for(var i=null==(t=e.findSegmentPosition(t))?null:e.getSegmentReference(t);i;)n(i),i=e.getSegmentReference(++t)}(a,r,(function(r){var u=mr(r.c(),r.b,r.a,e.a.streaming.retryParameters);_o(t,s,u,function(e,t,n){return n=n.endTime-n.startTime,Au(e,t)*n}(i,a.id,r),!1,(function(t){return p((function i(){var a;return _(i,(function(i){switch(i.j){case 1:return x(i,n.addSegments([{data:t}]),2);case 2:a=i.s,e.c.push(a[0]),o.segments.push({startTime:r.startTime,endTime:r.endTime,dataKey:a[0]}),k(i)}}))}))}))})),o}function Ku(e){if(e.h.a)throw new he(2,9,7001)}function Bu(){if(!Lu())throw new he(2,9,9e3)}function Fu(e,t){return p((function n(){return _(n,(function(n){switch(n.j){case 1:return e.g.push(t),M(n,2),x(n,t,4);case 4:return n.return(n.s);case 2:C(n),Ae(e.g,t),R(n,0)}}))}))}function Hu(e){var t=new Set(e.variants.map((function(e){return e.video}))),n=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams,1<t.size&&X.m("Multiple video tracks selected to be stored");for(var i=(t=d(n)).next();!i.done;i=t.next()){i=i.value;for(var r=d(n),a=r.next();!a.done;a=r.next())i!=(a=a.value)&&i.language==a.language&&X.m("Similar audio tracks were selected to be stored",i.id,a.id)}for(t=(n=d(e)).next();!t.done;t=n.next())for(t=t.value,r=(i=d(e)).next();!r.done;r=i.next())t!=(r=r.value)&&t.language==r.language&&X.m("Similar text tracks were selected to be stored",t.id,r.id)}Cs.LoadMode={DESTROYED:yu,NOT_LOADED:bu,MEDIA_SOURCE:wu,SRC_EQUALS:Tu},Mu.prototype.destroy=function(){var e=this;return this.a?this.b:(this.a=!0,this.c().then((function(){e.b.resolve()}),(function(){e.b.resolve()})))},Cu.prototype.add=function(e){Ru(this,e)||this.a.push(e)},H("shaka.offline.Storage",Du),Du.support=Lu,Du.prototype.destroy=function(){return this.h.destroy()},Du.prototype.destroy=Du.prototype.destroy,Du.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Ts(e,t));var n=e,i=!1;return null!=n.trackSelectionCallback&&(i=!0,n.offline=n.offline||{},n.offline.trackSelectionCallback=n.trackSelectionCallback,delete n.trackSelectionCallback),null!=n.progressCallback&&(i=!0,n.offline=n.offline||{},n.offline.progressCallback=n.progressCallback,delete n.progressCallback),null!=n.usePersistentLicense&&(i=!0,n.offline=n.offline||{},n.offline.usePersistentLicense=n.usePersistentLicense,delete n.usePersistentLicense),i&&Kn("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),xs(this.a,e)},Du.prototype.configure=Du.prototype.configure,Du.prototype.getConfiguration=function(){var e=Es();return xs(e,this.a,Es()),e},Du.prototype.getConfiguration=Du.prototype.getConfiguration,Du.prototype.Ub=function(){return this.b},Du.prototype.getNetworkingEngine=Du.prototype.Ub,Du.prototype.store=function(e,t,n){var i=this;return Fu(this,function(e,t,n,i){return p((function r(){var a,o,s,u,c,l,f,h,m;return _(r,(function(r){switch(r.j){case 1:return Bu(),e.f?r.return(Promise.reject(new he(2,9,9006))):(e.f=!0,x(r,function(e,t,n){return p((function i(){var r,a,o,s,u,c;return _(i,(function(i){switch(i.j){case 1:return r=null,a=e.b,o={networkingEngine:a,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){r=e}},x(i,n(),2);case 2:return(s=i.s).configure(e.a.manifest),Ku(e),M(i,3),x(i,s.start(t,o),5);case 5:return u=i.s,Ku(e),c=function(e){for(var t=new Set,n=(e=d(e.periods)).next();!n.done;n=e.next()){for(var i=d((n=n.value).textStreams),r=i.next();!r.done;r=i.next())t.add(r.value);for(n=d(n.variants),i=n.next();!i.done;i=n.next())(i=i.value).audio&&t.add(i.audio),i.video&&t.add(i.video)}return t}(u),x(i,Promise.all(He(c,(function(e){return e.createSegmentIndex()}))),6);case 6:if(Ku(e),r)throw r;return i.return(u);case 3:return C(i),x(i,s.stop(),7);case 7:R(i,0)}}))}))}(e,t,i),2));case 2:if(a=r.s,Ku(e),!(!a.presentationTimeline.X()&&!a.presentationTimeline.bb()))throw new he(2,9,9005,t);return o=null,s=new Wo,c=u=null,A(r,3,4),x(r,function(e,t,n){return p((function i(){var r,a,o;return _(i,(function(i){switch(i.j){case 1:return r=new dt({Db:e.b,onError:n,yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),a=Ra(t.periods),o=e.a,r.configure(o.drm),x(i,function(e,t,n){return e.v=[],e.G=n,pt(e,t)}(r,a,o.offline.usePersistentLicense),2);case 2:return x(i,mt(r),3);case 3:return x(i,gt(r),4);case 4:return i.return(r)}}))}))}(e,a,(function(e){c=c||e})),6);case 6:if(o=r.s,Ku(e),c)throw c;return x(r,function(e,t,n){return p((function i(){var r,a;return _(i,(function(i){switch(i.j){case 1:return r={width:1/0,height:1/0},function(e,t,n){for(var i=(e=d(e.periods)).next();!i.done;i=e.next())(i=i.value).variants=i.variants.filter((function(e){return Un.ld(e,t,n)}))}(t,e.a.restrictions,r),function(e){for(var t=(e=d(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter((function(e){var t=!0;return e.audio&&(t=t&&vn(e.audio)),e.video&&(t=t&&vn(e.video)),t}))}(t),function(e,t){for(var n=d(e.periods),i=n.next();!i.done;i=n.next())(i=i.value).variants=i.variants.filter((function(e){return kt(t,e)}))}(t,n),Iu(t),a=e.a.preferredAudioChannelCount,Un.Vd(t,a),x(i,function(e,t){return p((function n(){var i,r,a,o;return _(n,(function(n){switch(n.j){case 1:i=null,r=d(e.periods),a=r.next();case 2:if(a.done){n.C(0);break}return o=a.value,i&&(o.variants=o.variants.filter((function(e){return Ru(i,new Pu(e))}))),x(n,t(o),5);case 5:i=Nu(o.variants),a=r.next(),n.C(2)}}))}))}(t,(function(t){return p((function n(){var i,r,a,o,s,u,c,l;return _(n,(function(n){switch(n.j){case 1:i=Un,r=[];for(var f=d(t.variants),h=f.next();!h.done;h=f.next())a=h.value,r.push(i.Qd(a));for(h=(f=d(t.textStreams)).next();!h.done;h=f.next())o=h.value,r.push(i.Fc(o));return x(n,e.a.offline.trackSelectionCallback(r),2);case 2:for(s=n.s,u=new Set,c=new Set,h=(f=d(s)).next();!h.done;h=f.next())"variant"==(l=h.value).type&&u.add(l.id),"text"==l.type&&c.add(l.id);t.variants=t.variants.filter((function(e){return u.has(e.id)})),t.textStreams=t.textStreams.filter((function(e){return c.has(e.id)})),k(n)}}))}))})),2);case 2:(function(e){if(0==e.periods.length)throw new he(2,4,4014);for(var t=(e=d(e.periods)).next();!t.done;t=e.next())Hu(t.value)})(t),k(i)}}))}))}(e,a,o),7);case 7:return x(r,s.init(),8);case 8:return Ku(e),x(r,function(e){var t=null;if(e.a.forEach((function(e,n){e.getCells().forEach((function(e,i){e.hasFixedKeySpace()||t||(t={path:{Aa:n,fa:i},fa:e})}))})),t)return t;throw new he(2,9,9013,"Could not find a cell that supports add-operations")}(s),9);case 9:return u=r.s,Ku(e),x(r,function(e,t,n,i,r,a){return p((function o(){var s,u,c,l,f,h,m,g,v,y;return _(o,(function(o){switch(o.j){case 1:return s=function(e,t,n){var i=null==t.expiration?1/0:t.expiration;return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.ca(),size:0,expiration:i,tracks:t=Eu(t.periods[0]),appMetadata:n}}(r,i,a),u=i.periods.some((function(e){return e.variants.some((function(e){return e.drmInfos&&e.drmInfos.length}))})),c=i.periods.some((function(e){return e.variants.some((function(e){return e.drmInfos.some((function(e){return e.initData&&e.initData.length}))}))})),f=null,(l=u&&!c)&&(h=n.a,f=Vu.get(h.keySystem)),m=new Uo(e.b,(function(t,n){s.size=n,e.a.offline.progressCallback(s,t)}),(function(t,i){l&&e.a.offline.usePersistentLicense&&f==i&&vt(n,"cenc",t)})),M(o,2),v=g=function(e,t,n,i,r,a,o){var s=new xu,u=r.periods.map((function(i){return function(e,t,n,i,r,a){for(var o=d(a.variants),s=o.next();!s.done;s=o.next())ku(i,s.value);for(o=d(a.textStreams),s=o.next();!s.done;s=o.next())i.a[s.value.id]=52;o=function(e){for(var t=new Set,n=d(e.textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(e=d(e.variants),n=e.next();!n.done;n=e.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video);return t}(a);var u=new Map;for(o=d(o),s=o.next();!s.done;s=o.next()){s=s.value;var c=ju(e,t,n,i,r,s);u.set(s.id,c)}return a.variants.forEach((function(e){e.audio&&u.get(e.audio.id).variantIds.push(e.id),e.video&&u.get(e.video.id).variantIds.push(e.id)})),{startTime:a.startTime,streams:Array.from(u.values())}}(e,t,n,s,r,i)})),c=i.a,l=e.a.offline.usePersistentLicense;return c&&l&&(c.initData=[]),{originalManifestUri:a,duration:r.presentationTimeline.ca(),size:0,expiration:i.Tb(),periods:u,sessionIds:l?bt(i):[],drmInfo:c,appMetadata:o}}(e,m,t,n,i,r,a),x(o,function(e){return p((function t(){return _(t,(function(t){switch(t.j){case 1:return x(t,Promise.all(e.b.values()),2);case 2:return t.return(e.a.a)}}))}))}(m),4);case 4:if(v.size=o.s,g.expiration=n.Tb(),y=bt(n),g.sessionIds=e.a.offline.usePersistentLicense?y:[],u&&e.a.offline.usePersistentLicense&&!y.length)throw new he(2,9,9007);return o.return(g);case 2:return C(o),x(o,m.destroy(),5);case 5:R(o,0)}}))}))}(e,u.fa,o,a,t,n),10);case 10:if(l=r.s,Ku(e),c)throw c;return x(r,u.fa.addManifests([l]),11);case 11:return f=r.s,Ku(e),h=new rs("manifest",u.path.Aa,u.path.fa,f[0]),r.return(Su(h,l));case 4:return C(r),e.f=!1,e.c=[],x(r,s.destroy(),12);case 12:if(!o){r.C(13);break}return x(r,o.destroy(),13);case 13:R(r,0);break;case 3:if(m=P(r),!u){r.C(15);break}return x(r,u.fa.removeSegments(e.c,(function(){})),15);case 15:throw c||m}}))}))}(this,e,t||{},(function(){return p((function t(){var r,a;return _(t,(function(t){switch(t.j){case 1:return n&&"string"!=typeof n?(Kn("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),r=n,t.return(new r)):x(t,hr.create(e,i.b,i.a.manifest.retryParameters,n),2);case 2:return a=t.s,t.return(a)}}))}))})))},Du.prototype.store=Du.prototype.store,Du.prototype.zf=function(){return this.f},Du.prototype.getStoreInProgress=Du.prototype.zf,Du.prototype.remove=function(e){return Fu(this,function(e,t){return p((function n(){var i,r,a,o,s,u;return _(n,(function(n){switch(n.j){case 1:return Bu(),null==(i=as(t))||"manifest"!=i.a?n.return(Promise.reject(new he(2,9,9004,t))):(r=i,a=new Wo,M(n,2),x(n,a.init(),4));case 4:return x(n,Xo(a,r.Aa(),r.fa()),5);case 5:return x(n,(o=n.s).getManifests([r.key()]),6);case 6:return s=n.s,u=s[0],x(n,Promise.all([_u(e,u,a),Ou(e,o,r,u)]),2);case 2:return C(n),x(n,a.destroy(),8);case 8:R(n,0)}}))}))}(this,e))},Du.prototype.remove=Du.prototype.remove,Du.prototype.jg=function(){return Fu(this,function(e){return p((function t(){var n,i,r,a,o,s,u,c,l;return _(t,(function(t){switch(t.j){case 1:return Bu(),n=e.b,i=e.a.drm,r=new Wo,a=!1,M(t,2),x(t,r.init(),4);case 4:for(o=[],function(e,t){e.a.forEach((function(e){t(e.getEmeSessionCell())}))}(r,(function(e){return o.push(e)})),s=Promise.resolve(),u={},c=d(o),l=c.next();!l.done;u={Ec:u.Ec},l=c.next())u.Ec=l.value,s=s.then(function(e){return function(){return p((function t(){var r,o;return _(t,(function(t){switch(t.j){case 1:return x(t,e.Ec.getAll(),2);case 2:return r=t.s,x(t,ds(i,n,r),3);case 3:return o=t.s,x(t,e.Ec.remove(o),4);case 4:o.length!=r.length&&(a=!0),k(t)}}))}))}}(u));return x(t,s,2);case 2:return C(t),x(t,r.destroy(),6);case 6:R(t,3);break;case 3:return t.return(!a)}}))}))}(this))},Du.prototype.removeEmeSessions=Du.prototype.jg,Du.prototype.list=function(){return Fu(this,p((function e(){var t,n,i;return _(e,(function(e){switch(e.j){case 1:return Bu(),t=[],n=new Wo,M(e,2),x(e,n.init(),4);case 4:return i=Promise.resolve(),function(e,t){e.a.forEach((function(e,n){e.getCells().forEach((function(e,i){t({Aa:n,fa:i},e)}))}))}(n,(function(e,n){i=i.then((function(){return p((function i(){return _(i,(function(i){switch(i.j){case 1:return x(i,n.getAllManifests(),2);case 2:i.s.forEach((function(n,i){var r=Su(new rs("manifest",e.Aa,e.fa,i),n);t.push(r)})),k(i)}}))}))}))})),x(e,i,2);case 2:return C(e),x(e,n.destroy(),6);case 6:R(e,3);break;case 3:return e.return(t)}}))})))},Du.prototype.list=Du.prototype.list,Du.deleteAll=function(){return p((function e(){var t;return _(e,(function(e){switch(e.j){case 1:return t=new Wo,M(e,2),x(e,t.erase(),2);case 2:return C(e),x(e,t.destroy(),5);case 5:R(e,0)}}))}))};var Vu=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");Ds.offline=Lu,H("shaka.polyfill.installAll",(function(){for(var e=0;e<Gu.length;++e)try{Gu[e].Re()}catch(e){X.Z("Error installing polyfill!",e)}}));var qu,zu,Gu=[];function Wu(e,t){for(var n={priority:t=t||0,Re:e},i=0;i<Gu.length;i++)if(Gu[i].priority<t)return void Gu.splice(i,0,n);Gu.push(n)}function Xu(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"==typeof Event)var n=new Event(t,e);else(n=document.createEvent("Event")).initEvent(t,e.bubbles,e.cancelable);e.target.dispatchEvent(n)}function Yu(e,t,n){if("input"==e)switch(this.type){case"range":e="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,n)}function $u(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(t){for(var n=[],i=0;i<arguments.length;++i)n[i]=arguments[i];return(n=e.apply(this,n)).abort=function(){},n}}function Ju(e,t){X.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var n=new Qu(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Qu(e,t){if(X.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=e,e.startsWith("com.apple.fps"))for(var n=d(t),i=n.next();!i.done;i=n.next()){var r=i.value;if("required"==r.persistentState)i=null;else{i={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label};var a=!1,o=!1;if(r.audioCapabilities)for(var s=d(r.audioCapabilities),u=s.next();!u.done;u=s.next())if((u=u.value).contentType){a=!0;var c=u.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,c)&&(i.audioCapabilities.push(u),o=!0)}if(r.videoCapabilities)for(u=(r=d(r.videoCapabilities)).next();!u.done;u=r.next())(s=u.value).contentType&&(a=!0,u=s.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,u)&&(i.videoCapabilities.push(s),o=!0));a||(o=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),i=o?i:null}if(i)return void(this.a=i)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function Zu(e){X.debug("PatchedMediaKeysApple.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&tc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?tc(e,this):Promise.resolve()}function ec(e){X.debug("PatchedMediaKeysApple.MediaKeys"),this.b=new WebKitMediaKeys(e),this.a=new Oe}function tc(e,t){if(e.a.hb(),!t)return Promise.resolve();e.a.B(t,"webkitneedkey",ic);try{return _a(t,HTMLMediaElement.HAVE_METADATA,e.a,(function(){t.webkitSetMediaKeys(e.b)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function nc(e){X.debug("PatchedMediaKeysApple.MediaKeySession"),Ee.call(this),this.b=null,this.g=e,this.c=this.a=null,this.f=new Oe,this.sessionId="",this.expiration=NaN,this.closed=new pe,this.keyStatuses=new ac}function ic(e){if(X.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e),e=new Uint8Array(e.initData),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=st(e=at(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=e,this.dispatchEvent(t)}function rc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Te("keystatuseschange"))}function ac(){this.size=0,this.a=void 0}function oc(e,t){X.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var n=new sc(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function sc(e,t){X.debug("PatchedMediaKeysMs.MediaKeySystemAccess"),this.keySystem=e;for(var n=!1,i=0;i<t.length;++i){var r=t[i],a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label},o=!1;if(r.audioCapabilities)for(var s=0;s<r.audioCapabilities.length;++s){var u=r.audioCapabilities[s];if(u.contentType){o=!0;var c=u.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,c)&&(a.audioCapabilities.push(u),n=!0)}}if(r.videoCapabilities)for(s=0;s<r.videoCapabilities.length;++s)(u=r.videoCapabilities[s]).contentType&&(o=!0,c=u.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,c)&&(a.videoCapabilities.push(u),n=!0));if(o||(n=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==r.persistentState&&(n=!1),n)return void(this.a=a)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function uc(e){X.debug("PatchedMediaKeysMs.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&lc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?lc(e,this):Promise.resolve()}function cc(e){X.debug("PatchedMediaKeysMs.MediaKeys"),this.b=new MSMediaKeys(e),this.a=new Oe}function lc(e,t){if(e.a.hb(),!t)return Promise.resolve();e.a.B(t,"msneedkey",dc);try{return _a(t,HTMLMediaElement.HAVE_METADATA,e.a,(function(){t.msSetMediaKeys(e.b)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function fc(e){X.debug("PatchedMediaKeysMs.MediaKeySession"),Ee.call(this),this.c=null,this.g=e,this.b=this.a=null,this.f=new Oe,this.sessionId="",this.expiration=NaN,this.closed=new pe,this.keyStatuses=new pc}function dc(e){if(X.debug("PatchedMediaKeysMs.onMsNeedKey_",e),e.initData){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",t.initData=function(e){if(!e)return e;var t=new _i(e);if(1>=t.data.length)return e;e=[];for(var n={},i=(t=d(t.data)).next();!i.done;n={tc:n.tc},i=t.next())n.tc=i.value,e.some(function(e){return function(t){return ft.Da(t,e.tc)}}(n))||e.push(n.tc);return ft.concat.apply(ft,e instanceof Array?e:function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(d(e)))}(e.initData).buffer,this.dispatchEvent(t)}}function hc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Te("keystatuseschange"))}function pc(){this.size=0,this.a=void 0}function mc(){return X.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),Promise.reject(Error("The key system specified is not supported."))}function gc(e){return X.debug("PatchedMediaKeysNop.setMediaKeys"),null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function vc(){throw new TypeError("Illegal constructor.")}function yc(){throw new TypeError("Illegal constructor.")}H("shaka.polyfill.register",Wu),Wu((function(){Cl()}),-1),Wu((function(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Xu),document.addEventListener("webkitfullscreenerror",Xu),document.addEventListener("mozfullscreenchange",Xu),document.addEventListener("mozfullscreenerror",Xu),document.addEventListener("MSFullscreenChange",Xu),document.addEventListener("MSFullscreenError",Xu)}})),Wu((function(){X.debug("InputEvent.install"),et("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(X.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Yu)})),Wu((function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})})),Wu((function(){X.debug("mathRound.install")})),Wu((function(){X.debug("MediaSource.install");var t=Ze();e.MediaSource?e.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(X.info("Patching Chromecast MSE bugs."),function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */);return n.shift(),n.some((function(e){return e.startsWith("codecs=")}))?cast.__platform__.canDisplayType(t):e(t)}}()):t?(function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"mp2t"!=t.split(/ *; */)[0].split("/")[1].toLowerCase()&&e(t)}}(),12>=t?(X.info("Patching Safari 11 & 12 MSE bugs."),$u(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}()):(X.info("Patching Safari 13 MSE bugs."),$u())):et("Tizen 2")||et("Tizen 3")||et("Tizen 4")?function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"opus"!=We(t)[0]&&e(t)}}():X.info("Using native MSE as-is."):X.info("No MSE implementation available.")})),Qu.prototype.createMediaKeys=function(){X.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new ec(this.keySystem);return Promise.resolve(e)},Qu.prototype.getConfiguration=function(){return X.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.a},ec.prototype.createSession=function(e){if(X.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new nc(this.b,e)},ec.prototype.setServerCertificate=function(e){return X.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),e&&new Uint8Array(e),Promise.resolve(!0)},V(nc,Ee),(i=nc.prototype).generateRequest=function(e,t){X.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.a=new pe;try{this.b=this.g.createSession("video/mp4",new Uint8Array(t)),this.sessionId=this.b.sessionId||"",this.f.B(this.b,"webkitkeymessage",this.yg.bind(this)),this.f.B(this.b,"webkitkeyadded",this.wg.bind(this)),this.f.B(this.b,"webkitkeyerror",this.xg.bind(this)),rc(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},i.load=function(){return X.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){X.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.c=new pe;try{this.b.update(new Uint8Array(e))}catch(e){this.c.reject(e)}return this.c},i.close=function(){X.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.b.close(),this.closed.resolve(),this.f.hb()}catch(e){this.closed.reject(e)}return this.closed},i.remove=function(){return X.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},i.yg=function(e){X.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Te("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},i.wg=function(e){X.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),this.c&&(rc(this,"usable"),this.c.resolve(),this.c=null)},i.xg=function(e){if(X.debug("PatchedMediaKeysApple.onWebkitKeyError_",e),(e=Error("EME PatchedMediaKeysApple key error")).errorCode=this.b.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.c)this.c.reject(e),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:rc(this,"output-not-allowed");break;default:rc(this,"internal-error")}},(i=ac.prototype).forEach=function(e){this.a&&e(this.a,qu)},i.get=function(e){if(this.has(e))return this.a},i.has=function(e){var t=qu;return!(!this.a||!ft.Da(new Uint8Array(e),new Uint8Array(t)))},i.entries=function(){},i.keys=function(){},i.values=function(){},Wu((function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(X.info("Using Apple-prefixed EME"),qu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Zu,e.MediaKeys=ec,e.MediaKeySystemAccess=Qu,navigator.requestMediaKeySystemAccess=Ju)})),sc.prototype.createMediaKeys=function(){X.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var e=new cc(this.keySystem);return Promise.resolve(e)},sc.prototype.getConfiguration=function(){return X.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration"),this.a},cc.prototype.createSession=function(e){if(X.debug("PatchedMediaKeysMs.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new fc(this.b,e)},cc.prototype.setServerCertificate=function(){return X.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate"),Promise.resolve(!1)},V(fc,Ee),(i=fc.prototype).generateRequest=function(e,t){X.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest"),this.a=new pe;try{this.c=this.g.createSession("video/mp4",new Uint8Array(t),null),this.f.B(this.c,"mskeymessage",this.Vf.bind(this)),this.f.B(this.c,"mskeyadded",this.Tf.bind(this)),this.f.B(this.c,"mskeyerror",this.Uf.bind(this)),hc(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},i.load=function(){return X.debug("PatchedMediaKeysMs.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){X.debug("PatchedMediaKeysMs.MediaKeySession.update"),this.b=new pe;try{this.c.update(new Uint8Array(e))}catch(e){this.b.reject(e)}return this.b},i.close=function(){X.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.hb()}catch(e){this.closed.reject(e)}return this.closed},i.remove=function(){return X.debug("PatchedMediaKeysMs.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},i.Vf=function(e){X.debug("PatchedMediaKeysMs.onMsKeyMessage_",e),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Te("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},i.Tf=function(e){X.debug("PatchedMediaKeysMs.onMsKeyAdded_",e),this.a?(X.debug("Simulating completion for a PR persistent license."),hc(this,"usable"),this.a.resolve(),this.a=null):this.b&&(hc(this,"usable"),this.b.resolve(),this.b=null)},i.Uf=function(e){if(X.debug("PatchedMediaKeysMs.onMsKeyError_",e),(e=Error("EME PatchedMediaKeysMs key error")).errorCode=this.c.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.b)this.b.reject(e),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:hc(this,"output-not-allowed");break;default:hc(this,"internal-error")}},(i=pc.prototype).forEach=function(e){this.a&&e(this.a,zu)},i.get=function(e){if(this.has(e))return this.a},i.has=function(e){var t=zu;return!(!this.a||!ft.Da(new Uint8Array(e),new Uint8Array(t)))},i.entries=function(){},i.keys=function(){},i.values=function(){},Wu((function(){!e.HTMLVideoElement||!e.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(X.info("Using ms-prefixed EME v20140218"),zu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=uc,e.MediaKeys=cc,e.MediaKeySystemAccess=sc,navigator.requestMediaKeySystemAccess=oc)})),vc.prototype.createSession=function(){},vc.prototype.setServerCertificate=function(){},yc.prototype.getConfiguration=function(){},yc.prototype.createMediaKeys=function(){},Wu((function(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(X.info("EME not available."),navigator.requestMediaKeySystemAccess=mc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=gc,e.MediaKeys=vc,e.MediaKeySystemAccess=yc)}),-10);var bc,wc="";function Tc(e){return wc?wc+e.charAt(0).toUpperCase()+e.slice(1):e}function Sc(e,t){X.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var n=new xc(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Ec(e){X.debug("PatchedMediaKeysWebkit.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&Ac(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Ac(e,this),Promise.resolve()}function xc(e,t){X.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.a=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.a="webkit-org.w3.clearkey",n=!1);var i=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video");for(var a=0;a<t.length;++a){var o=t[a],s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:o.initDataTypes,sessionTypes:["temporary"],label:o.label},u=!1;if(o.audioCapabilities)for(var c=0;c<o.audioCapabilities.length;++c){var l=o.audioCapabilities[c];if(l.contentType){u=!0;var f=l.contentType.split(";")[0];r.canPlayType(f,this.a)&&(s.audioCapabilities.push(l),i=!0)}}if(o.videoCapabilities)for(c=0;c<o.videoCapabilities.length;++c)(l=o.videoCapabilities[c]).contentType&&(u=!0,r.canPlayType(l.contentType,this.a)&&(s.videoCapabilities.push(l),i=!0));if(u||(i=r.canPlayType("video/mp4",this.a)||r.canPlayType("video/webm",this.a)),"required"==o.persistentState&&(n?(s.persistentState="required",s.sessionTypes=["persistent-license"]):i=!1),i)return void(this.b=s)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(n=Error(n)).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function kc(e){X.debug("PatchedMediaKeysWebkit.MediaKeys"),this.g=e,this.b=null,this.a=new Oe,this.c=[],this.f={}}function Ac(e,t){e.b=t,e.a.hb();var n=wc;t&&(e.a.B(t,n+"needkey",e.Zf.bind(e)),e.a.B(t,n+"keymessage",e.Bg.bind(e)),e.a.B(t,n+"keyadded",e.zg.bind(e)),e.a.B(t,n+"keyerror",e.Ag.bind(e)))}function Mc(e,t){var n=e.f[t];return n?(X.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):(n=e.c.shift())?(n.sessionId=t,e.f[t]=n,X.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):null}function Ic(e,t,n){X.debug("PatchedMediaKeysWebkit.MediaKeySession"),Ee.call(this),this.f=e,this.h=!1,this.a=this.b=null,this.c=t,this.g=n,this.sessionId="",this.expiration=NaN,this.closed=new pe,this.keyStatuses=new Rc}function Pc(e,t,n){if(e.h)return Promise.reject(Error("The session is already initialized."));e.h=!0;try{if("persistent-license"==e.g)if(n)var i=new Uint8Array(st("LOAD_SESSION|"+n));else{var r=st("PERSISTENT|"),a=new Uint8Array(r.byteLength+t.byteLength);a.set(new Uint8Array(r),0),a.set(new Uint8Array(t),r.byteLength),i=a}else i=new Uint8Array(t)}catch(e){return Promise.reject(e)}e.b=new pe;var o=Tc("generateKeyRequest");try{e.f[o](e.c,i)}catch(t){if("InvalidStateError"!=t.name)return e.b=null,Promise.reject(t);new le((function(){try{e.f[o](e.c,i)}catch(t){e.b.reject(t),e.b=null}})).R(.01)}return e.b}function Cc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Te("keystatuseschange"))}function Rc(){this.size=0,this.a=void 0}function Nc(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function Dc(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Lc(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Uc(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function _c(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function Oc(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function jc(t,n,i){return new e.TextTrackCue(t,n,i)}function Kc(t,n,i){return new e.TextTrackCue(t+"-"+n+"-"+i,t,n,i)}function Bc(){}xc.prototype.createMediaKeys=function(){X.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new kc(this.a);return Promise.resolve(e)},xc.prototype.getConfiguration=function(){return X.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.b},(i=kc.prototype).createSession=function(e){if(X.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.b||document.createElement("video");return t.src||(t.src="about:blank"),e=new Ic(t,this.g,e),this.c.push(e),e},i.setServerCertificate=function(){return X.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},i.Zf=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e);var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",e.initData instanceof ArrayBuffer?t.initData=e.initData:t.initData=e.initData.buffer,this.b.dispatchEvent(t)},i.Bg=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=Mc(this,e.sessionId);t?(e=new Te("message",{messageType:null==t.keyStatuses.a?"licenserequest":"licenserenewal",message:e.message}),X.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),t.b&&(t.b.resolve(),t.b=null),t.dispatchEvent(e)):X.error("Session not found",e.sessionId)},i.zg=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e),(e=Mc(this,e.sessionId))&&(X.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Cc(e,"usable"),e.a&&e.a.resolve(),e.a=null)},i.Ag=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=Mc(this,e.sessionId);t&&t.handleError(e)},V(Ic,Ee),(i=Ic.prototype).handleError=function(e){X.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=Error("EME v0.1b key error"),n=e.errorCode;n.systemCode=e.systemCode,t.errorCode=n,!e.sessionId&&this.b?(45==e.systemCode&&(t.message="Unsupported session type."),this.b.reject(t),this.b=null):e.sessionId&&this.a?(this.a.reject(t),this.a=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Cc(this,"output-restricted"):Cc(this,1==t?"expired":"internal-error"))},i.Kd=function(e,t){if(this.a)this.a.then(this.Kd.bind(this,e,t)).catch(this.Kd.bind(this,e,t));else{if(this.a=e,"webkit-org.w3.clearkey"==this.c){var n=rt(t),i=JSON.parse(n);"oct"!=i.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),n=ft.Fa(i.keys[0].k),i=ft.Fa(i.keys[0].kid)}else n=new Uint8Array(t),i=null;var r=Tc("addKey");try{this.f[r](this.c,n,i,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}},i.generateRequest=function(e,t){return X.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),Pc(this,t,null)},i.load=function(e){return X.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.g?Pc(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){X.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e);var t=new pe;return this.Kd(t,e),t},i.close=function(){if(X.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Tc("cancelKeyRequest");try{this.f[e](this.c,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},i.remove=function(){return X.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(i=Rc.prototype).forEach=function(e){this.a&&e(this.a,bc)},i.get=function(e){if(this.has(e))return this.a},i.has=function(e){var t=bc;return!(!this.a||!ft.Da(new Uint8Array(e),new Uint8Array(t)))},i.entries=function(){},i.keys=function(){},i.values=function(){},Wu((function(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)X.info("Using webkit-prefixed EME v0.1b"),wc="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;X.info("Using nonprefixed EME v0.1b")}bc=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Sc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Ec,e.MediaKeys=kc,e.MediaKeySystemAccess=xc}})),Wu((function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(X.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=Dc,Object.defineProperty(t,"disablePictureInPicture",{get:Uc,set:_c,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Lc,document.addEventListener("webkitpresentationmodechanged",Nc,!0))}})),Wu((function(){if(X.debug("VideoPlayPromise.install"),e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch((function(){})),e}}})),Wu((function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=Oc)}})),Wu((function(){if(e.VTTCue)X.info("Using native VTTCue.");else if(e.TextTrackCue){var t=TextTrackCue.length;if(3==t)X.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e.VTTCue=jc;else if(6==t)X.info("Using VTTCue polyfill from 6 argument TextTrackCue."),e.VTTCue=Kc;else{try{var n=!!jc(1,2,"")}catch(e){n=!1}n&&(X.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e.VTTCue=jc)}}else X.error("VTTCue not available.")})),H("shaka.text.TtmlTextParser",Bc),Bc.prototype.parseInit=function(){},Bc.prototype.parseInit=Bc.prototype.parseInit,Bc.prototype.parseMedia=function(e,t){var n=rt(e),i=[],r=new DOMParser,a=null;if(""==n)return i;try{a=r.parseFromString(n,"text/xml")}catch(e){throw new he(2,2,2005,"Failed to parse TTML.")}if(a){if(n=a.getElementsByTagName("parsererror")[0])throw new he(2,2,2005,n.textContent);if(!(r=a.getElementsByTagName("tt")[0]))throw new he(2,2,2005,"TTML does not contain <tt> tag.");var o=Oi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRate"),s=Oi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),u=Oi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),c=Oi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","tickRate");if(a=r.getAttribute("xml:space")||"default",n=Oi.getAttributeNS(r,"http://www.w3.org/ns/ttml#styling","extent"),"default"!=a&&"preserve"!=a)throw new he(2,2,2005,"Invalid xml:space value: "+a);a="default"==a,o=new ll(o,s,u,c),s=el(r.getElementsByTagName("metadata")[0]),u=el(r.getElementsByTagName("styling")[0]),c=el(r.getElementsByTagName("layout")[0]);for(var l=[],f=0;f<c.length;f++){var h,p,m=c[f],g=u,v=n,y=new sn,b=m.getAttribute("xml:id");if(b)y.id=b,b=null,v&&(b=Vc.exec(v)||zc.exec(v)),v=b?Number(b[1]):null,b=b?Number(b[2]):null,(h=rl(m,g,"extent"))&&(null!=(h=(p=Vc.exec(h))||zc.exec(h))&&(y.width=null!=v?100*Number(h[1])/v:Number(h[1]),y.height=null!=b?100*Number(h[2])/b:Number(h[2]),y.widthUnits=p||null!=v?un:0,y.heightUnits=p||null!=b?un:0)),(m=rl(m,g,"origin"))&&(null!=(h=(p=Vc.exec(m))||zc.exec(m))&&(y.viewportAnchorX=null!=b?100*Number(h[1])/b:Number(h[1]),y.viewportAnchorY=null!=v?100*Number(h[2])/v:Number(h[2]),y.viewportAnchorUnits=p||null!=v?un:0));else X.m("TtmlTextParser parser encountered a region with no id. Region will be ignored."),y=null;y&&l.push(y)}for(n=function e(t){if(!t)return[];for(var n=[],i=(t=d(t.childNodes)).next();!i.done;i=t.next())(i=i.value)instanceof Element&&(i.hasAttribute("begin")?n.push(i):n=n.concat(e(i)));return n}(r.getElementsByTagName("body")[0]),r=(n=d(n)).next();!r.done;r=n.next())(r=tl(r.value,t.periodStart,o,s,u,c,l,a,!1))&&i.push(r)}return i},Bc.prototype.parseMedia=Bc.prototype.parseMedia;var Fc,Hc,Vc=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,qc=/^(\d+px|\d+em)$/,zc=/^(\d+)px (\d+)px$/,Gc=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Wc=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Xc=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Yc=/^(\d*(?:\.\d*)?)f$/,$c=/^(\d*(?:\.\d*)?)t$/,Jc=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Qc={left:tn,center:"center",right:"end",start:tn,end:"end"},Zc={left:"line-left",center:"center",right:"line-right"};function el(e){var t=[];if(!e)return t;for(var n=d(e.childNodes),i=n.next();!i.done;i=n.next())(i=i.value).nodeType==Node.ELEMENT_NODE&&"br"!==i.nodeName&&(i=el(i),t=t.concat(i));return t.length||t.push(e),t}function tl(e,t,n,i,r,a,o,s,u){if(u&&"br"==e.nodeName)return(e=new Gt(0,0,"")).spacer=!0,e;var c=/^[\s\n]*$/.test(e.textContent),l=e.nodeType==Node.ELEMENT_NODE&&!e.hasAttribute("begin")&&!e.hasAttribute("end");if(e.nodeType!=Node.ELEMENT_NODE||l&&c||l&&!u)return null;c=ul(e.getAttribute("begin"),n),l=ul(e.getAttribute("end"),n);var f=ul(e.getAttribute("dur"),n);if(null==l&&null!=f&&(l=c+f),!u&&(null==c||null==l))throw new he(2,2,2001);if(c=u&&null==c?0:c+t,l=u&&null==l?0:l+t,f="",u=[],Array.from(e.childNodes).find((function(e){return e.nodeType===Node.TEXT_NODE&&/\S+/.test(e.textContent)})))f=function e(t,n){for(var i="",r=d(t.childNodes),a=r.next();!a.done;a=r.next())"br"==(a=a.value).nodeName&&t.childNodes[0]!==a?i+="\n":a.childNodes&&0<a.childNodes.length?i+=e(a,n):n?i+=a=(a=a.textContent.trim()).replace(/\s+/g," "):i+=a.textContent;return i}(e,s);else for(var h=d(e.childNodes),p=h.next();!p.done;p=h.next())(p=tl(p.value,t,n,i,r,a,o,s,!0))&&(p.startTime=p.startTime||c,p.endTime=p.endTime||l,u.push(p));if((t=new Gt(c,l,f)).nestedCues=u,(a=sl(e,"region",a,"")[0])&&a.getAttribute("xml:id")){var m=a.getAttribute("xml:id");t.region=o.filter((function(e){return e.id==m}))[0]}return function(e,t,n,i,r){"rtl"==il(t,n,r,"direction")&&(e.direction="rtl");var a=il(t,n,r,"writingMode");"tb"==a||"tblr"==a?e.writingMode="vertical-lr":"tbrl"==a?e.writingMode="vertical-rl":"rltb"==a||"rl"==a?e.direction="rtl":a&&(e.direction=Qt),(a=il(t,n,r,"textAlign"))?(e.positionAlign=Zc[a],e.lineAlign=Qc[a],e.textAlign=Yt[a.toUpperCase()]):e.textAlign="start",(a=il(t,n,r,"displayAlign"))&&(e.displayAlign=Jt[a.toUpperCase()]);(a=il(t,n,r,"color"))&&(e.color=a);(a=il(t,n,r,"backgroundColor"))&&(e.backgroundColor=a);(a=il(t,n,r,"fontFamily"))&&(e.fontFamily=a);(a=il(t,n,r,"fontWeight"))&&"bold"==a&&(e.fontWeight=700),(a=il(t,n,r,"wrapOption"))&&"noWrap"==a&&(e.wrapLine=!1),(a=il(t,n,r,"lineHeight"))&&a.match(qc)&&(e.lineHeight=a),(a=il(t,n,r,"fontSize"))&&a.match(qc)&&(e.fontSize=a),(a=il(t,n,r,"fontStyle"))&&(e.fontStyle=on[a.toUpperCase()]);if(i){a=i.getAttribute("imagetype");var o=i.getAttribute("encoding");i=i.textContent.trim(),"PNG"==a&&"Base64"==o&&i&&(e.backgroundImage="data:image/png;base64,"+i)}(n=rl(n,r,"textDecoration"))&&nl(e,n),(t=al(t,r,"textDecoration"))&&nl(e,t)}(t,e,a,i=sl(e,"smpte:backgroundImage",i,"#")[0],r),t}function nl(e,t){for(var n=t.split(" "),i=0;i<n.length;i++)switch(n[i]){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Ae(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Ae(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Ae(e.textDecoration,"overline")}}function il(e,t,n,i){return(e=al(e,n,i))?e:rl(t,n,i)}function rl(e,t,n){if(!e)return null;for(var i=el(e),r=0;r<i.length;r++){var a=Oi.getAttributeNS(i[r],"http://www.w3.org/ns/ttml#styling",n);if(a)return a}return ol(e,t,n)}function al(e,t,n){var i=Oi.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",n);return i||ol(e,t,n)}function ol(e,t,n){e=sl(e,"style",t,"");for(var i=null,r=0;r<e.length;r++){var a=Oi.getAttributeNS(e[r],"http://www.w3.org/ns/ttml#styling",n);a||(a=al(e[r],t,n)),a&&(i=a)}return i}function sl(e,t,n,i){var r=[];if(!e||1>n.length)return r;var a=e;for(e=null;a&&!(e=a.getAttribute(t))&&(a=a.parentNode)instanceof Element;);if(t=e)for(e=(t=d(t=t.split(" "))).next();!e.done;e=t.next()){e=e.value;for(var o=(a=d(n)).next();!o.done;o=a.next())if(i+(o=o.value).getAttribute("xml:id")==e){r.push(o);break}}return r}function ul(e,t){var n=null;if(Gc.test(e)){n=Gc.exec(e);var i=Number(n[1]),r=Number(n[2]),a=Number(n[3]),o=Number(n[4]);n=(a+=(o+=(Number(n[5])||0)/t.b)/t.frameRate)+60*r+3600*i}else Wc.test(e)?n=cl(Wc,e):Xc.test(e)?n=cl(Xc,e):Yc.test(e)?(n=Yc.exec(e),n=Number(n[1])/t.frameRate):$c.test(e)?(n=$c.exec(e),n=Number(n[1])/t.a):Jc.test(e)&&(n=cl(Jc,e));return n}function cl(e,t){var n=e.exec(t);return null==n||""==n[0]?null:(Number(n[4])||0)/1e3+(Number(n[3])||0)+60*(Number(n[2])||0)+3600*(Number(n[1])||0)}function ll(e,t,n,i){this.frameRate=Number(e)||30,this.b=Number(t)||1,this.a=Number(i),0==this.a&&(this.a=e?this.frameRate*this.b:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}function fl(){this.a=new Bc}function dl(){}function hl(e,t,n){var i;if(i=/^align:(start|middle|center|end|left|right)$/.exec(t))t=i[1],e.textAlign="middle"==t?Xt:Yt[t.toUpperCase()];else if(i=/^vertical:(lr|rl)$/.exec(t))e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl";else if(i=/^size:([\d.]+)%$/.exec(t))e.size=Number(i[1]);else if(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center");else{if(!(i=/^region:(.*)$/.exec(t))){e:{if(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=nn[n[2].toUpperCase()]);else{if(!(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))){e=!1;break e}e.lineInterpretation=en,e.line=Number(n[1]),n[2]&&(e.lineAlign=nn[n[2].toUpperCase()])}e=!0}return e}(t=function(e,t){var n=e.filter((function(e){return e.id==t}));return n.length?n[0]:(X.m("VTT parser could not find a region with id: ",t," The region will be ignored."),null)}(n,i[1]))&&(e.region=t)}return!0}function pl(e){if(null==(e=Dr(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function ml(){this.a=null}function gl(e,t,n){var i,r,a;return(new Ci).L("payl",Di((function(e){i=rt(e)}))).L("iden",Di((function(e){r=rt(e)}))).L("sttg",Di((function(e){a=rt(e)}))).parse(e),i?function(e,t,n,i,r){if(e=new Gt(i,r,e),t&&(e.id=t),n)for(t=new Rr(n),n=Lr(t);n;)hl(e,n,[])||X.m("VTT parser encountered an invalid VTT setting: ",n," The setting will be ignored."),Nr(t),n=Lr(t);return e}(i,r,a,t,n):null}
/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function vl(){}function yl(){Fc?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Fc=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=bl):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function bl(e,t){var n=this;return p((function i(){var r;return _(i,(function(i){switch(i.j){case 1:return console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),x(i,Fc.call(n,e,t),2);case 2:return Il(r=i.s)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Fc,i.return(r)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=wl,i.return(wl.call(n,e,t)))}}))}))}function wl(e,t){var n=this;return p((function i(){var r,a,o,s,u,c,l,f;return _(i,(function(i){switch(i.j){case 1:console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),r=Ml(e),a=[];for(var h=d(t),p=h.next();!p.done;p=h.next())o=p.value,s=Tl(o.videoCapabilities,r),u=Tl(o.audioCapabilities,r),o.videoCapabilities&&o.videoCapabilities.length&&!s.length||o.audioCapabilities&&o.audioCapabilities.length&&!u.length||((c=Object.assign({},o)).videoCapabilities=s,c.audioCapabilities=u,a.push(c));if(!a.length)throw(l=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",l.code=DOMException.NOT_SUPPORTED_ERR,l;return x(i,Fc.call(n,e,a),2);case 2:return f=i.s,i.return(new Al(f,r))}}))}))}function Tl(e,t){return e?e.filter((function(e){return!e.encryptionScheme||e.encryptionScheme==t})):e}function Sl(){}function El(){navigator.mediaCapabilities?(Hc=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=xl):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function xl(e){var t=this;return p((function n(){var i;return _(n,(function(n){switch(n.j){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),x(n,Hc.call(t,e),2);case 2:return i=n.s,e.keySystemConfiguration?Il(i.keySystemAccess)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Hc,n.return(i)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=kl,n.return(kl.call(t,e))):n.return(i)}}))}))}function kl(e){var t=this;return p((function n(){var i,r,a,o,s,u,c;return _(n,(function(n){switch(n.j){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),i=null,e.keySystemConfiguration&&(r=e.keySystemConfiguration,a=r.keySystem,o=r.audio&&r.audio.encryptionScheme,s=r.video&&r.video.encryptionScheme,i=Ml(a),u={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},o&&o!=i||s&&s!=i)?n.return(u):x(n,Hc.call(t,e),2);case 2:return(c=n.s).keySystemAccess&&(c.keySystemAccess=new Al(c.keySystemAccess,i)),n.return(c)}}))}))}function Al(e,t){this.b=e,this.a=t,this.keySystem=e.keySystem}function Ml(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function Il(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function Pl(){}function Cl(){yl(),El()}fn["application/ttml+xml"]=Bc,H("shaka.text.Mp4TtmlParser",fl),fl.prototype.parseInit=function(e){var t=!1;if((new Ci).L("moov",Ri).L("trak",Ri).L("mdia",Ri).L("minf",Ri).L("stbl",Ri).ia("stsd",Ni).L("stpp",(function(e){t=!0,e.parser.stop()})).parse(e),!t)throw new he(2,2,2007)},fl.prototype.parseInit=fl.prototype.parseInit,fl.prototype.parseMedia=function(e,t){var n=!1,i=[];if((new Ci).L("mdat",Di(function(e){n=!0,i=i.concat(this.a.parseMedia(e,t))}.bind(this))).parse(e),!n)throw new he(2,2,2007);return i},fl.prototype.parseMedia=fl.prototype.parseMedia,fn['application/mp4; codecs="stpp"']=fl,fn['application/mp4; codecs="stpp.ttml.im1t"']=fl,fn['application/mp4; codecs="stpp.TTML.im1t"']=fl,H("shaka.text.VttTextParser",dl),dl.prototype.parseInit=function(){},dl.prototype.parseInit=dl.prototype.parseInit,dl.prototype.parseMedia=function(e,t){var n=rt(e);if(n=(n=n.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new he(2,2,2e3);var i=t.segmentStart;if(null==i&&(i=0,n[0].includes("X-TIMESTAMP-MAP"))){var r=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=n[0].match(/MPEGTS:(\d+)/m);if(r&&a){if(null==(i=pl(new Rr(r[1]))))throw new he(2,2,2e3);i=t.periodStart+(Number(a[1])/9e4-i)}}a=[];var o=n[0].split("\n");for(r=1;r<o.length;r++)if(/^Region:/.test(o[r])){var s=new Rr(o[r]),u=new sn;Lr(s),Nr(s);for(var c=Lr(s);c;){var l;e:{var f=u,d=c;if(l=/^id=(.*)$/.exec(d))f.id=l[1];else if(l=/^width=(\d{1,2}|100)%$/.exec(d))f.width=Number(l[1]);else if(l=/^lines=(\d+)$/.exec(d))f.height=Number(l[1]),f.heightUnits=2;else if(l=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))f.regionAnchorX=Number(l[1]),f.regionAnchorY=Number(l[2]);else if(l=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))f.viewportAnchorX=Number(l[1]),f.viewportAnchorY=Number(l[2]);else{if(!/^scroll=up$/.exec(d)){l=!1;break e}f.scroll="up"}l=!0}l||X.m("VTT parser encountered an invalid VTTRegion setting: ",c," The setting will be ignored."),Nr(s),c=Lr(s)}a.push(u)}for(r=[],s=1;s<n.length;s++){if(l=o=n[s].split("\n"),f=i,o=a,1==l.length&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||"STYLE"==l[0])o=null;else{u=null,l[0].includes("--\x3e")||(u=l[0],l.splice(0,1)),d=pl(c=new Rr(l[0]));var h=Dr(c,/[ \t]+--\x3e[ \t]+/g),p=pl(c);if(null==d||null==h||null==p)throw new he(2,2,2001);for(l=new Gt(d+f,p+f,l.slice(1).join("\n").trim()),Nr(c),f=Lr(c);f;)hl(l,f,o)||X.m("VTT parser encountered an invalid VTT setting: ",f," The setting will be ignored."),Nr(c),f=Lr(c);null!=u&&(l.id=u),o=l}o&&r.push(o)}return r},dl.prototype.parseMedia=dl.prototype.parseMedia,fn["text/vtt"]=dl,fn['text/vtt; codecs="vtt"']=dl,fn['text/vtt; codecs="wvtt"']=dl,H("shaka.text.Mp4VttParser",ml),ml.prototype.parseInit=function(e){var t=!1;if((new Ci).L("moov",Ri).L("trak",Ri).L("mdia",Ri).ia("mdhd",function(e){0==e.version?(e.reader.P(4),e.reader.P(4),this.a=e.reader.I(),e.reader.P(4)):(e.reader.P(8),e.reader.P(8),this.a=e.reader.I(),e.reader.P(8)),e.reader.P(4)}.bind(this)).L("minf",Ri).L("stbl",Ri).ia("stsd",Ni).L("wvtt",(function(){t=!0})).parse(e),!this.a)throw new he(2,2,2008);if(!t)throw new he(2,2,2008)},ml.prototype.parseInit=ml.prototype.parseInit,ml.prototype.parseMedia=function(e,t){var n=this;if(!this.a)throw X.error("No init segment for MP4+VTT!"),new he(2,2,2008);var i,r=0,a=[],o=[],s=!1,u=!1,c=!1,l=null;if((new Ci).L("moof",Ri).L("traf",Ri).ia("tfdt",(function(e){s=!0,r=0==e.version?e.reader.I():e.reader.Kb()})).ia("tfhd",(function(e){var t=e.flags;(e=e.reader).P(4),1&t&&e.P(8),2&t&&e.P(4),l=8&t?e.I():null})).ia("trun",(function(e){u=!0;var t=e.version,n=e.flags,i=(e=e.reader).I();1&n&&e.P(4),4&n&&e.P(4);for(var r=[],o=0;o<i;o++){var s={duration:null,sampleSize:null,Md:null};256&n&&(s.duration=e.I()),512&n&&(s.sampleSize=e.I()),1024&n&&e.P(4),2048&n&&(s.Md=0==t?e.I():e.xe()),r.push(s)}a=r})).L("mdat",Di((function(e){c=!0,i=e}))).parse(e),!c&&!s&&!u)throw new he(2,2,2008);var f=r,d=new Mi(new DataView(i.buffer,i.byteOffset,i.byteLength),0);return a.forEach((function(e){var i=e.duration||l,a=e.Md?r+e.Md:f;f=a+(i||0);var s=0;do{var u=d.I();s+=u;var c=d.I(),h=null;"vttc"==(c=Ui(c))?8<u&&(h=d.gb(u-8)):("vtte"!=c&&X.error("Unknown box "+c+"! Skipping!"),d.P(u-8)),i?h&&o.push(gl(h,t.periodStart+a/n.a,t.periodStart+f/n.a)):X.error("WVTT sample duration unknown, and no default found!")}while(e.sampleSize&&s<e.sampleSize)})),o.filter(Kt.Na)},ml.prototype.parseMedia=ml.prototype.parseMedia,fn['application/mp4; codecs="wvtt"']=ml,H("shaka.util.Dom.createHTMLElement",(function(e){return document.createElement(e)})),H("shaka.util.Dom.createVideoElement",(function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e})),H("shaka.util.Dom.asHTMLElement",(function(e){return e})),H("shaka.util.Dom.asHTMLMediaElement",(function(e){return e})),H("shaka.util.Dom.removeAllChildren",(function(e){for(;e.firstChild;)e.removeChild(e.firstChild)})),H("EmeEncryptionSchemePolyfill",vl),vl.install=yl,H("McEncryptionSchemePolyfill",Sl),Sl.install=El,Al.prototype.getConfiguration=function(){var e=this.b.getConfiguration();if(e.videoCapabilities)for(var t=d(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.a;if(e.audioCapabilities)for(n=(t=d(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.a;return e},Al.prototype.createMediaKeys=function(){return this.b.createMediaKeys()},H("EncryptionSchemePolyfills",Pl),Pl.install=Cl,void 0!==n&&n.af&&(n.af=Pl)}.call(i,n,n,void 0),i.shaka)t[r]=i.shaka[r]}()}).call(this,n("yLpj"))}}]);