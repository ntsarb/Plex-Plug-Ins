"use strict";(self.webpackChunkplex_web_client=self.webpackChunkplex_web_client||[]).push([[884],{99538:(e,t,n)=>{n.d(t,{I:()=>r,w:()=>l});const r="boolean",l="other"},30166:(e,t,n)=>{n.d(t,{Z:()=>b});var r=n(13469),l=n.n(r),i=n(56036),a=(n(32903),n(99538)),o=Object.defineProperty,s=Object.prototype.hasOwnProperty,c=Object.getOwnPropertySymbols,u=Object.prototype.propertyIsEnumerable,m=(e,t,n)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y=(e,t)=>{for(var n in t||(t={}))s.call(t,n)&&m(e,n,t[n]);if(c)for(var n of c(t))u.call(t,n)&&m(e,n,t[n]);return e},p=n(68622),d=n(23636);const v=`([^&!=<>]+)(${p.ZP.sort(((e,t)=>t.length-e.length)).map(i.Z).join("|")})([^&]+)?`,f=new RegExp(v,"g"),Z=new RegExp(v),g={unwatched:!0,unwatchedLeaves:!0,unmatched:!0,duplicate:!0,inProgress:!0,hdonly:!0,hdr:!0};function b(e){if(!e)return[];const t=decodeURIComponent(e).match(f);return t?t.reduce(((e,t)=>{const n=t.match(Z),[,r,i,o]=n||[];let s=o?l().uniq(o.split(d.OR)):"";return 1===s.length&&(s=s[0]),function(e,t,n){const r=[...e];if(n.type===a.I){const e=l().findIndex(r,(e=>e.key===t)),i=-1===e?0:e,a=y({key:t},n);-1===e?r.push(a):r.splice(i,1,a)}else l().findWhere(r,{key:t,value:n.value})||r.push(y({key:t},n));return r}(e,r,{value:s,type:g[r]?a.I:a.w,operator:i})}),[]):[]}},51437:(e,t,n)=>{n.d(t,{Z:()=>c}),n(13469),n(32903);var r=Object.defineProperty,l=Object.prototype.hasOwnProperty,i=Object.getOwnPropertySymbols,a=Object.prototype.propertyIsEnumerable,o=(e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,s=(e,t)=>{for(var n in t||(t={}))l.call(t,n)&&o(e,n,t[n]);if(i)for(var n of i(t))a.call(t,n)&&o(e,n,t[n]);return e};function c(e,t,n){if(null==n)return e.filter((e=>e.key!==t));const r=[...e];let l=r.length;for(;l-- >0;){const e=r[l],i=e.key,a=e.value;if(t===i&&n===a)r.splice(l,1);else if(t===i&&Array.isArray(a)){const t=a.indexOf(n);t>-1&&(a.splice(t,1),1===a.length?r.splice(l,1,s(s({},e),{value:a[0]})):a.length||r.splice(l,1))}}return r}},631:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(22222),l=n(44273),i=n(33434),a=n(58671);const o=(0,i.Z)((function(e){return(0,r.P1)((0,a.Z)(e),(e=>e.accounts.slice().sort(l.Z)))}))},44273:(e,t,n)=>{function r(e,t){if(1===e.id)return-1;if(1===t.id)return 1;const n=e.name.trim().toUpperCase(),r=t.name.trim().toUpperCase();return n<r?-1:n>r?1:0}n.d(t,{Z:()=>r})},66884:(e,t,n)=>{n.r(t),n.d(t,{default:()=>mt});var r=n(67294),l=n(62291),i=n(44811),a=n(72310),o=n(91085),s=n(61737),c=n(79115),u=n(8292),m=n(28216),y=n(30166),p=n(87442),d=n(13220),v=n(18655),f=n(65372),Z=n(71273),g=n(20683),b=n(32975);const h=d.Z.extend({name:"PlayHistoryListItemModel",syncedAttrs:{key:v.Z.string,parentKey:v.Z.string,grandparentKey:v.Z.string,title:v.Z.string,parentTitle:v.Z.string,grandparentTitle:v.Z.string,type:v.Z.string,thumb:v.Z.string,parentThumb:v.Z.string,grandparentThumb:v.Z.string,grandparentArt:v.Z.string,index:v.Z.integer,parentIndex:v.Z.integer,originallyAvailableAt:v.Z.string,viewedAt:v.Z.integer,accountID:v.Z.integer,deviceID:v.Z.integer},derivedAttrs:{itemKey(){return this.get("key")},id(){return this.cid}}}),P=b.Z.extend({name:"PlayHistoryListItemCollection",context:["server"],model:h});d.Z.extend({mixins:[f.Z],collectionName:"items",name:"PlayHistoryListModel",context:["server","accountID","filters","sort","limit"],responseType:Z.AV,url(){const e=this.filters.reduce(((e,t)=>(e[t.key]=t.value,e)),{});null!=this.accountID&&(e.accountID=this.accountID),null!=this.sort&&(e.sort=this.sort),null!=this.limit&&(e.limit=this.limit);let t=g.Z.join("/status/sessions/history/all",e);return t=t.replace("viewedAt=","viewedAt>="),this.getPaginatedUrl(t)},sessionAttrs:{currentPageStart:v.Z.integer,currentPageSize:v.Z.integer,populatedRange:v.Z.object},syncedAttrs:{totalSize:v.Z.integer},syncedRelations:{items:{relationClass:P,rootPropertyName:"Metadata",setOptions:e=>({remove:e.remove,at:e.at})}},defaults:()=>({populatedRange:{start:0,end:0,size:0}}),initialize(){this.startPopulatedRangeMonitor()}});var I=n(24307),E=n(61595),k=n(74861),w=n(42218),T=n(12316),O=n(51175);function S(e,t){return!!e&&e.some((e=>e.key===t))}var C=n(73788),x=n(2696);var H=n(22222),M=n(58671);var F=n(27044),N=n(85209),A=n(33593),R=n(45731),j=n(50223);const D={key:"user",title:()=>(0,C.Z)("User"),component:function({className:e,playHistoryItem:t}){const[n]=(0,i.c9)(),{accountID:l}=t,a=(0,r.useMemo)((()=>((e,t)=>(0,H.P1)((0,M.Z)(e),(e=>e.accounts.find((e=>e.id===t)))))(n.machineIdentifier,l)),[l,n.machineIdentifier]),o=(0,m.v9)(a);return o?r.createElement("span",{className:e,title:o.name},o.name):r.createElement("span",{className:e},(0,C.Z)("Unknown User"))},style:{flex:"1 1 250px"}},L={key:"type",title:()=>(0,C.Z)("Type"),component:function({className:e,playHistoryItem:t}){const{type:n}=t,l=(0,N.getMetadataType)(n);return l?r.createElement("span",{className:e,title:l.title},l.title):null},style:{flex:"0 1 120px"}},U={key:"title",title:()=>(0,C.Z)("Title"),component:function({className:e,playHistoryItem:t}){const n=(0,x.Z)(t);return r.createElement("span",{className:e},r.createElement("div",{className:"PlayHistoryTableTitle-titleContainer-vVYJ11"},r.createElement("span",{className:"PlayHistoryTableTitle-title-KfbuOe",title:n},n)))},style:{flex:"2 0 350px"}},q={key:"player",title:()=>(0,C.Z)("Player"),component:function({className:e,playHistoryItem:t}){const[n]=(0,i.c9)(),{deviceID:l}=t,a=(0,m.v9)((0,F.Z)(n.machineIdentifier)).devices.find((e=>e.id===l));return a?r.createElement("span",{className:e,title:a.name},a.name):r.createElement("span",{className:e},(0,C.Z)("Unknown"))},style:{flex:"1 1 150px"}},z={key:"platform",title:()=>(0,C.Z)("Platform"),component:function({className:e,playHistoryItem:t}){const[n]=(0,i.c9)(),{deviceID:l}=t,a=(0,m.v9)((0,F.Z)(n.machineIdentifier)).devices.find((e=>e.id===l));return a?r.createElement("span",{className:e,title:a.platform},a.platform):r.createElement("span",{className:e},(0,C.Z)("Unknown"))},style:{flex:"1 1 150px"}},K=[{key:"viewedAt",ascKey:"viewedAt",descKey:"viewedAt:desc",title:()=>(0,C.Z)("Played"),component:function({className:e,playHistoryItem:t}){const{viewedAt:n}=t,l=(0,m.v9)(R.Z),i=(0,A.Z)(1e3*n,`${l} MMM d, yyyy`);return r.createElement("span",{className:e,title:i},i)},style:{flex:"1 1 150px"}}];var X=n(90144),_=n(7659),Q=n(14739),V=n(24107),Y=n(65790);const W=parseInt(V.Z.tableRowHeight,10),G=(0,Y.Z)({rowHeight:W,overscan:20});var $=n(50439),B=n(63797),J=n(24477),ee=n(62286),te=n(18585);const ne=(0,H.P1)(te.Z,(e=>e.playHistory));var re=n(62376),le=n(12476),ie=n(16975),ae=n(30547);const oe=r.forwardRef((({style:e,cellIndex:t},n)=>r.createElement("div",{ref:n,className:t%2?"PlayHistoryTableRowLoading-alternateLoadingItem-mBL8aM PlayHistoryTableRowLoading-loadingItem-ztQZqS":"PlayHistoryTableRowLoading-loadingItem-ztQZqS",style:e},(0,C.Z)("Loading..."))));var se=Object.prototype.hasOwnProperty,ce=Object.getOwnPropertySymbols,ue=Object.prototype.propertyIsEnumerable;function me(e){var t=e,{item:n,activeTableColumns:l}=t,a=((e,t)=>{var n={};for(var r in e)se.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&ce)for(var r of ce(e))t.indexOf(r)<0&&ue.call(e,r)&&(n[r]=e[r]);return n})(t,["item","activeTableColumns"]);const[o]=(0,i.c9)(),s=(0,ie.Z)(a);let c;if(null==n?void 0:n.key){const e=l.some((e=>"title"===e.key)),t=n.type===N.TRACK?n.parentKey:n.key;c=e?(0,ae.Z)(o,{isLibraryProvider:!0},t):void 0}return n?r.createElement("div",{ref:s.cellRef,className:a.cellIndex%2?"PlayHistoryTableRow-alternateItem-l9Zpev PlayHistoryTableRow-item-TN478t":"PlayHistoryTableRow-item-TN478t",style:s.style},r.createElement(re.Z,{"aria-label":n.title,className:"PlayHistoryTableRow-columns-RnVGEQ Link-link-vSsQW1",isDisabled:!c,to:c},l.map((({style:e,component:t},l)=>r.createElement(le.Z,{key:l,component:t,playHistoryItem:n,style:e}))))):r.createElement(oe,{ref:s.cellRef,cellIndex:a.cellIndex,style:s.style})}var ye=Object.defineProperty,pe=Object.prototype.hasOwnProperty,de=Object.getOwnPropertySymbols,ve=Object.prototype.propertyIsEnumerable,fe=(e,t,n)=>t in e?ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ze=(e,t)=>{for(var n in t||(t={}))pe.call(t,n)&&fe(e,n,t[n]);if(de)for(var n of de(t))ve.call(t,n)&&fe(e,n,t[n]);return e};function ge({activeTableColumns:e,activeFilters:t,activeSort:n}){const l=(0,m.I0)(),[a]=(0,i.c9)(),o=(0,m.v9)(ne),s=(0,m.v9)((0,F.Z)(a.machineIdentifier)),{items:c,totalSize:u,isPopulated:y,error:p}=o,{isPopulated:d,error:v}=s,f=(0,r.useCallback)((e=>{l(O.Z.actions.fetchRangeRequested(Ze(Ze({},e),{server:a,filters:t,sort:n})))}),[l,a,t,n]),Z=(0,r.useMemo)((()=>t=>r.createElement(me,Ze(Ze({},t),{activeTableColumns:e}))),[e]);return y&&u&&(d||v)?r.createElement(J.Z,{cellComponentFactory:Z,className:"PlayHistoryList-playHistoryListPageContent-ebUqYI PageContent-pageContentScroller-dvaH3C Scroller-scroller-S6_dko",items:c,layout:G,totalSize:u,onPageRequest:f}):y&&!u?r.createElement($.Z,{description:(0,C.Z)("Snuggle up on the couch and play something!"),title:(0,C.Z)("Nothing to see here")}):p?r.createElement(B.Z,null):r.createElement($.Z,null,r.createElement(ee.Z,null))}var be=n(42313),he=n(17282),Pe=n(54768),Ie=n(23574),Ee=n(8235),ke=n(99538),we=n(51437),Te=(n(32903),Object.defineProperty),Oe=Object.prototype.hasOwnProperty,Se=Object.getOwnPropertySymbols,Ce=Object.prototype.propertyIsEnumerable,xe=(e,t,n)=>t in e?Te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function He(e,t,n){const r=[...e],l=r.findIndex((e=>e.key===t)),i=-1===l?0:l,a=((e,t)=>{for(var n in t||(t={}))Oe.call(t,n)&&xe(e,n,t[n]);if(Se)for(var n of Se(t))Ce.call(t,n)&&xe(e,n,t[n]);return e})({key:t},n);return-1===l?r.push(a):r.splice(i,1,a),r}var Me=n(54098),Fe=n(14580),Ne=n(83782),Ae=n(631),Re=n(55319),je=n(1550),De=Object.defineProperty,Le=Object.prototype.hasOwnProperty,Ue=Object.getOwnPropertySymbols,qe=Object.prototype.propertyIsEnumerable,ze=(e,t,n)=>t in e?De(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ke=(e,t)=>{for(var n in t||(t={}))Le.call(t,n)&&ze(e,n,t[n]);if(Ue)for(var n of Ue(t))qe.call(t,n)&&ze(e,n,t[n]);return e};let Xe,_e;function Qe(e,t=window.location.hash){const n=function(e){if(Xe===e)return _e;const t=e.split("?"),n=t.length>1?t[1]:void 0,r=n?g.Z.parseParams(n):{};return Xe=e,_e={url:t[0],params:r},_e}(t);return g.Z.join(n.url,Ke(Ke({},n.params),{filters:(0,je.Z)(e.filters),activeTimePeriod:e.activeTimePeriod,sort:e.sort}))}var Ve=n(84332);function Ye({activeFilters:e,activeTimePeriod:t,activeSort:n}){const[l]=(0,i.c9)(),a=(0,Ne.Z)(),o=(0,Re.Z)(),s=(0,r.useMemo)((()=>({key:"",title:(0,C.Z)("All Users")})),[]),c=(0,m.v9)((0,Ae.Z)(l.machineIdentifier)),u=(0,r.useMemo)((()=>c.reduce(((e,t)=>(e.push({key:String(t.id),title:t.name}),e)),[s])),[c,s]),y=(0,r.useMemo)((()=>{const t=e.find((e=>"accountID"===e.key));return t?u.find((e=>e.key===t.value)):s}),[e,u,s]),p=(0,r.useCallback)((r=>{let l;l=r?He(e,j.F.AccountID,{value:String(r),type:ke.w}):(0,we.Z)(e,j.F.AccountID),window.location.hash=Qe({filters:l,activeTimePeriod:t,sort:n})}),[e,t,n]);return y&&u.length?r.createElement(r.Fragment,null,r.createElement(he.Z,{hasMenu:!0,id:a,isMenuOpen:o.isOpen,onPress:o.onToggle},y.title),r.createElement(Me.Z,{isOpen:o.isOpen,target:a,onMenuClose:o.onClose},u.map((e=>r.createElement(Ve.Z,{key:e.key,isSelected:y.key===e.key,value:e.key,onSelect:(0,Fe.Z)(p,o.onClose)},e.title))))):null}var We=n(33434),Ge=n(85687);const $e=(0,We.Z)((function(e,t){return(0,H.P1)((0,Ge.Z)(e,t),(e=>e.filter((e=>{const t=e.type?N.getMetadataType(e.type):null;return t&&t.typeString!==N.PLAYLIST}))))}));function Be({activeFilters:e,activeTimePeriod:t,activeSort:n}){const[l,a]=(0,i.c9)(),o=(0,Ne.Z)(),s=(0,Re.Z)(),c=(0,m.v9)($e(l.machineIdentifier,a.identifier)),u=(0,r.useMemo)((()=>({key:"all",title:(0,C.Z)("All Libraries")})),[]),y=(0,r.useMemo)((()=>c.reduce(((e,t)=>(e.push({key:t.id,title:t.title}),e)),[u])),[c,u]),p=(0,r.useMemo)((()=>{const t=e.find((e=>"librarySectionID"===e.key));return t&&y.length?y.find((e=>String(e.key)===t.value)):u}),[e,y,u]),d=(0,r.useCallback)((r=>{let l;l="all"!==r?He(e,j.F.LibrarySectionID,{value:r,type:ke.w}):(0,we.Z)(e,j.F.LibrarySectionID),window.location.hash=Qe({filters:l,activeTimePeriod:t,sort:n})}),[e,t,n]);return p&&c.length?r.createElement(r.Fragment,null,r.createElement(he.Z,{hasMenu:!0,id:o,isMenuOpen:s.isOpen,onPress:s.onToggle},p.title),r.createElement(Me.Z,{isOpen:s.isOpen,target:o,onMenuClose:s.onClose},y.map((e=>r.createElement(Ve.Z,{key:e.key,isSelected:p.key===e.key,value:e.key,onSelect:(0,Fe.Z)(d,s.onClose)},e.title))))):null}var Je=n(78557);function et(){const[e]=(0,i.c9)(),t=(0,Ne.Z)(),n=(0,Re.Z)(),l=(0,m.v9)(Je.Z),a=(0,r.useMemo)((()=>l.reduce(((e,t)=>(t.isFullOwnedServer&&t.isConnected&&e.push({key:t.machineIdentifier,title:t.friendlyName}),e)),[])),[l]),o=(0,r.useMemo)((()=>a.find((t=>t.key===e.machineIdentifier))),[e,a]),s=(0,r.useCallback)((e=>{window.location.hash=(0,Ee.Z)(e)}),[]);return o?r.createElement(r.Fragment,null,r.createElement(he.Z,{hasMenu:!0,id:t,isMenuOpen:n.isOpen,onPress:n.onToggle},o.title),r.createElement(Me.Z,{isOpen:n.isOpen,target:t,onMenuClose:n.onClose},a.map((e=>r.createElement(Ve.Z,{key:e.key,isSelected:o.key===e.key,value:e.key,onSelect:(0,Fe.Z)(s,n.onClose)},e.title))))):null}function tt({activeFilters:e,activeTimePeriod:t,activeSort:n}){const l=(0,Ne.Z)(),i=(0,Re.Z)(),a=[Q.XH.Week,Q.XH.Month,Q.XH.NinetyDays,Q.XH.Year,Q.XH.AllTime],o=(0,r.useCallback)((t=>{const r=He(e,j.F.ViewedAt,{value:String((0,Q.xP)(t)),type:ke.w});window.location.hash=Qe({filters:r,activeTimePeriod:t,sort:n})}),[e,n]);return r.createElement(r.Fragment,null,r.createElement(he.Z,{hasMenu:!0,id:l,isMenuOpen:i.isOpen,onPress:i.onToggle},(0,Q.dZ)(t)),r.createElement(Me.Z,{isOpen:i.isOpen,target:l,onMenuClose:i.onClose},a.map((e=>r.createElement(Ve.Z,{key:e,isSelected:t===e,value:e,onSelect:(0,Fe.Z)(o,i.onClose)},(0,Q.dZ)(e))))))}const nt=(0,H.P1)(ne,(e=>e.totalSize));function rt({activeFilters:e,activeFilterTitle:t,activeTimePeriod:n,activeSort:l}){const[a]=(0,i.c9)(),o=(0,m.v9)(nt),s=!S(e,j.F.MetadataItemID);return r.createElement(Ie.Z,null,r.createElement(Pe.Z,null,r.createElement(he.Z,{to:(0,Ee.Z)(a.machineIdentifier)},(0,C.Z)("Play History")),t?r.createElement(he.Z,null,t):null,s?r.createElement(et,null):null,s?r.createElement(r.Fragment,null,r.createElement(Be,{activeFilters:e,activeSort:l,activeTimePeriod:n}),r.createElement(Ye,{activeFilters:e,activeSort:l,activeTimePeriod:n}),r.createElement(tt,{activeFilters:e,activeSort:l,activeTimePeriod:n})):null,r.createElement(be.Z,null,o)))}var lt=n(88467),it=n(83189),at=n(5099),ot=n(89385),st=n(23525);function ct({activeTableColumns:e,activeFilters:t,activeTimePeriod:n,activeSort:l}){return r.createElement(it.Z,null,e.map((({style:e,title:i,ascKey:a,descKey:o,key:s})=>{if(!a)return r.createElement("div",{key:s,className:"PlayHistoryTableHeader-tableHeader-SpG2fq",style:e},r.createElement(at.Z,null,r.createElement(st.Z,null,i())));const c=l===a||l===o,u=l===a;return r.createElement(ot.Z,{key:s,style:e,to:Qe({filters:t,activeTimePeriod:n,sort:u?o:a})},r.createElement(at.Z,{isActive:c},r.createElement(st.Z,null,i()),c?r.createElement(lt.Z,{isAscending:!u}):null))})))}function ut(){var e;const t=(0,m.I0)(),[n]=(0,i.c9)(),l=(0,a.Z)(),o=(0,y.Z)(l.filters),s=(0,c.Z)(l.filterTitle),u=null!=(e=(0,X.su)(Q.XH).find((e=>e===(0,c.Z)(l.activeTimePeriod))))?e:Q.XH.AllTime,d=l.sort?(0,c.Z)(l.sort):"viewedAt:desc",v=(0,_.Z)(l.isParentType),f=function(e,t){let n=[q,z,...K];return!t&&S(e,j.F.MetadataItemID)||(n=[U,...n]),S(e,j.F.LibrarySectionID)||S(e,j.F.MetadataItemID)||(n=[L,...n]),S(e,j.F.AccountID)||(n=[D,...n]),n}(o,v);return(0,k.Z)(),(0,r.useEffect)((()=>{t(E.Z.actions.populateRequested({server:n})),t(I.Z.actions.populateRequested({server:n}))}),[t,n]),(0,r.useEffect)((()=>((0,p.c9)((()=>{t(O.Z.actions.fetchRangeRequested({server:n,filters:o,sort:d,startIndex:0,size:100}))})),()=>{t(O.Z.actions.reset())})),[o,d,t,n]),r.createElement(w.Z,{scrollDirection:T.I.None},r.createElement(rt,{activeFilterTitle:s,activeFilters:o,activeSort:d,activeTimePeriod:u}),r.createElement(ct,{activeFilters:o,activeSort:d,activeTableColumns:f,activeTimePeriod:u}),r.createElement(ge,{activeFilters:o,activeSort:d,activeTableColumns:f}))}function mt(){const{machineIdentifier:e,providerIdentifier:t}=(0,s.Z)(),n=(0,a.Z)();return r.createElement(i.ZP,{machineIdentifier:e,providerIdentifier:t},r.createElement(u.Z,{machineIdentifier:e,providerIdentifier:t},r.createElement(o.ZP,{metricsContext:(0,c.Z)(n.context),metricsPage:l.mw},r.createElement(ut,null))))}},7659:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function(e){return 1===Number(e)||"true"===e}}}]);